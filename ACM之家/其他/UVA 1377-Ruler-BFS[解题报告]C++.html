<div class="c-top2" id="post-55">
<div class="datetime">2014<br/>01-15</div>
<div class="tit"><h1 class="entry-title">UVA 1377-Ruler-BFS[解题报告]C++</h1>
<div class="entry-meta iititle2">
<span class="i2"><a href="http://www.acmerblog.com/author/admin" rel="author" title="由coder发布">coder</a></span><span class="i1"><a href="http://www.acmerblog.com/category/problemset/uva" rel="category tag" title="查看UVA中的全部文章">UVA</a>, <a href="http://www.acmerblog.com/category/graph/graph-visit" rel="category tag" title="查看图的遍历中的全部文章">图的遍历</a></span><span class="i4">围观1784次</span><span class="i3"><a class="ds-thread-count" data-thread-key="3747" href="http://www.acmerblog.com/uva-1377-ruler-3747.html#comments" title="《UVA 1377-Ruler-BFS[解题报告]C++》上的评论">15 条评论</a></span>
</div>
</div>
<div class="cls"></div>
</div><div class="entry-content">
<p style="font-family:Simsun; font-size:14px">Xiaoming wants to make a special ruler, which can directly measure several given lengths. Xiaoming hopes to find a way, making the scale on ruler as few as possible, while for a given length, there exists two scales<br/>
 on ruler and the distance between the two scales is equal to the given length. For scales as few as possible, we also hope the length of ruler as short as possible to save the material cost.</p>
<p style="font-family:Simsun; font-size:14px">
</p><h2 style="font-family:Simsun"><span style="font-size:18px; color:#ff0000"><a name="SECTION0001001000000000000000" target="_blank">Input</a> </span></h2>
<p><span style="font-family:Simsun; font-size:14px">Input contains several cases. Each case has two lines. The first line is an integer </span><span class="MATH" style="font-family:Simsun; font-size:14px"><em>n</em></span><span style="font-family:Simsun; font-size:14px"> (</span><span style="font-family:Simsun; font-size:14px"> </span><span class="MATH" style="font-family:Simsun; font-size:14px">1 <img align="MIDDLE" alt="$ \leq$" border="0" height="31" src="http://cdn.acmerblog.com/img/1389781504974.png" width="18"/> <em>n</em> <img align="MIDDLE" alt="$ \leq$" border="0" height="31" src="http://cdn.acmerblog.com/img/1389781505786.png" width="18"/> 50</span><span style="font-family:Simsun; font-size:14px">)<br/>
 to specify how many given lengths need to measure. The second line contains </span><span class="MATH" style="font-family:Simsun; font-size:14px"><em>n</em></span><span style="font-family:Simsun; font-size:14px"> integers </span><span style="font-family:Simsun; font-size:14px"></span><span class="MATH" style="font-family:Simsun; font-size:14px"><em>d</em><sub>1</sub>, <em>d</em><sub>2</sub>,…<em>d</em><sub>n</sub></span><span style="font-family:Simsun; font-size:14px">,<br/>
 indicating the length values respectively (</span><span style="font-family:Simsun; font-size:14px"> </span><span class="MATH" style="font-family:Simsun; font-size:14px">1 <img align="MIDDLE" alt="$ \leq$" border="0" height="31" src="http://cdn.acmerblog.com/img/1389781506585.png" width="18"/> <em>d</em><sub>i</sub> <img align="MIDDLE" alt="$ \leq$" border="0" height="31" src="http://cdn.acmerblog.com/img/1389781509000.png" width="18"/> 10<sup>6</sup>, <em>i</em> <img align="MIDDLE" alt="$ \in$" border="0" height="31" src="http://cdn.acmerblog.com/img/1389781510311.png" width="16"/> [1, <em>n</em>]</span><span style="font-family:Simsun; font-size:14px">).</span></p>
<p style="font-family:Simsun; font-size:14px">The last case is followed by a line containing a zero.</p>
<p style="font-family:Simsun; font-size:14px">
</p><h2 style="font-family:Simsun"><span style="font-size:18px; color:#ff0000"><a name="SECTION0001002000000000000000" target="_blank">Output</a> </span></h2>
<p><span style="font-family:Simsun; font-size:14px">For each case, output three lines. The first line contains the case number. The second line is an integer </span><span class="MATH" style="font-family:Simsun; font-size:14px"><em>M</em></span><span style="font-family:Simsun; font-size:14px">to<br/>
 specify the minimized number of scales needed. The third line is </span><span class="MATH" style="font-family:Simsun; font-size:14px"><em>M</em></span><span style="font-family:Simsun; font-size:14px"> integers to specify the distance between the leftmost scales<br/>
 and the other </span><span class="MATH" style="font-family:Simsun; font-size:14px"><em>M</em></span><span style="font-family:Simsun; font-size:14px"> scales respectively.</span></p>
<p style="font-family:Simsun; font-size:14px">
</p><p style="font-family:Simsun; font-size:14px">
<strong>Note:</strong> output scales in ascending order, the first number is always <span class="MATH">0</span>. You can assume that <span class="MATH"><em>M</em></span> won’t exceed <span class="MATH">7</span>.</p>
<p style="font-family:Simsun; font-size:14px">
</p><h2 style="font-family:Simsun"><span style="font-size:18px; color:#ff0000"><a name="SECTION0001003000000000000000" target="_blank">Sample Input</a> </span></h2>
<pre>6
5 15 20 25 35 40
0
</pre>
<p style="font-family:Simsun; font-size:14px">
</p><h2 style="font-family:Simsun"><span style="font-size:18px; color:#ff0000"><a name="SECTION0001004000000000000000" target="_blank">Sample Output</a> </span></h2>
<pre>Case 1:
4
0 5 25 40</pre>
<p>题意：给定一些要测量的刻度，然后你要制造一把尺子，能测量这些，要求尺子的刻度数尽量少，并且尺子尽量短，题目保证刻度数不会大于7.</p>
<p>思路：BFS + 状态判重。每个尺子要测量刻度肯定由当前有的刻度去加或减可以得到一个新刻度，然后新刻度可以和其他的得到一些可以测量的刻度，注意M不会大于7，也就是说虽然题目说测量50个刻度，实际上只有C72，21个刻度，有很多重复的，这使得搜索时间复杂度不会太高。不过题目还有个条件，就是做出来的尺子最大刻度不能超过要测量的最大刻度，这点题目没说，WA了，还是看了别人题解才知道。</p>
<p>代码：</p>
<pre class="brush:cpp ">#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;algorithm&gt;
#include &lt;queue&gt;
#include &lt;set&gt;
using namespace std;

const int MAXN = 1000005;

int N, n, id[MAXN], d[25], cas = 0, Max, vis[2222222];

set&lt;int&gt;ans;
struct S {
	int state;
	set&lt;int&gt;ans;
} p;

void init() {
	int D; n = 0; ans.clear();
	memset(id, 0, sizeof(id));
	memset(vis, 0, sizeof(vis));
	for (int i = 0; i &lt; N; i++) {
		scanf("%d", &amp;D);
		if (!id[D]) {
			d[n++] = D;
			id[D] = 1;
		}
	}
	sort(d, d + n);
	Max = d[n - 1];
	memset(id, -1, sizeof(id));
	for (int j = 0; j &lt; n; j++)
		id[d[j]] = j;
}

void BFS() {
	queue&lt;S&gt;Q;
	p.ans.clear(); p.ans.insert(0); p.state = 0;
	Q.push(p);
	while (!Q.empty()) {
		p = Q.front(); Q.pop();	
		if (p.state == (1&lt;&lt;n) - 1) {
			if (ans.size() == 0) {
				ans = p.ans;
			}
			else {
				if (ans.size() &lt; p.ans.size()) return;
				else if (ans.size() &gt; p.ans.size()) ans = p.ans;
				else {
					if (*ans.rbegin() &gt; *p.ans.rbegin())
						ans = p.ans;
				}
			}
		}
		if (p.ans.size() == 7) continue;
		for (int i = 0; i &lt; n; i++) {
			if ((p.state&amp;(1&lt;&lt;i))) continue;
			for (set&lt;int&gt;::iterator it = p.ans.begin(); it != p.ans.end(); it++) {
				if (*it &gt; d[i]) {
					S q = p;
					int sum = *it - d[i];
					for (set&lt;int&gt;::iterator it2 = q.ans.begin(); it2 != q.ans.end(); it2++) {
						int nu = abs(*it2 - sum);
						if (id[nu] == -1) continue;
						q.state = (q.state|(1&lt;&lt;id[nu]));
					}
					q.ans.insert(sum);
					if (!vis[q.state]) {
						Q.push(q);
						vis[q.state] = 1;
					}
				}
				if (*it + d[i] &lt;= Max) {
					S q = p;
					int sum = *it + d[i];
					for (set&lt;int&gt;::iterator it2 = q.ans.begin(); it2 != q.ans.end(); it2++) {
						int nu = abs(*it2 - sum);
						if (id[nu] == -1) continue;
						q.state = (q.state|(1&lt;&lt;id[nu]));
					}
					q.ans.insert(sum);
					if (!vis[q.state]) {
						Q.push(q);
						vis[q.state] = 1;
					}
				}
			}
		}
	}
}

void solve() {
	BFS(); int bo = 0;
	printf("Case %d:\n%d\n", ++cas, ans.size());
	for (set&lt;int&gt;::iterator it = ans.begin(); it != ans.end(); it++) {
		if (bo++) printf(" ");
		printf("%d", *it);
	}
	printf("\n");
}

int main() {
	while (~scanf("%d", &amp;N) &amp;&amp; N) {
		init();
		solve();
	}
	return 0;
}</pre>
<p>转自：http://blog.csdn.net/accelerator_/article/details/18312437</p>
<div>
</script>
<!-- acm-hf-01 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-9460629317209118" data-ad-slot="5011774182" style="display:inline-block;width:728px;height:90px"></ins>

(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<div class="bdsharebuttonbox"><a class="bds_more" data-cmd="more" href="#"></a><a class="bds_qzone" data-cmd="qzone" href="#" title="分享到QQ空间"></a><a class="bds_tsina" data-cmd="tsina" href="#" title="分享到新浪微博"></a><a class="bds_tqq" data-cmd="tqq" href="#" title="分享到腾讯微博"></a><a class="bds_renren" data-cmd="renren" href="#" title="分享到人人网"></a><a class="bds_weixin" data-cmd="weixin" href="#" title="分享到微信"></a></div>

</div><ol id="commentlist">
<li class="comment even thread-even depth-1" id="li-comment-85282">
<article class="comment" id="comment-85282">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919515470" rel="external nofollow">新用户185933</a></span> on <a href="http://www.acmerblog.com/uva-1377-ruler-3747.html#comment-85282" rel="nofollow"><time datetime="2017-04-13T01:15:58+00:00" pubdate="">2017年4月13日 at 上午1:15</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>大啥特杀</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-45065">
<article class="comment" id="comment-45065">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">xin</a></span> on <a href="http://www.acmerblog.com/uva-1377-ruler-3747.html#comment-45065" rel="nofollow"><time datetime="2015-07-04T08:26:16+00:00" pubdate="">2015年7月4日 at 上午8:26</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>太变态了。我用hash居然超时了。这样break掉居然都行啊。。。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-21601">
<article class="comment" id="comment-21601">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">1520006273</a></span> on <a href="http://www.acmerblog.com/uva-1377-ruler-3747.html#comment-21601" rel="nofollow"><time datetime="2015-03-09T18:20:03+00:00" pubdate="">2015年3月9日 at 下午6:20</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>[…] 如果此题没有要求 相对位置不变，可以参考文章：http://www.acmerblog.com/interview-9-2427/ […]</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-45062">
<article class="comment" id="comment-45062">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">zwj0571</a></span> on <a href="http://www.acmerblog.com/uva-1377-ruler-3747.html#comment-45062" rel="nofollow"><time datetime="2015-01-11T18:05:08+00:00" pubdate="">2015年1月11日 at 下午6:05</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>第2题，TCP不支持多播，多播和广播仅应用于UDP。所以B选项是不对的。第2题，TCP不支持多播，多播和广播仅应用于UDP。所以B选项是不对的。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-21600">
<article class="comment" id="comment-21600">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">geoksz</a></span> on <a href="http://www.acmerblog.com/uva-1377-ruler-3747.html#comment-21600" rel="nofollow"><time datetime="2014-11-23T19:47:55+00:00" pubdate="">2014年11月23日 at 下午7:47</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>第15行代码，/n/n，应该改为\n\n</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-45061">
<article class="comment" id="comment-45061">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">3136869079</a></span> on <a href="http://www.acmerblog.com/uva-1377-ruler-3747.html#comment-45061" rel="nofollow"><time datetime="2014-11-07T05:28:49+00:00" pubdate="">2014年11月7日 at 上午5:28</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>程序是错的吧，明显没有判断不和该节点相邻的其他节点是否相互相邻</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-45064">
<article class="comment" id="comment-45064">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">2013283119</a></span> on <a href="http://www.acmerblog.com/uva-1377-ruler-3747.html#comment-45064" rel="nofollow"><time datetime="2014-11-05T06:47:43+00:00" pubdate="">2014年11月5日 at 上午6:47</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>
	welcome!</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-21596">
<article class="comment" id="comment-21596">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">rick</a></span> on <a href="http://www.acmerblog.com/uva-1377-ruler-3747.html#comment-21596" rel="nofollow"><time datetime="2014-09-28T17:39:40+00:00" pubdate="">2014年9月28日 at 下午5:39</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>第二种解法如果数组有重复元素 就不正确</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-45063">
<article class="comment" id="comment-45063">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">feifei003603</a></span> on <a href="http://www.acmerblog.com/uva-1377-ruler-3747.html#comment-45063" rel="nofollow"><time datetime="2014-08-28T20:23:20+00:00" pubdate="">2014年8月28日 at 下午8:23</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>找bug好专业的说</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-21598">
<article class="comment" id="comment-21598">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">windy</a></span> on <a href="http://www.acmerblog.com/uva-1377-ruler-3747.html#comment-21598" rel="nofollow"><time datetime="2014-08-10T23:53:47+00:00" pubdate="">2014年8月10日 at 下午11:53</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>你指的哪个问题？</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-21599">
<article class="comment" id="comment-21599">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">wkhuahuo</a></span> on <a href="http://www.acmerblog.com/uva-1377-ruler-3747.html#comment-21599" rel="nofollow"><time datetime="2014-06-22T06:51:59+00:00" pubdate="">2014年6月22日 at 上午6:51</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>站长好。我是一个准备创业的互联网小白,我们打算做一个有关国*际*游*学的平台。手上也有了一些境外资源。现阶段的团队现在没有cto.原意出让一些管理股寻找一个靠谱的技术专家做合伙人, 不知道是不是能得到您的帮助。发个帖子或者其他方式。期待您的回应。可以加我微信tianxielemon聊聊。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-45060">
<article class="comment" id="comment-45060">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">JcZ</a></span> on <a href="http://www.acmerblog.com/uva-1377-ruler-3747.html#comment-45060" rel="nofollow"><time datetime="2014-05-09T19:34:21+00:00" pubdate="">2014年5月9日 at 下午7:34</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>a是根先忽略掉，递归子树。剩下前缀bejkcfghid和后缀jkebfghicd，分拆的原则的是每个子树前缀和后缀的节点个数是一样的，根节点出现在前缀的第一个，后缀的最后一个。根节点b出现后缀的第四个位置，则第一部分为四个节点，前缀bejk，后缀jkeb，剩下的c出现在后缀的倒数第2个，就划分为cfghi和 fghic，第3部分就为c、c</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-45066">
<article class="comment" id="comment-45066">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">gy910210</a></span> on <a href="http://www.acmerblog.com/uva-1377-ruler-3747.html#comment-45066" rel="nofollow"><time datetime="2014-05-05T13:49:12+00:00" pubdate="">2014年5月5日 at 下午1:49</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>比较基础，找些自信</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-21597">
<article class="comment" id="comment-21597">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">xrjervis</a></span> on <a href="http://www.acmerblog.com/uva-1377-ruler-3747.html#comment-21597" rel="nofollow"><time datetime="2014-04-29T12:38:44+00:00" pubdate="">2014年4月29日 at 下午12:38</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>学算法中的数据结构学到一定程度会乐此不疲的，比如其中的2－3树，类似的红黑树，我甚至可以自己写个逻辑文件系统结构来。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-21595">
<article class="comment" id="comment-21595">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">1520006273</a></span> on <a href="http://www.acmerblog.com/uva-1377-ruler-3747.html#comment-21595" rel="nofollow"><time datetime="2014-04-12T01:48:43+00:00" pubdate="">2014年4月12日 at 上午1:48</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>参考 <a href="http://www.acmerblog.com/leetcode-solutions-6422.html" rel="nofollow">http://www.acmerblog.com/leetcode-solutions-6422.html</a></p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
</ol>