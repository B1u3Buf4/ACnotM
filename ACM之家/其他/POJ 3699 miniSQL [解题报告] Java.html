<div class="c-top2" id="post-55">
<div class="datetime">2013<br/>11-13</div>
<div class="tit"><h1 class="entry-title">POJ 3699 miniSQL [解题报告] Java</h1>
<div class="entry-meta iititle2">
<span class="i2"><a href="http://www.acmerblog.com/author/admin" rel="author" title="由coder发布">coder</a></span><span class="i1"><a href="http://www.acmerblog.com/category/zhuanti/java-poj" rel="category tag" title="查看Java解POJ中的全部文章">Java解POJ</a>, <a href="http://www.acmerblog.com/category/problemset/poj2" rel="category tag" title="查看POJ-北大中的全部文章">POJ-北大</a></span><span class="i4">围观1201次</span><span class="i3"><a class="ds-thread-count" data-thread-key="1132" href="http://www.acmerblog.com/POJ-3699-miniSQL-blog-1132.html#comments" title="《POJ 3699 miniSQL [解题报告] Java》上的评论">14 条评论</a></span>
</div>
</div>
<div class="cls"></div>
</div><div class="entry-content">
<div>
<h1 class="mytitle mybigtile">miniSQL</h1>
</div>
<div>
<p class="mytitle"> 问题描述 :</p>
</div>
<div class="mypanel">
<div>
<p>Joan is taking an internship at a company these days. Every day she is assigned tons of dull statistical jobs such as counting how many products made by the company values more than $100. In order to have more time to chat with the handsome intern nearby, she asks you to program a clever software that helps her get released from the onerous work.</p>
<p>The software should take as input a table of records together with several queries and for each query output all the records respectively.</p>
</div></div>
<div>
<p class="mytitle"> 输入:</p>
</div>
<div class="mypanel">
<div>
<p>The first part of the input is a single line consisting of three integers, <i>m</i>(1 ≤<i> m</i> ≤ 10), <i>n</i>(1 ≤ <i>n</i> ≤ 10000), <i>k</i>(1 ≤ k ≤ 100) indicating the number of columns in the table, the number of records and the number of queries.</p>
<p>The second part of the input is the description of the table, which consists of <i>m</i> lines. The <i>i</i>-th line of this part consists two strings in the format <i>Column_Name</i> <i>Type</i> which describes the <i>i</i>-th column of the table.</p>
<ul>
<li><i>Column_Name</i> contains only letters(a-zA-Z), digits(0-9) and underline(_).</li>
<li><i>Type</i> is either "STR" or "INT" indicating the type of this column.</li>
</ul>
<p>The third part of the input shows the content of the table which contains <i>n</i> lines. The <i>i</i>-th line of this part shows the <i>i</i>-th record in the table which consists of <i>m</i> items.</p>
<ul>
<li>if the type of the i-th column is "INT", the i-th item will be a 32-bit integer.</li>
<li>if the type of the i-th column is "STR" , the i-th item will be a string containing only letters(a-zA-Z), digits(0-9) and underline(_).</li>
</ul>
<p>The last part of the input gives the <i>k</i> queries which are similar to SQL select statements. The query is in the format select <i>Column_List</i> where <i>Condition</i></p>
<ul>
<li><i>Column_List</i> contains a list of column names which are separated by a single comma. All the names occured in the description of the table.</li>
<li><i>Condition</i> is in the format <i>Column_Name Op Value</i></li>
<ul>
<li><i>Column_Name</i> is one of the column name in the description of the table.</li>
<li>if the column’s type is "STR", <i>Op</i> is "=". Otherwise it may be "=", "&lt;" or "&gt;". </li>
<li>if the column’s type is "STR", <i>Value</i> will be a quoted string containing only letters(a-zA-Z), digits(0-9) and underline(_). Otherwise it will be a 32-bit integer. </li>
</ul>
</ul>
<p>The size of the input will not exceed 1M bytes.</p>
</div></div>
<div>
<p class="mytitle"> 输出:</p>
</div>
<div class="mypanel">
<div>
<p>For each query output a table and a blank line as Sample Output shows.</p>
</div>
</div>
<div>
<p class="mytitle"> 样例输入:</p>
</div>
<pre class="mypanel iopanel">
3 10 4
SID INT
NAME STR
PRIZE INT
1000 Potion 50
1001 Phoenix_Down 150
1002 Remedy 300
1003 Dagger 320
1004 Rod 260
1005 Flame_Staff 1100
1006 Broad_Sword 330
1007 Fork 1100
1008 Javelin 880
1009 Cats_Claws 4000
select SID,NAME,PRIZE where PRIZE&gt;100
select SID,SID where NAME="Dagger"
select PRIZE where NAME="Rod"
select SID,NAME,PRIZE where NAME="Excalibur"</pre>
<div>
<p class="mytitle"> 样例输出:</p>
</div>
<pre class="mypanel iopanel">
<span font="Courier">
+-----------------------------+
| SID  |     NAME     | PRIZE |
|------|--------------|-------|
| 1001 | Phoenix_Down |  150  |
| 1002 |    Remedy    |  300  |
| 1003 |    Dagger    |  320  |
| 1004 |     Rod      |  260  |
| 1005 | Flame_Staff  | 1100  |
| 1006 | Broad_Sword  |  330  |
| 1007 |     Fork     | 1100  |
| 1008 |   Javelin    |  880  |
| 1009 |  Cats_Claws  | 4000  |
+-----------------------------+

+-------------+
| SID  | SID  |
|------|------|
| 1003 | 1003 |
+-------------+

+-------+
| PRIZE |
|-------|
|  260  |
+-------+

+--------------------+
| SID | NAME | PRIZE |
|-----|------|-------|
+--------------------+
</span></pre>
<div class="mybigtile mysubmit"> <a href="http://poj.org/submit?problem_id=3699">提交代码</a>   <a href="http://poj.org/bbs?problem_id=3699">问题讨论</a>   <a href="http://poj.org/problemstatus?problem_id=3699">数据统计</a> </div>
<div>
<p class="mytitle"> 解题代码:</p>
</div>
<pre class="brush:java ">/* @author:SmilingWang */
import java.util.*;

public class Main {
 static StringBuffer res = new StringBuffer();
 public static void main(String[] args){
  Scanner in = new Scanner(System.in);
  int m = in.nextInt();
  int n = in.nextInt();
  int k = in.nextInt();
	
  Map&lt; String, String&gt; symbol_table = new HashMap&lt; String, String&gt;();
  Map&lt; String, Integer&gt; symbol_pos_table = new HashMap&lt; String,Integer&gt;();
  for(int i = 0; i &lt; m; i++){
   String name = in.next();
   String type = in.next();
	
   symbol_pos_table.put(name, i);
   symbol_table.put(name, type);
  }
		
  String[][] table = new String[n][m];
  for(int i = 0; i &lt; n; i++){
    for(int j = 0; j &lt; m; j++){
	table[i][j] = in.next();
    }
	
  }		
		
  for(int i = 0; i &lt; k; i++){
   in.next();
   String cols = in.next();
   in.next();
   String op = in.next();			
   StringTokenizer st = new StringTokenizer(cols, ",");
			
   ArrayList[] result = new ArrayList[st.countTokens()];
   int len = 0;
   String result_index_table[] = new String[st.countTokens()];
		
   while(st.hasMoreTokens()){
    result[len] = new ArrayList&lt; String&gt;();
    String col = st.nextToken();
    result_index_table[len] = col;
				
    int index = symbol_pos_table.get(col);
    int sp = -1;
    String op1="", op2="";
    char opt = 0;
    if((sp=op.indexOf("&gt;")) &gt; 0){
	op1 = op.substring(0, sp);
	op2 = op.substring(sp+1, op.length());
	opt = '&gt;';
    }
    else if((sp=op.indexOf("=")) &gt; 0){
	op1 = op.substring(0, sp);
	op2 = op.substring(sp+1, op.length());
	opt = '=';
    }
    else if((sp=op.indexOf("&lt; ")) &gt; 0){
	op1 = op.substring(0, sp);
	op2 = op.substring(sp+1, op.length());
	opt = '&lt; ';
    }
				
    for(int r = 0; r &lt; table.length; r++){
	String op_type = symbol_table.get(op1);
	int op_index = symbol_pos_table.get(op1);
		
	if(op_type.equals("INT")){
	  if(opt=='&gt;'){
	   if(Integer.parseInt(table[r][op_index]) &gt; Integer.parseInt(op2)){
		result[len].add(table[r][index]);
	   }
	 }
      else if(opt == '='){
	if(Integer.parseInt(table[r][op_index]) == Integer.parseInt(op2)){
	  result[len].add(table[r][index]);
	}
      }
     else if(opt == '&lt; '){
	if(Integer.parseInt(table[r][op_index]) &lt; Integer.parseInt(op2)){
	  result[len].add(table[r][index]);
	}
     }
   }
   else if(op_type.equals("STR")){
	if(table[r][op_index].equals(op2.replaceAll("\"", ""))){
        result[len].add(table[r][index]);
	}
   }
  }
  len++;
  }
				
  int table_len[] = new int[result_index_table.length];
  for(int x = 0; x &lt; table_len.length; x++){
   int max = result_index_table[x].length();
   for(int y = 0; y &lt; result[x].size(); y++){
	String item = result[x].get(y).toString();
	if(item.length() &gt; max){
         max = item.length();
	}
   }
   table_len[x] = max+2;
   }

   int total_len = 0;
   for(int x = 0; x &lt; table_len.length; x++){
	total_len += table_len[x];
   }

   total_len += (table_len.length + 1);	
   for(int x = 1; x &lt;= total_len; x++){
     if(x == 1 || x == total_len){
	//System.out.print("+");
	res.append("+");
     }
     else{
	//System.out.print("-");
	res.append("-");
     }
   }
   res.append("\n");
			
  for(int x = 0; x &lt; result_index_table.length; x++){				
	res.append("|");
	printCenter(result_index_table[x], table_len[x]);
	if(x == result_index_table.length-1){
         res.append("|");
	}
   }
   res.append("\n");		
			
  for(int x = 0; x &lt; table_len.length; x++){
    res.append("|");
    for(int y = 0; y &lt; table_len[x]; y++){
	//System.out.print("-");
	res.append("-");
    }
    if(x == result_index_table.length-1){
	//System.out.print("|");
	res.append("|");
    }
  }

  res.append("\n");
  for(int y = 0; y &lt; result[0].size(); y++){
   for(int x = 0; x &lt; result.length; x++){	
	//System.out.print("|");
	res.append("|");
	printCenter(result[x].get(y).toString(), table_len[x]);
	if(x == result.length-1){
         //System.out.print("|");
	  res.append("|");
	}
    }
     //System.out.println();
     res.append("\n");
   }
					
  for(int x = 1; x &lt;= total_len; x++){
    if(x == 1 || x == total_len){
	//System.out.print("+");
	res.append("+");
    }
    else{
	res.append("-");
	//System.out.print("-");
    }
   }
   res.append("\n");
   res.append("\n");
  }	

  System.out.println(res);
  }
	
  public static void printCenter(String data, int space){
   int len = data.length();
   int left = (space - len)/2;
   int total_len = 0;
		
   for(int i = 0; i &lt; left; i++){
	//System.out.print(" ");
	res.append(" ");
   }
  total_len += left;
		
  res.append(data);
  //System.out.print(data);
  total_len += data.length();
		
  for(int i = total_len; i &lt; space; i++){
    //System.out.print(" ");
    res.append(" ");
   }
 }
}</pre>
<div>
</script>
<!-- acm-hf-01 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-9460629317209118" data-ad-slot="5011774182" style="display:inline-block;width:728px;height:90px"></ins>

(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<div class="bdsharebuttonbox"><a class="bds_more" data-cmd="more" href="#"></a><a class="bds_qzone" data-cmd="qzone" href="#" title="分享到QQ空间"></a><a class="bds_tsina" data-cmd="tsina" href="#" title="分享到新浪微博"></a><a class="bds_tqq" data-cmd="tqq" href="#" title="分享到腾讯微博"></a><a class="bds_renren" data-cmd="renren" href="#" title="分享到人人网"></a><a class="bds_weixin" data-cmd="weixin" href="#" title="分享到微信"></a></div>

</div><ol id="commentlist">
<li class="comment even thread-even depth-1" id="li-comment-10027">
<article class="comment" id="comment-10027">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">jxfactor</a></span> on <a href="http://www.acmerblog.com/POJ-3699-miniSQL-blog-1132.html#comment-10027" rel="nofollow"><time datetime="2015-07-03T21:12:41+00:00" pubdate="">2015年7月3日 at 下午9:12</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>很好！！</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-53932">
<article class="comment" id="comment-53932">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">mr_zhang2011</a></span> on <a href="http://www.acmerblog.com/POJ-3699-miniSQL-blog-1132.html#comment-53932" rel="nofollow"><time datetime="2015-04-03T08:27:03+00:00" pubdate="">2015年4月3日 at 上午8:27</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>博主的C++功底真是好</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-10028">
<article class="comment" id="comment-10028">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">beizhiwu</a></span> on <a href="http://www.acmerblog.com/POJ-3699-miniSQL-blog-1132.html#comment-10028" rel="nofollow"><time datetime="2015-03-17T01:47:31+00:00" pubdate="">2015年3月17日 at 上午1:47</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>Java真是解决大数的利器</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-10032">
<article class="comment" id="comment-10032">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">usx13123</a></span> on <a href="http://www.acmerblog.com/POJ-3699-miniSQL-blog-1132.html#comment-10032" rel="nofollow"><time datetime="2014-10-28T01:22:13+00:00" pubdate="">2014年10月28日 at 上午1:22</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>你好，这题给出的代码好像弄错了，这个是pow那道题目的解法</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-39336">
<article class="comment" id="comment-39336">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">hunangangli</a></span> on <a href="http://www.acmerblog.com/POJ-3699-miniSQL-blog-1132.html#comment-39336" rel="nofollow"><time datetime="2014-06-12T06:38:25+00:00" pubdate="">2014年6月12日 at 上午6:38</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>具体实现上有所差别，但思路是一样的</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-10034">
<article class="comment" id="comment-10034">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">kate19930802</a></span> on <a href="http://www.acmerblog.com/POJ-3699-miniSQL-blog-1132.html#comment-10034" rel="nofollow"><time datetime="2014-05-27T16:56:51+00:00" pubdate="">2014年5月27日 at 下午4:56</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>有没有C++语言的代码？</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-61139">
<article class="comment" id="comment-61139">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">xiao1108</a></span> on <a href="http://www.acmerblog.com/POJ-3699-miniSQL-blog-1132.html#comment-61139" rel="nofollow"><time datetime="2014-04-27T03:47:18+00:00" pubdate="">2014年4月27日 at 上午3:47</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>原来如此 了解了</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-10029">
<article class="comment" id="comment-10029">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">ygxqqx</a></span> on <a href="http://www.acmerblog.com/POJ-3699-miniSQL-blog-1132.html#comment-10029" rel="nofollow"><time datetime="2014-03-20T21:28:56+00:00" pubdate="">2014年3月20日 at 下午9:28</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>贴的有些代码的头文件不见了，这是为啥</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-10031">
<article class="comment" id="comment-10031">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">huangduanjing</a></span> on <a href="http://www.acmerblog.com/POJ-3699-miniSQL-blog-1132.html#comment-10031" rel="nofollow"><time datetime="2014-02-16T14:13:36+00:00" pubdate="">2014年2月16日 at 下午2:13</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>正是我要找的，适合新手</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-10033">
<article class="comment" id="comment-10033">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">fwhappy</a></span> on <a href="http://www.acmerblog.com/POJ-3699-miniSQL-blog-1132.html#comment-10033" rel="nofollow"><time datetime="2014-02-10T00:14:13+00:00" pubdate="">2014年2月10日 at 上午12:14</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>第一段代码中：<br/>
 next <img src="http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/e6/weiboi_org.gif"/>  = next <img src="http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/af/newj_org.gif"/> ;<br/>
明显不对吧，应该是 next <img src="http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/e6/weiboi_org.gif"/> =j;才对</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-39335">
<article class="comment" id="comment-39335">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">Bernice1989</a></span> on <a href="http://www.acmerblog.com/POJ-3699-miniSQL-blog-1132.html#comment-39335" rel="nofollow"><time datetime="2014-01-12T16:16:42+00:00" pubdate="">2014年1月12日 at 下午4:16</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>原来欧几里德定理应用这么多</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-10026">
<article class="comment" id="comment-10026">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">dreams</a></span> on <a href="http://www.acmerblog.com/POJ-3699-miniSQL-blog-1132.html#comment-10026" rel="nofollow"><time datetime="2013-12-11T00:15:45+00:00" pubdate="">2013年12月11日 at 上午12:15</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>这张页面太松散拉，重新编辑一下，弄紧凑一点。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-10030">
<article class="comment" id="comment-10030">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">soasipray</a></span> on <a href="http://www.acmerblog.com/POJ-3699-miniSQL-blog-1132.html#comment-10030" rel="nofollow"><time datetime="2013-11-28T10:13:33+00:00" pubdate="">2013年11月28日 at 上午10:13</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>程序输出是对的，呈三角型。原程序是按C++写的，已经改成了C的</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-10035">
<article class="comment" id="comment-10035">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">dream</a></span> on <a href="http://www.acmerblog.com/POJ-3699-miniSQL-blog-1132.html#comment-10035" rel="nofollow"><time datetime="2013-11-22T10:21:54+00:00" pubdate="">2013年11月22日 at 上午10:21</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>正有此意，欢迎更多的建议~</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
</ol>