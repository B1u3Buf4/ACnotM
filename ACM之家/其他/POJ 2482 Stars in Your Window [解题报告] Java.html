<div class="c-top2" id="post-55">
<div class="datetime">2013<br/>11-11</div>
<div class="tit"><h1 class="entry-title">POJ 2482 Stars in Your Window [解题报告] Java</h1>
<div class="entry-meta iititle2">
<span class="i2"><a href="http://www.acmerblog.com/author/admin" rel="author" title="由coder发布">coder</a></span><span class="i1"><a href="http://www.acmerblog.com/category/zhuanti/java-poj" rel="category tag" title="查看Java解POJ中的全部文章">Java解POJ</a>, <a href="http://www.acmerblog.com/category/problemset/poj2" rel="category tag" title="查看POJ-北大中的全部文章">POJ-北大</a>, <a href="http://www.acmerblog.com/category/basis/sort" rel="category tag" title="查看排序中的全部文章">排序</a>, <a href="http://www.acmerblog.com/category/search" rel="category tag" title="查看搜索中的全部文章">搜索</a></span><span class="i4">围观1081次</span><span class="i3"><a class="ds-thread-count" data-thread-key="752" href="http://www.acmerblog.com/POJ-2482-Stars-in-Your-Window-blog-752.html#comments" title="《POJ 2482 Stars in Your Window [解题报告] Java》上的评论">14 条评论</a></span>
</div>
</div>
<div class="cls"></div>
</div><div class="entry-content">
<div>
<h1 class="mytitle mybigtile">Stars in Your Window</h1>
</div>
<div>
<p class="mytitle"> 问题描述 :</p>
</div>
<div class="mypanel">
Fleeting time does not blur my memory of you. Can it really be 4 years since I first saw you? I still remember, vividly, on the beautiful Zhuhai Campus, 4 years ago, from the moment I saw you smile, as you were walking out of the classroom and turned your head back, with the soft sunset glow shining on your rosy cheek, I knew, I knew that I was already drunk on you. Then, after several months’ observation and prying, your grace and your wisdom, your attitude to life and your aspiration for future were all strongly impressed on my memory. You were the glamorous and sunny girl whom I always dream of to share the rest of my life with. Alas, actually you were far beyond my wildest dreams and I had no idea about how to bridge that gulf between you and me. So I schemed nothing but to wait, to wait for an appropriate opportunity. Till now — the arrival of graduation, I realize I am such an idiot that one should create the opportunity and seize it instead of just waiting.
<p>These days, having parted with friends, roommates and classmates one after another, I still cannot believe the fact that after waving hands, these familiar faces will soon vanish from our life and become no more than a memory. I will move out from school tomorrow. And you are planning to fly far far away, to pursue your future and fulfill your dreams. Perhaps we will not meet each other any more if without fate and luck. So tonight, I was wandering around your dormitory building hoping to meet you there by chance. But contradictorily, your appearance must quicken my heartbeat and my clumsy tongue might be not able to belch out a word. I cannot remember how many times I have passed your dormitory building both in Zhuhai and Guangzhou, and each time aspired to see you appear in the balcony or your silhouette that cast on the window. I cannot remember how many times this idea comes to my mind: call her out to have dinner or at least a conversation. But each time, thinking of your excellence and my commonness, the predominance of timidity over courage drove me leave silently. </p>
<p>Graduation, means the end of life in university, the end of these glorious, romantic years. Your lovely smile which is my original incentive to work hard and this unrequited love will be both sealed as a memory in the deep of my heart and my mind. Graduation, also means a start of new life, a footprint on the way to bright prospect. I truly hope you will be happy everyday abroad and everything goes well. Meanwhile, I will try to get out from puerility and become more sophisticated. To pursue my own love and happiness here in reality will be my ideal I never desert.</p>
<p>Farewell, my princess!</p>
<p>If someday, somewhere, we have a chance to gather, even as gray-haired man and woman, at that time, I hope we can be good friends to share this memory proudly to relight the youthful and joyful emotions. If this chance never comes, I wish I were the stars in the sky and twinkling in your window, to bless you far away, as friends, to accompany you every night, sharing the sweet dreams or going through the nightmares together.<br/>
<br/></p><center><img src="http://www.acmerblog.com/img/poj/2482-19.jpg"/></center><br/>
<br/>Here comes the problem: Assume the sky is a flat plane. All the stars lie on it with a location (x, y). for each star, there is a grade ranging from 1 to 100, representing its brightness, where 100 is the brightest and 1 is the weakest. The window is a rectangle whose edges are parallel to the x-axis or y-axis. Your task is to tell where I should put the window in order to maximize the sum of the brightness of the stars within the window. Note, the stars which are right on the edge of the window does not count. The window can be translated but rotation is not allowed.
 </div>
<div>
<p class="mytitle"> 输入:</p>
</div>
<div class="mypanel">
There are several test cases in the input. The first line of each case contains 3 integers: n, W, H, indicating the number of stars, the horizontal length and the vertical height of the rectangle-shaped window. Then n lines follow, with 3 integers each: x, y, c, telling the location (x, y) and the brightness of each star. No two stars are on the same point.
<p>There are at least 1 and at most 10000 stars in the sky. 1&lt;=W，H&lt;=1000000, 0&lt;=x，y&lt;2^31.<br/>
</p></div>
<div>
<p class="mytitle"> 输出:</p>
</div>
<div class="mypanel">
For each test case, output the maximum brightness in a single line.</div>
<div>
<p class="mytitle"> 样例输入:</p>
</div>
<pre class="mypanel iopanel">
3 5 4
1 2 3
2 3 2
6 3 1
3 5 4
1 2 3
2 3 2
5 3 1
</pre>
<div>
<p class="mytitle"> 样例输出:</p>
</div>
<pre class="mypanel iopanel">
5
6
</pre>
<div class="mybigtile mysubmit"> <a href="http://poj.org/submit?problem_id=2482">提交代码</a>   <a href="http://poj.org/bbs?problem_id=2482">问题讨论</a>   <a href="http://poj.org/problemstatus?problem_id=2482">数据统计</a> </div>
<div>
<p class="mytitle"> 解题代码:</p>
</div>
<pre class="brush:java ">import java.util.*;  
      
    public class Main{  
      
        static long height[];  
        static long tree[];  
        static XY p[];  
        static TreeSet&lt; Long&gt; ts;  
        static Iterator&lt; Long&gt; iterator;  
        static int m;  
        static long sum[];  
        static long maxSum[];  
          
        public static void main(String[] args)throws Exception {  
              
            Scanner scan = new Scanner(System.in);  
              
            while(scan.hasNext()){  
                int n = scan.nextInt();  
                int W = scan.nextInt();  
                int H = scan.nextInt();  
                height = new long[2*n];  
                ts = new TreeSet&lt; Long&gt;();  
                  
                p = new XY[n &lt;&lt; 1];  
                  
                for(int i=0;i&lt; n;i++){  
                  p[i] = new XY(scan.nextLong(),scan.nextLong(),scan.nextLong());  
			 //x扫描线当遇到p[i].x+W 表示 以p[i].x为左下角的矩形已搜索结束
                    p[i+n] = new XY(p[i].x+W,p[i].y,-p[i].c);     
                    ts.add(p[i].y); //所以是-p[i].c 这样刚好可以中和成0表示没有加上它  
                    ts.add(p[i].y+H);  
                }  
                m = ts.size();  
                iterator = ts.iterator();  
                tree = new long[m&lt;&lt; 1];  
                sum = new long[(m&lt;&lt; 1)+2];  
                maxSum = new long[(m&lt;&lt; 1)+2];  
                  
                createLineTree(1);  
                  
                java.util.Arrays.sort(p);  
                  
                n *= 2;  
                  
                long ans = 0;  
                for(int i=0;i&lt; n;i++){             //原理同 x扫描线 相似  
                    insert(p[i].y,p[i].c);  
                    insert(p[i].y+H,-p[i].c);  
                    ans = Math.max(ans, maxSum[1]);  
                }  
                System.out.println(ans);  
            }  
      
        }  
      
        private static void insert(long y, long c) {  
              
            int p = 1;  
            while(tree[p]!=y){            // 搜索要修改的点  
                if(y&lt; tree[p])  
                    p &lt;&lt;= 1;  
                else  
                    p = (p&lt;&lt;1)+1;  
            }  
              
            while(p!=0){//更新 前面找到的修改点以及 它所有祖先点  
                sum[p] += c;  
                long t1 = maxSum[2*p]; //每个根结点是左右子树一起更新的结果  
		//  因为此树是有序的 所以每一棵子树代表一个范围左根右）  
                long t2 = sum[p]-sum[2*p+1]+maxSum[2*p+1];   
	    // 而这个范围的maxSum 值 就放在根中根中的sum值是其所有子树的总和 
                maxSum[p] = Math.max(t1, t2);              
                p /= 2;  
            }  
              
        }  
      
        public static void createLineTree(int p) {  
              
            if(2*p&lt;=m)  // 建立二叉 排序树     
                createLineTree(2*p);  
            tree[p] = iterator.next();  
            if(2*p+1&lt;=m)  
                createLineTree(2*p+1);  
        }  
      
    }  
    class XY implements Comparable&lt; XY&gt;{  
      
        long x;  
        long y;  
        long c;  
          
        public XY(long x, long y, long c) {  
            super();  
            this.x = x;  
            this.y = y;  
            this.c = c;  
        }  
      
      
        public int compareTo(XY e) {  
              
            if(this.x&lt; e.x)  
                return -1;  
            else if(this.x&gt;e.x)  
                return 1;  
            else{  
                if(this.c&lt; e.c)  
                    return -1;  
                else if(this.c&gt;e.c)  
                    return 1;  
                return 0;  
            }  
              
        }  
          
    }</pre>
<div>
</script>
<!-- acm-hf-01 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-9460629317209118" data-ad-slot="5011774182" style="display:inline-block;width:728px;height:90px"></ins>

(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<div class="bdsharebuttonbox"><a class="bds_more" data-cmd="more" href="#"></a><a class="bds_qzone" data-cmd="qzone" href="#" title="分享到QQ空间"></a><a class="bds_tsina" data-cmd="tsina" href="#" title="分享到新浪微博"></a><a class="bds_tqq" data-cmd="tqq" href="#" title="分享到腾讯微博"></a><a class="bds_renren" data-cmd="renren" href="#" title="分享到人人网"></a><a class="bds_weixin" data-cmd="weixin" href="#" title="分享到微信"></a></div>

</div><ol id="commentlist">
<li class="comment even thread-even depth-1" id="li-comment-60820">
<article class="comment" id="comment-60820">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">skyand</a></span> on <a href="http://www.acmerblog.com/POJ-2482-Stars-in-Your-Window-blog-752.html#comment-60820" rel="nofollow"><time datetime="2015-05-28T11:24:57+00:00" pubdate="">2015年5月28日 at 上午11:24</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>注释很详细，多谢分享！</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-7563">
<article class="comment" id="comment-7563">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">zx123456</a></span> on <a href="http://www.acmerblog.com/POJ-2482-Stars-in-Your-Window-blog-752.html#comment-7563" rel="nofollow"><time datetime="2015-05-06T23:32:50+00:00" pubdate="">2015年5月6日 at 下午11:32</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>什么破题，题意好难懂啊</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-7561">
<article class="comment" id="comment-7561">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">spiderMan</a></span> on <a href="http://www.acmerblog.com/POJ-2482-Stars-in-Your-Window-blog-752.html#comment-7561" rel="nofollow"><time datetime="2015-04-25T13:33:49+00:00" pubdate="">2015年4月25日 at 下午1:33</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>等待后面的实现，多谢</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-7560">
<article class="comment" id="comment-7560">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">zclzcllove</a></span> on <a href="http://www.acmerblog.com/POJ-2482-Stars-in-Your-Window-blog-752.html#comment-7560" rel="nofollow"><time datetime="2015-04-11T15:02:58+00:00" pubdate="">2015年4月11日 at 下午3:02</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>很好，注释很详细啊</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-38074">
<article class="comment" id="comment-38074">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">yelawolf</a></span> on <a href="http://www.acmerblog.com/POJ-2482-Stars-in-Your-Window-blog-752.html#comment-38074" rel="nofollow"><time datetime="2015-04-01T01:37:24+00:00" pubdate="">2015年4月1日 at 上午1:37</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>神奇的网站</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-38073">
<article class="comment" id="comment-38073">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">jinxiang23</a></span> on <a href="http://www.acmerblog.com/POJ-2482-Stars-in-Your-Window-blog-752.html#comment-38073" rel="nofollow"><time datetime="2014-12-24T04:13:19+00:00" pubdate="">2014年12月24日 at 上午4:13</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>第15行代码，/n/n，应该改为\n\n</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-38077">
<article class="comment" id="comment-38077">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">silianbo</a></span> on <a href="http://www.acmerblog.com/POJ-2482-Stars-in-Your-Window-blog-752.html#comment-38077" rel="nofollow"><time datetime="2014-12-11T07:27:38+00:00" pubdate="">2014年12月11日 at 上午7:27</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>换句话说，A[k/2-1]不可能大于两数组合并之后的第k小值，所以我们可以将其抛弃。<br/>
应该是，不可能小于合并后的第K小值吧</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-7559">
<article class="comment" id="comment-7559">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">yipwinghong</a></span> on <a href="http://www.acmerblog.com/POJ-2482-Stars-in-Your-Window-blog-752.html#comment-7559" rel="nofollow"><time datetime="2014-12-08T16:03:50+00:00" pubdate="">2014年12月8日 at 下午4:03</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>怎么输入两个0程序还没退出</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-7562">
<article class="comment" id="comment-7562">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">testnew</a></span> on <a href="http://www.acmerblog.com/POJ-2482-Stars-in-Your-Window-blog-752.html#comment-7562" rel="nofollow"><time datetime="2014-10-31T07:50:23+00:00" pubdate="">2014年10月31日 at 上午7:50</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>很给力啊，学习了</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-38076">
<article class="comment" id="comment-38076">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">michaelwen</a></span> on <a href="http://www.acmerblog.com/POJ-2482-Stars-in-Your-Window-blog-752.html#comment-38076" rel="nofollow"><time datetime="2014-07-24T05:24:31+00:00" pubdate="">2014年7月24日 at 上午5:24</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>对，就是把这32位当成一个长度为32的数</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-38075">
<article class="comment" id="comment-38075">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">AE</a></span> on <a href="http://www.acmerblog.com/POJ-2482-Stars-in-Your-Window-blog-752.html#comment-38075" rel="nofollow"><time datetime="2014-05-16T04:24:44+00:00" pubdate="">2014年5月16日 at 上午4:24</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>隐藏最深的bug是(start+end)/2有可能上溢</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-53321">
<article class="comment" id="comment-53321">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">211206421</a></span> on <a href="http://www.acmerblog.com/POJ-2482-Stars-in-Your-Window-blog-752.html#comment-53321" rel="nofollow"><time datetime="2014-02-17T20:36:17+00:00" pubdate="">2014年2月17日 at 下午8:36</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>不太明白DFS的方法</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-60818">
<article class="comment" id="comment-60818">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">jhxxszy</a></span> on <a href="http://www.acmerblog.com/POJ-2482-Stars-in-Your-Window-blog-752.html#comment-60818" rel="nofollow"><time datetime="2013-12-02T13:46:59+00:00" pubdate="">2013年12月2日 at 下午1:46</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>第二个解法好像不对</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-60819">
<article class="comment" id="comment-60819">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">09291010</a></span> on <a href="http://www.acmerblog.com/POJ-2482-Stars-in-Your-Window-blog-752.html#comment-60819" rel="nofollow"><time datetime="2013-11-19T17:40:11+00:00" pubdate="">2013年11月19日 at 下午5:40</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>不太懂呀，乡亲们。原理知道代码不会</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
</ol>