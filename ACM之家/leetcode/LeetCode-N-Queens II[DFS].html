<div class="c-top2" id="post-55">
<div class="datetime">2014<br/>11-19</div>
<div class="tit"><h1 class="entry-title">LeetCode-N-Queens II[DFS]</h1>
<div class="entry-meta iititle2">
<span class="i2"><a href="http://www.acmerblog.com/author/admin" rel="author" title="由coder发布">coder</a></span><span class="i1"><a href="http://www.acmerblog.com/category/search/dfs" rel="category tag" title="查看DFS搜索中的全部文章">DFS搜索</a></span><span class="i4">围观812次</span><span class="i3"><a class="ds-thread-count" data-thread-key="6278" href="http://www.acmerblog.com/leetcode-solution-n-queens-ii-6278.html#comments" title="《LeetCode-N-Queens II[DFS]》上的评论">15 条评论</a></span>
</div>
</div>
<div class="cls"></div>
</div><div class="entry-content">
<h3><strong>N-Queens II</strong></h3>
<div class="question-content">
<p>Follow up for N-Queens problem.</p>
<p>Now, instead outputting board configurations, return the total number of distinct solutions.</p>
<p><img src="http://www.leetcode.com/wp-content/uploads/2012/03/8-queens.png"/></p>
</div>
<p> 标签: Backtracking<br/>
<strong>分析</strong>
</p><p>只需要输出解的个数，不需要输出所有解，代码要比上一题简化很多。设一个全局计数器，每找到一个解就增1。</p>
<p>代码1
</p><pre class="brush:cpp">
// LeetCode, N-Queens II
// 深搜+剪枝
// 时间复杂度O(n!)，空间复杂度O(n)
class Solution {
public:
    int totalNQueens(int n) {
        this-&gt;count = 0;
        this-&gt;columns = vector&lt;int&gt;(n, 0);
        this-&gt;main_diag = vector&lt;int&gt;(2 * n, 0);
        this-&gt;anti_diag = vector&lt;int&gt;(2 * n, 0);

        vector&lt;int&gt; C(n, 0);  // C[i]表示第i行皇后所在的列编号
        dfs(C, 0);
        return this-&gt;count;
    }
private:
    int count; // 解的个数
    // 这三个变量用于剪枝
    vector&lt;int&gt; columns;  // 表示已经放置的皇后占据了哪些列
    vector&lt;int&gt; main_diag;  // 占据了哪些主对角线
    vector&lt;int&gt; anti_diag;  // 占据了哪些副对角线

    void dfs(vector&lt;int&gt; &amp;C, int row) {
        const int N = C.size();
        if (row == N) { // 终止条件，也是收敛条件，意味着找到了一个可行解
            ++this-&gt;count;
            return;
        }

        for (int j = 0; j &lt; N; ++j) {  // 扩展状态，一列一列的试
            const bool ok = columns[j] == 0 &amp;&amp;
                    main_diag[row + j] == 0 &amp;&amp;
                    anti_diag[row - j + N] == 0;
            if (!ok) continue;  // 剪枝：如果合法，继续递归
            // 执行扩展动作
            C[row] = j;
            columns[j] = main_diag[row + j] =
                    anti_diag[row - j + N] = 1;
            dfs(C, row + 1);
            // 撤销动作
            // C[row] = 0;
            columns[j] = main_diag[row + j] =
                    anti_diag[row - j + N] = 0;
        }
    }
};
</pre>
<p><strong>相关题目</strong><br/>
<a href="/leetcode-solution-n-queens-6254.html">N-Queens</a></p>
<div>
</script>
<!-- acm-hf-01 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-9460629317209118" data-ad-slot="5011774182" style="display:inline-block;width:728px;height:90px"></ins>

(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<div class="bdsharebuttonbox"><a class="bds_more" data-cmd="more" href="#"></a><a class="bds_qzone" data-cmd="qzone" href="#" title="分享到QQ空间"></a><a class="bds_tsina" data-cmd="tsina" href="#" title="分享到新浪微博"></a><a class="bds_tqq" data-cmd="tqq" href="#" title="分享到腾讯微博"></a><a class="bds_renren" data-cmd="renren" href="#" title="分享到人人网"></a><a class="bds_weixin" data-cmd="weixin" href="#" title="分享到微信"></a></div>

</div><ol id="commentlist">
<li class="comment even thread-even depth-1" id="li-comment-74334">
<article class="comment" id="comment-74334">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919527163" rel="external nofollow">新用户906979</a></span> on <a href="http://www.acmerblog.com/leetcode-solution-n-queens-ii-6278.html#comment-74334" rel="nofollow"><time datetime="2017-04-12T01:59:35+00:00" pubdate="">2017年4月12日 at 上午1:59</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>后期混缩：暴风雪</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-31754">
<article class="comment" id="comment-31754">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">Aifan</a></span> on <a href="http://www.acmerblog.com/leetcode-solution-n-queens-ii-6278.html#comment-31754" rel="nofollow"><time datetime="2015-07-10T03:09:10+00:00" pubdate="">2015年7月10日 at 上午3:09</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>很有用，收藏了</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-31759">
<article class="comment" id="comment-31759">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">jade1827</a></span> on <a href="http://www.acmerblog.com/leetcode-solution-n-queens-ii-6278.html#comment-31759" rel="nofollow"><time datetime="2015-06-03T11:34:03+00:00" pubdate="">2015年6月3日 at 上午11:34</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>哇，算法有这么多呢！</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-31752">
<article class="comment" id="comment-31752">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">modstart</a></span> on <a href="http://www.acmerblog.com/leetcode-solution-n-queens-ii-6278.html#comment-31752" rel="nofollow"><time datetime="2015-06-02T14:26:37+00:00" pubdate="">2015年6月2日 at 下午2:26</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>我觉得是D哎……</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-31756">
<article class="comment" id="comment-31756">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">Rosamondwu</a></span> on <a href="http://www.acmerblog.com/leetcode-solution-n-queens-ii-6278.html#comment-31756" rel="nofollow"><time datetime="2015-05-27T09:16:54+00:00" pubdate="">2015年5月27日 at 上午9:16</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>很好的思路，可以借鉴</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-31755">
<article class="comment" id="comment-31755">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">Ailing</a></span> on <a href="http://www.acmerblog.com/leetcode-solution-n-queens-ii-6278.html#comment-31755" rel="nofollow"><time datetime="2015-05-24T02:33:07+00:00" pubdate="">2015年5月24日 at 上午2:33</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>你的理解应该是：即使主持人拿走一个箱子对结果没有影响。这样想，主持人拿走的箱子只是没有影响到你初始选择的那个箱子中有奖品的概率，但是改变了其余两个箱子的概率分布。由 1/3,1/3 变成了 0, 2/3</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-31757">
<article class="comment" id="comment-31757">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">Lint</a></span> on <a href="http://www.acmerblog.com/leetcode-solution-n-queens-ii-6278.html#comment-31757" rel="nofollow"><time datetime="2015-05-22T18:17:12+00:00" pubdate="">2015年5月22日 at 下午6:17</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>根本过不了。。。。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-31747">
<article class="comment" id="comment-31747">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">ssjssh</a></span> on <a href="http://www.acmerblog.com/leetcode-solution-n-queens-ii-6278.html#comment-31747" rel="nofollow"><time datetime="2015-05-08T09:43:54+00:00" pubdate="">2015年5月8日 at 上午9:43</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>全是智力分析的题</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-31751">
<article class="comment" id="comment-31751">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">YangXiaoZhong</a></span> on <a href="http://www.acmerblog.com/leetcode-solution-n-queens-ii-6278.html#comment-31751" rel="nofollow"><time datetime="2015-04-30T04:51:15+00:00" pubdate="">2015年4月30日 at 上午4:51</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>这个差别应该不会太大，或许编辑器就自动优化成内联函数了</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-31760">
<article class="comment" id="comment-31760">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">super157</a></span> on <a href="http://www.acmerblog.com/leetcode-solution-n-queens-ii-6278.html#comment-31760" rel="nofollow"><time datetime="2015-03-25T11:02:19+00:00" pubdate="">2015年3月25日 at 上午11:02</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>simple, however efficient. A lot of instances it is difficult to get that a??perfect balancea?? among usability and appearance. I must say that youa??ve done a exceptional task with this. Also, the blog masses quite fast for me on Web explore.</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-31753">
<article class="comment" id="comment-31753">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">hong0220</a></span> on <a href="http://www.acmerblog.com/leetcode-solution-n-queens-ii-6278.html#comment-31753" rel="nofollow"><time datetime="2015-03-11T03:06:25+00:00" pubdate="">2015年3月11日 at 上午3:06</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>mark, 很巧妙的实现！</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-31748">
<article class="comment" id="comment-31748">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">zhiqiang</a></span> on <a href="http://www.acmerblog.com/leetcode-solution-n-queens-ii-6278.html#comment-31748" rel="nofollow"><time datetime="2015-02-10T12:38:41+00:00" pubdate="">2015年2月10日 at 下午12:38</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>终于找到一篇能看懂的，mark</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-31749">
<article class="comment" id="comment-31749">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">usx13123</a></span> on <a href="http://www.acmerblog.com/leetcode-solution-n-queens-ii-6278.html#comment-31749" rel="nofollow"><time datetime="2015-02-06T06:05:05+00:00" pubdate="">2015年2月6日 at 上午6:05</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>说的就是无向图啊，有向图的算法也是类似的</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-31758">
<article class="comment" id="comment-31758">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">piaoyi</a></span> on <a href="http://www.acmerblog.com/leetcode-solution-n-queens-ii-6278.html#comment-31758" rel="nofollow"><time datetime="2015-01-07T10:57:21+00:00" pubdate="">2015年1月7日 at 上午10:57</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>很好的思路，可以借鉴</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-31750">
<article class="comment" id="comment-31750">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">warriorbrant</a></span> on <a href="http://www.acmerblog.com/leetcode-solution-n-queens-ii-6278.html#comment-31750" rel="nofollow"><time datetime="2014-11-20T20:13:27+00:00" pubdate="">2014年11月20日 at 下午8:13</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>递归还真是一门学问，学习了</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
</ol>