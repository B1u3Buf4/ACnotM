<div class="c-top2" id="post-55">
<div class="datetime">2015<br/>09-17</div>
<div class="tit"><h1 class="entry-title">HDU 4652-Dice-动态规划-[解题报告]HOJ</h1>
<div class="entry-meta iititle2">
<span class="i2"><a href="http://www.acmerblog.com/author/spiderman" rel="author" title="由蜘蛛侠发布">蜘蛛侠</a></span><span class="i1"><a href="http://www.acmerblog.com/category/problemset/hdu" rel="category tag" title="查看HDU-杭电中的全部文章">HDU-杭电</a>, <a href="http://www.acmerblog.com/category/math/probability" rel="category tag" title="查看概率计算中的全部文章">概率计算</a>, <a href="http://www.acmerblog.com/category/dp2/line-dp" rel="category tag" title="查看线性DP中的全部文章">线性DP</a></span><span class="i4">围观70次</span><span class="i3"><a class="ds-thread-count" data-thread-key="7697" href="http://www.acmerblog.com/hdu-4652-dice-7697.html#comments" title="《HDU 4652-Dice-动态规划-[解题报告]HOJ》上的评论">一条评论</a></span>
</div>
</div>
<div class="cls"></div>
</div><div class="entry-content">
<h1 style="color:rgb(26,92,200); text-align:center; font-family:'Times New Roman'">
Dice</h1>
<p><br style="font-family:'Times New Roman'; font-size:14px"/></p>
<div align="left" class="panel_title" style="height:38px; background-color:transparent; padding:0px 14px; color:rgb(124,169,237); font-size:18px; font-family:Arial; font-weight:bold">
Problem Description</div>
<div class="panel_content" style="height:auto; margin:0px; padding:0px 20px; font-size:14px; font-family:'Times New Roman'">
You have a dice with m faces, each face contains a distinct number. We assume when we tossing the dice, each face will occur randomly and uniformly. Now you have T query to answer, each query has one of the following form:<br/>
0 m n: ask for the expected number of tosses until the last n times results are all same.<br/>
1 m n: ask for the expected number of tosses until the last n consecutive results are pairwise different.</div>
<div class="panel_bottom" style="height:auto; margin:0px; font-family:'Times New Roman'; font-size:14px">
 </div>
<p><br style="font-family:'Times New Roman'; font-size:14px"/></p>
<div align="left" class="panel_title" style="height:38px; background-color:transparent; padding:0px 14px; color:rgb(124,169,237); font-size:18px; font-family:Arial; font-weight:bold">
Input</div>
<div class="panel_content" style="height:auto; margin:0px; padding:0px 20px; font-size:14px; font-family:'Times New Roman'">
The first line contains a number T.(1≤T≤100) The next T line each line contains a query as we mentioned above. (1≤m,n≤10<sup>6</sup>) For second kind query, we guarantee n≤m. And in order to avoid potential precision issue, we guarantee the result for our query<br/>
 will not exceeding 10<sup>9</sup> in this problem.</div>
<div class="panel_bottom" style="height:auto; margin:0px; font-family:'Times New Roman'; font-size:14px">
 </div>
<p><br style="font-family:'Times New Roman'; font-size:14px"/></p>
<div align="left" class="panel_title" style="height:38px; background-color:transparent; padding:0px 14px; color:rgb(124,169,237); font-size:18px; font-family:Arial; font-weight:bold">
Output</div>
<div class="panel_content" style="height:auto; margin:0px; padding:0px 20px; font-size:14px; font-family:'Times New Roman'">
For each query, output the corresponding result. The answer will be considered correct if the absolute or relative error doesn’t exceed 10<sup>-6</sup>.</div>
<div class="panel_bottom" style="height:auto; margin:0px; font-family:'Times New Roman'; font-size:14px">
 </div>
<p><br style="font-family:'Times New Roman'; font-size:14px"/></p>
<div align="left" class="panel_title" style="height:38px; background-color:transparent; padding:0px 14px; color:rgb(124,169,237); font-size:18px; font-family:Arial; font-weight:bold">
Sample Input</div>
<div class="panel_content" style="height:auto; margin:0px; padding:0px 20px; font-size:14px; font-family:'Times New Roman'">
<pre style="margin-top:0px; margin-bottom:0px"><div style="font-family:'Courier New',Courier,monospace">6
0 6 1
0 6 3
0 6 5
1 6 2
1 6 4
1 6 6
10
1 4534 25
1 1232 24
1 3213 15
1 4343 24
1 4343 9
1 65467 123
1 43434 100
1 34344 9
1 10001 15
1 1000000 2000</div></pre>
</div>
<div class="panel_bottom" style="height:auto; margin:0px; font-family:'Times New Roman'; font-size:14px">
 </div>
<p><br style="font-family:'Times New Roman'; font-size:14px"/></p>
<div align="left" class="panel_title" style="height:38px; background-color:transparent; padding:0px 14px; color:rgb(124,169,237); font-size:18px; font-family:Arial; font-weight:bold">
Sample Output</div>
<div class="panel_content" style="height:auto; margin:0px; padding:0px 20px; font-size:14px; font-family:'Times New Roman'">
<pre style="margin-top:0px; margin-bottom:0px"><div style="font-family:'Courier New',Courier,monospace">1.000000000
43.000000000
1555.000000000
2.200000000
7.600000000
83.200000000
25.586315824
26.015990037
15.176341160
24.541045769
9.027721917
127.908330426
103.975455253
9.003495515
15.056204472
4731.706620396</div></pre>
</div>
<div class="panel_bottom" style="height:auto; margin:0px; font-family:'Times New Roman'; font-size:14px">
 </div>
<p><br style="font-family:'Times New Roman'; font-size:14px"/></p>
<div align="left" class="panel_title" style="height:38px; background-color:transparent; padding:0px 14px; color:rgb(124,169,237); font-size:18px; font-family:Arial; font-weight:bold">
Source</div>
<div class="panel_content" style="height:auto; margin:0px; padding:0px 20px; font-size:14px; font-family:'Times New Roman'">
<a href="http://acm.hdu.edu.cn/search.php?field=problem&amp;key=2013%20Multi-University%20Training%20Contest%205&amp;source=1&amp;searchmode=source" style="color:rgb(26,92,200); text-decoration:none" target="_blank">2013 Multi-University Training Contest<br/>
 5</a></div>
<div class="panel_bottom" style="height:auto; margin:0px; font-family:'Times New Roman'; font-size:14px">
 </div>
<div>
</div>
<p></p>
<p>题目大意：</p>
<blockquote style="margin:0 0 0 40px; border:none; padding:0px">
<p>m边形的骰子，问你出现连续相同（不同）n次需要掷的次数的数学期望。</p>
</blockquote>
<p></p>
<p>解题思路：</p>
<blockquote style="margin:0 0 0 40px; border:none; padding:0px">
<p>利用递归方式的DP的思想推公式</p>
</blockquote>
<p></p>
<blockquote style="margin:0 0 0 40px; border:none; padding:0px">
<p>（1）若询问为0，则：</p>
<p>
dp[i] 记录的是已经连续i个相同，到n个相同同需要的次数的数学期望<br/>
dp[0]= 1+dp[1]<br/>
dp[1]= 1+( 1/m*dp[2]+(m-1)/m*dp[1])=1+(dp[2]+(m-1)*dp[1])/m;<br/>
dp[2]= 1+(dp[3]+(m-1)*dp[2])/m;<br/>
………………..<br/>
dp[n]= 0</p>
<p>
推出：</p>
<p>dp[i]   = 1 + ( (m-1)*dp[1] + dp[i+1] ) / m<br/>
dp[i+1] = 1 + ( (m-1)*dp[1] + dp[i+2] ) / m</p>
<p>因此，m*(dp[i+1]-dp[i])=(dp[i+2]-dp[i+1])</p>
<p>我们发现是等比数列</p>
<p>dp[0]-dp[1]=1;<br/>
dp[1]-dp[2]=m;<br/>
……….<br/>
dp[n-1]-dp[n]=m^(n-1)</p>
<p>累加，得：dp[0]-dp[n]=1+m+m^2+……….m^(n-1)=(1-m^n)/(1-m)</p>
<p>所以：dp[0]=(1-m^n)/(1-m);</p>
<p>（2）若询问为1，则：</p>
<p> dp[0] = 1 + dp[1]<br/>
 dp[1] = 1 + (dp[1] + (m-1) dp[2]) / m<br/>
 dp[2] = 1 + (dp[1] + dp[2] + (m-2) dp[3]) / m<br/>
 dp[i] = 1 + (dp[1] + dp[2] + … dp[i] + (m-i)*dp[i+1]) / m<br/>
dp[i+1]= 1 + (dp[1] + dp[2] + … dp[i] + dp[i+1] + (m-i-1)*dp[i+1]) / m<br/>
 …<br/>
 dp[n] = 0;</p>
<p>选出 dp[i] 和 dp[i+1] 这两行相减 得</p>
<p>dp[i] – dp[i+1] = (m-i-1)/m * (dp[i+1] – dp[i+2]);</p>
<p>因此  dp[i+1] – dp[i+2] = m/(m-i-1)*(dp[i]-dp[i+1]);</p>
<p>所以：<br/>
dp[0]-dp[1]=1;<br/>
dp[1]-dp[2]=1*m/(m-1);<br/>
dp[2]-dp[3]=1*m/(m-1)*m/(m-2);<br/>
……….</p>
<p>dp[n-1]-dp[n]=1*m/(m-1)*m/(m-2)*…….*m/(m-n+1);</p>
<p>累加得到答案</p>
<p>
</p>
</blockquote>
<p>解题代码：</p>
<pre class="brush:cpp" code_snippet_id="415721" name="code" snippet_file_name="blog_20140703_1_1041234">#include &lt;iostream&gt;
#include &lt;cstdio&gt;
#include &lt;cmath&gt;
using namespace std;

inline double solve(){
    int op,m,n;
    scanf("%d%d%d",&amp;op,&amp;m,&amp;n);
    double ans=0;
    if(op==0){
        for(int i=0;i&lt;=n-1;i++){
            ans+=pow(1.0*m,i);
        }
    }else{
        double tmp=1.0;
        for(int i=1;i&lt;=n;i++){
            ans+=tmp;
            tmp*=m*1.0/(m-i);
        }
    }
    return ans;
}

int main(){
    int t;
    while(scanf("%d",&amp;t)!=EOF){
        while(t-- &gt;0){
            printf( "%.9lf\n",solve() );
        }
    }
    return 0;
}
</pre>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<div style="padding-top:20px">
<p style="font-size:12px;">版权声明：欢迎关注我的博客，本文为博主toyking原创文章，未经博主允许不得转载。</p>
</div>
<p>参考：http://blog.csdn.net/a1061747415/article/details/36685493</p>
<div>
</script>
<!-- acm-hf-01 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-9460629317209118" data-ad-slot="5011774182" style="display:inline-block;width:728px;height:90px"></ins>

(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<div class="bdsharebuttonbox"><a class="bds_more" data-cmd="more" href="#"></a><a class="bds_qzone" data-cmd="qzone" href="#" title="分享到QQ空间"></a><a class="bds_tsina" data-cmd="tsina" href="#" title="分享到新浪微博"></a><a class="bds_tqq" data-cmd="tqq" href="#" title="分享到腾讯微博"></a><a class="bds_renren" data-cmd="renren" href="#" title="分享到人人网"></a><a class="bds_weixin" data-cmd="weixin" href="#" title="分享到微信"></a></div>

</div><ol id="commentlist">
<li class="comment even thread-even depth-1" id="li-comment-97196">
<article class="comment" id="comment-97196">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919517758" rel="external nofollow">新用户766585</a></span> on <a href="http://www.acmerblog.com/hdu-4652-dice-7697.html#comment-97196" rel="nofollow"><time datetime="2017-04-20T00:52:34+00:00" pubdate="">2017年4月20日 at 上午12:52</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>魔鬼的步伐。。。。。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
</ol>