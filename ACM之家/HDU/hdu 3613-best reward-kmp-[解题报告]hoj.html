<div class="c-top2" id="post-55">
<div class="datetime">2014<br/>11-27</div>
<div class="tit"><h1 class="entry-title">hdu 3613-best reward-kmp-[解题报告]hoj</h1>
<div class="entry-meta iititle2">
<span class="i2"><a href="http://www.acmerblog.com/author/spiderman" rel="author" title="由蜘蛛侠发布">蜘蛛侠</a></span><span class="i1"><a href="http://www.acmerblog.com/category/problemset/hdu" rel="category tag" title="查看HDU-杭电中的全部文章">HDU-杭电</a>, <a href="http://www.acmerblog.com/category/basis/string" rel="category tag" title="查看字符串处理中的全部文章">字符串处理</a>, <a href="http://www.acmerblog.com/category/basis/recursion" rel="category tag" title="查看递归和分治中的全部文章">递归和分治</a></span><span class="i4">围观346次</span><span class="i3"><a class="ds-thread-count" data-thread-key="6576" href="http://www.acmerblog.com/hdu-3613-best-reward-6576.html#comments" title="《hdu 3613-best reward-kmp-[解题报告]hoj》上的评论">14 条评论</a></span>
</div>
</div>
<div class="cls"></div>
</div><div class="entry-content">
<h1 style="color:rgb(26,92,200); text-align:center; font-family:'Times New Roman'">
Best Reward</h1>
<p><span style="font-family:'Times New Roman'; font-size:14px"><strong><span style="font-family:Arial; font-size:12px; color:green">Time Limit: 2000/1000 MS (Java/Others)    Memory Limit: 65536/65536 K (Java/Others)<br/>
Total Submission(s): 364    Accepted Submission(s): 144<br/>
</span></strong></span><br style="font-family:'Times New Roman'; font-size:14px"/><br/>
<br style="font-family:'Times New Roman'; font-size:14px"/></p>
<div align="left" class="panel_title" style="height:38px; background-color:transparent; padding:0px 14px; color:rgb(124,169,237); font-size:18px; font-family:Arial; font-weight:bold">
Problem Description</div>
<div class="panel_content" style="height:auto; margin:0px; padding:0px 20px; font-size:14px; font-family:'Times New Roman'">
After an uphill battle, General Li won a great victory. Now the head of state decide to reward him with honor and treasures for his great exploit. 
<p>One of these treasures is a necklace made up of 26 different kinds of gemstones, and the length of the necklace is n. (That is to say: n gemstones are stringed together to constitute this necklace, and each of these gemstones belongs to only one of the 26 kinds.) </p>
<p>In accordance with the classical view, a necklace is valuable if and only if it is a palindrome – the necklace looks the same in either direction. However, the necklace we mentioned above may not a palindrome at the beginning. So the head of state decide to<br/>
 cut the necklace into two part, and then give both of them to General Li. </p>
<p>All gemstones of the same kind has the same value (may be positive or negative because of their quality – some kinds are beautiful while some others may looks just like normal stones). A necklace that is palindrom has value equal to the sum of its gemstones’<br/>
 value. while a necklace that is not palindrom has value zero. </p>
<p>Now the problem is: how to cut the given necklace so that the sum of the two necklaces’s value is greatest. Output this value. </p>
</div>
<div class="panel_bottom" style="height:auto; margin:0px; font-family:'Times New Roman'; font-size:14px">
 </div>
<p><br style="font-family:'Times New Roman'; font-size:14px"/></p>
<div align="left" class="panel_title" style="height:38px; background-color:transparent; padding:0px 14px; color:rgb(124,169,237); font-size:18px; font-family:Arial; font-weight:bold">
Input</div>
<div class="panel_content" style="height:auto; margin:0px; padding:0px 20px; font-size:14px; font-family:'Times New Roman'">
The first line of input is a single integer T (1 ≤ T ≤ 10) – the number of test cases. The description of these test cases follows. 
<p>For each test case, the first line is 26 integers: v<sub>1</sub>, v<sub>2</sub>, …, v<sub>26</sub> (-100 ≤ v<sub>i</sub> ≤ 100, 1 ≤ i ≤ 26), represent the value of gemstones of each kind. </p>
<p>The second line of each test case is a string made up of charactor ‘a’ to ‘z’. representing the necklace. Different charactor representing different kinds of gemstones, and the value of ‘a’ is v<sub>1</sub>, the value of ‘b’ is v<sub>2</sub>, …, and so on.<br/>
 The length of the string is no more than 500000. </p>
</div>
<div class="panel_bottom" style="height:auto; margin:0px; font-family:'Times New Roman'; font-size:14px">
 </div>
<p><br style="font-family:'Times New Roman'; font-size:14px"/></p>
<div align="left" class="panel_title" style="height:38px; background-color:transparent; padding:0px 14px; color:rgb(124,169,237); font-size:18px; font-family:Arial; font-weight:bold">
Output</div>
<div class="panel_content" style="height:auto; margin:0px; padding:0px 20px; font-size:14px; font-family:'Times New Roman'">
Output a single Integer: the maximum value General Li can get from the necklace.</div>
<div class="panel_bottom" style="height:auto; margin:0px; font-family:'Times New Roman'; font-size:14px">
 </div>
<p><br style="font-family:'Times New Roman'; font-size:14px"/></p>
<div align="left" class="panel_title" style="height:38px; background-color:transparent; padding:0px 14px; color:rgb(124,169,237); font-size:18px; font-family:Arial; font-weight:bold">
Sample Input</div>
<div class="panel_content" style="height:auto; margin:0px; padding:0px 20px; font-size:14px; font-family:'Times New Roman'">
<pre style="margin-top:0px; margin-bottom:0px"><div style="font-family:'Courier New',Courier,monospace">2
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
aba
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
acacac</div></pre>
</div>
<div class="panel_bottom" style="height:auto; margin:0px; font-family:'Times New Roman'; font-size:14px">
 </div>
<p><br style="font-family:'Times New Roman'; font-size:14px"/></p>
<div align="left" class="panel_title" style="height:38px; background-color:transparent; padding:0px 14px; color:rgb(124,169,237); font-size:18px; font-family:Arial; font-weight:bold">
Sample Output</div>
<div class="panel_content" style="height:auto; margin:0px; padding:0px 20px; font-size:14px; font-family:'Times New Roman'">
<pre style="margin-top:0px; margin-bottom:0px"><div style="font-family:'Courier New',Courier,monospace">1
6</div><div>
</div></pre>
</div>
<p></p>
<p>题意:<span style="font-family:Arial; font-size:14px; line-height:26px">首先输入n表示有n个测试,接着下一行有26个数分别表示a,b,c….z的价值,然后输入一行字符串,求将该字符串二分后的最大价值,二分后的字串如果是回文串则价值为字符价值之和,否则价值为0</span></p>
<p><span style="font-family:Arial"><span style="font-size:14px; line-height:26px">分析:将原串s1反转得到s2，然后进行s1,s2扩展KMP匹配,得到extend,对于s1的前i个字符如果和s2的后i个字符相等即extend[len-i] == i则前i个字符为回文串,判断后len-i个字符是否是回文串用s2,s1进行扩展KMP即可</span></span></p>
<p><span style="font-family:Arial"><span style="font-size:14px; line-height:26px">扩展KMP详解:<a href="http://wenku.baidu.com/view/8e9ebefb0242a8956bece4b3.html">http://wenku.baidu.com/view/8e9ebefb0242a8956bece4b3.html</a></span></span></p>
<p><span style="font-family:Arial">另一种KMP做法:<a href="http://blog.csdn.net/xingyeyongheng/article/details/9292449">http://blog.csdn.net/xingyeyongheng/article/details/9292449</a></span></p>
<p>另一种manacher做法:<a href="http://blog.csdn.net/xingyeyongheng/article/details/9386313">http://blog.csdn.net/xingyeyongheng/article/details/9386313</a></p>
<p><span style="font-family:Arial; font-size:14px; line-height:26px"></span></p>
<pre class="brush:cpp" name="code">#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;cstdlib&gt;
#include&lt;cstring&gt;
#include&lt;string&gt;
#include&lt;queue&gt;
#include&lt;algorithm&gt;
#include&lt;map&gt;
#include&lt;iomanip&gt;
#define INF 99999999
using namespace std;

const int MAX=500000+10;
char s1[MAX],s2[MAX];
int next[MAX],extend1[MAX],extend2[MAX];
int sum[MAX],val[27];

void get_next(char *a,int len){
	int k=0,i=1;
	next[0]=len;//可有可无,因为用不上 
	while(k+1&lt;len &amp;&amp; a[k] == a[k+1])++k;
	next[1]=k;//这里预先算好next[1]是因为不能k=0,否则next[i-k]=next[i]不是已算好的 
	k=1;
	while(++i&lt;len){//和EKMP的过程一样 
		int maxr=k+next[k]-1;
		next[i]=min(next[i-k],max(maxr-i+1,0));//这里是扩展KMP的精髓,即算法核心思想就是这
		while(i+next[i]&lt;len &amp;&amp; a[next[i]] == a[i+next[i]])++next[i];
		if(i+next[i]&gt;k+next[k])k=i; 
	}
}

void EKMP(char *a,char *b,int *extend,int len){
	get_next(a,len);
	int k=0,i=0;
	while(k&lt;len &amp;&amp; a[k] == b[k])++k;
	extend[0]=k;
	k=0;
	while(++i&lt;len){
		int maxr=k+extend[k]-1;
		extend[i]=min(next[i-k],max(maxr-i+1,0));//next[i-k]是a与b从i开始的可能已经匹配的长度
		while(i+extend[i]&lt;len &amp;&amp; a[extend[i]] == b[i+extend[i]])++extend[i];//这里是扩展KMP的精髓,即算法核心思想就是这
		if(i+extend[i]&gt;k+extend[k])k=i; 
	}
}

int main(){
	int n;
	cin&gt;&gt;n;
	while(n--){
		for(int i=0;i&lt;26;++i)cin&gt;&gt;val[i];
		scanf("%s",s1);
		int len=strlen(s1);
		for(int i=1;i&lt;=len;++i){
			sum[i]=sum[i-1]+val[s1[i-1]-'a'];
			s2[i-1]=s1[len-i];
		}
		EKMP(s1,s2,extend1,len);
		EKMP(s2,s1,extend2,len);
		int ans=0,temp=0;
		for(int i=1;i&lt;len;++i){
			if(extend1[len-i] == i)temp+=sum[i];//表示前i个字符是回文串
			if(extend2[i] == len-i)temp+=sum[len]-sum[i];//表示后len-i个字符为回文串
			if(temp&gt;ans)ans=temp;
			temp=0; 
		}
		cout&lt;&lt;ans&lt;&lt;endl;
	}
	return 0;
} </pre>
<div style="padding-top:20px">
<p style="font-size:12px;">版权声明：本文为博主原创文章，未经博主允许不得转载。</p>
</div>
<div>
</script>
<!-- acm-hf-01 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-9460629317209118" data-ad-slot="5011774182" style="display:inline-block;width:728px;height:90px"></ins>

(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<div class="bdsharebuttonbox"><a class="bds_more" data-cmd="more" href="#"></a><a class="bds_qzone" data-cmd="qzone" href="#" title="分享到QQ空间"></a><a class="bds_tsina" data-cmd="tsina" href="#" title="分享到新浪微博"></a><a class="bds_tqq" data-cmd="tqq" href="#" title="分享到腾讯微博"></a><a class="bds_renren" data-cmd="renren" href="#" title="分享到人人网"></a><a class="bds_weixin" data-cmd="weixin" href="#" title="分享到微信"></a></div>

</div><ol id="commentlist">
<li class="comment even thread-even depth-1" id="li-comment-73586">
<article class="comment" id="comment-73586">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919522790" rel="external nofollow">新用户912035</a></span> on <a href="http://www.acmerblog.com/hdu-3613-best-reward-6576.html#comment-73586" rel="nofollow"><time datetime="2017-04-12T00:07:34+00:00" pubdate="">2017年4月12日 at 上午12:07</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>菇凉，你的胃掉了</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-59351">
<article class="comment" id="comment-59351">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">blogpick</a></span> on <a href="http://www.acmerblog.com/hdu-3613-best-reward-6576.html#comment-59351" rel="nofollow"><time datetime="2015-05-31T08:38:56+00:00" pubdate="">2015年5月31日 at 上午8:38</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>确实有点难度，搞了好久。int溢出要注意</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-50515">
<article class="comment" id="comment-50515">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">wuzirui</a></span> on <a href="http://www.acmerblog.com/hdu-3613-best-reward-6576.html#comment-50515" rel="nofollow"><time datetime="2015-05-23T15:31:14+00:00" pubdate="">2015年5月23日 at 下午3:31</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>代码过于复杂了吧</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-32575">
<article class="comment" id="comment-32575">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">gnipuohz</a></span> on <a href="http://www.acmerblog.com/hdu-3613-best-reward-6576.html#comment-32575" rel="nofollow"><time datetime="2015-05-20T01:54:42+00:00" pubdate="">2015年5月20日 at 上午1:54</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>不是HDU 2411。。标题党么。。。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-50518">
<article class="comment" id="comment-50518">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">wawa_zmt</a></span> on <a href="http://www.acmerblog.com/hdu-3613-best-reward-6576.html#comment-50518" rel="nofollow"><time datetime="2015-05-08T18:55:08+00:00" pubdate="">2015年5月8日 at 下午6:55</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>正解，已改正。应该都是protected</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-59350">
<article class="comment" id="comment-59350">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">sgx_go</a></span> on <a href="http://www.acmerblog.com/hdu-3613-best-reward-6576.html#comment-59350" rel="nofollow"><time datetime="2015-05-07T15:33:15+00:00" pubdate="">2015年5月7日 at 下午3:33</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>太好了，收藏</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-50516">
<article class="comment" id="comment-50516">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">wynk0804</a></span> on <a href="http://www.acmerblog.com/hdu-3613-best-reward-6576.html#comment-50516" rel="nofollow"><time datetime="2015-04-15T23:17:51+00:00" pubdate="">2015年4月15日 at 下午11:17</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>很好的思路，可以借鉴</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-59352">
<article class="comment" id="comment-59352">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">CCCat</a></span> on <a href="http://www.acmerblog.com/hdu-3613-best-reward-6576.html#comment-59352" rel="nofollow"><time datetime="2015-04-10T08:07:25+00:00" pubdate="">2015年4月10日 at 上午8:07</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>很好的思路，可以借鉴</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-50517">
<article class="comment" id="comment-50517">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">yelawolf</a></span> on <a href="http://www.acmerblog.com/hdu-3613-best-reward-6576.html#comment-50517" rel="nofollow"><time datetime="2015-04-03T14:02:41+00:00" pubdate="">2015年4月3日 at 下午2:02</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>不错的代码！</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-50520">
<article class="comment" id="comment-50520">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">xun.gong</a></span> on <a href="http://www.acmerblog.com/hdu-3613-best-reward-6576.html#comment-50520" rel="nofollow"><time datetime="2015-02-11T11:02:47+00:00" pubdate="">2015年2月11日 at 上午11:02</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>第二个方法挺不错。NewHead代表新的头节点，通过递归找到最后一个节点之后，就把这个节点赋给NewHead，然后一直返回返回，中途这个值是没有变化的，一边返回一边把相应的指针方向颠倒，最后结束时返回新的头节点到主函数。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-32576">
<article class="comment" id="comment-32576">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">room306</a></span> on <a href="http://www.acmerblog.com/hdu-3613-best-reward-6576.html#comment-32576" rel="nofollow"><time datetime="2015-02-04T15:06:48+00:00" pubdate="">2015年2月4日 at 下午3:06</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>总结的很全面，学习了！</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-59348">
<article class="comment" id="comment-59348">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">silianbo</a></span> on <a href="http://www.acmerblog.com/hdu-3613-best-reward-6576.html#comment-59348" rel="nofollow"><time datetime="2015-01-22T01:49:51+00:00" pubdate="">2015年1月22日 at 上午1:49</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>.net中char类型不是两个字节么</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-50519">
<article class="comment" id="comment-50519">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">3136869079</a></span> on <a href="http://www.acmerblog.com/hdu-3613-best-reward-6576.html#comment-50519" rel="nofollow"><time datetime="2015-01-01T08:06:12+00:00" pubdate="">2015年1月1日 at 上午8:06</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>厉害啊，我遇见数学问题就头疼！</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-59349">
<article class="comment" id="comment-59349">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">chengleisheng</a></span> on <a href="http://www.acmerblog.com/hdu-3613-best-reward-6576.html#comment-59349" rel="nofollow"><time datetime="2014-12-17T13:21:48+00:00" pubdate="">2014年12月17日 at 下午1:21</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>信息不全</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
</ol>