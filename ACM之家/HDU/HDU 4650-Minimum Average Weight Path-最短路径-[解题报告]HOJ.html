<div class="c-top2" id="post-55">
<div class="datetime">2015<br/>09-17</div>
<div class="tit"><h1 class="entry-title">HDU 4650-Minimum Average Weight Path-最短路径-[解题报告]HOJ</h1>
<div class="entry-meta iititle2">
<span class="i2"><a href="http://www.acmerblog.com/author/spiderman" rel="author" title="由蜘蛛侠发布">蜘蛛侠</a></span><span class="i1"><a href="http://www.acmerblog.com/category/problemset/hdu" rel="category tag" title="查看HDU-杭电中的全部文章">HDU-杭电</a>, <a href="http://www.acmerblog.com/category/graph" rel="category tag" title="查看图论中的全部文章">图论</a>, <a href="http://www.acmerblog.com/category/basis/enumeration" rel="category tag" title="查看枚举中的全部文章">枚举</a></span><span class="i4">围观75次</span><span class="i3"><a class="ds-thread-count" data-thread-key="7695" href="http://www.acmerblog.com/hdu-4650-minimum-average-weight-path-7695.html#comments" title="《HDU 4650-Minimum Average Weight Path-最短路径-[解题报告]HOJ》上的评论">一条评论</a></span>
</div>
</div>
<div class="cls"></div>
</div><div class="entry-content">
<h1 style="color:rgb(26,92,200); text-align:center; font-family:'Times New Roman'">
Minimum Average Weight Path</h1>
<p><span style="font-family:'Times New Roman'; font-size:14px"><strong><span style="font-family:Arial; font-size:12px; color:green">Time Limit: 20000/10000 MS (Java/Others)    Memory Limit: 32768/32768 K (Java/Others)<br/>
Total Submission(s): 114    Accepted Submission(s): 54<br/>
</span></strong></span><br style="font-family:'Times New Roman'; font-size:14px"/><br/>
<br style="font-family:'Times New Roman'; font-size:14px"/></p>
<div align="left" class="panel_title" style="height:38px; background-color:transparent; padding:0px 14px; color:rgb(124,169,237); font-size:18px; font-family:Arial; font-weight:bold">
Problem Description</div>
<div class="panel_content" style="height:auto; margin:0px; padding:0px 20px; font-size:14px; font-family:'Times New Roman'">
In mathematics, a graph is a representation of a set of objects where some pairs of the objects are connected by links. The interconnected objects are represented by mathematical abstractions called vertices, and the links that connect some pairs of vertices<br/>
 are called edges. A path in a graph is a sequence of vertices, and for any 2 adjacent u, v, there is a edge from u to v in graph. A path contains at least one edge. In the graph in Sample 2, {3, 3, 2, 2} can form a path from 3 to 2. 
<p>One of the common problem is to find the shortest path between two certain vertices, or all of them. They’ve been well studied as the single source shortest path problem (SSSP) and the all pairs shortest paths problem (APSP).</p>
<p>In this problem, we’ll provide you a derivation analogous to APSP. You’ve been given a directed graph with positive or negative edge weights. We define the average weight of a path, as the sum of the edge weights divide the edges number of path. Now you need<br/>
 to find the minimum average weight between all pairs of vertices (APMAWP). </p>
</div>
<div class="panel_bottom" style="height:auto; margin:0px; font-family:'Times New Roman'; font-size:14px">
 </div>
<p><br style="font-family:'Times New Roman'; font-size:14px"/></p>
<div align="left" class="panel_title" style="height:38px; background-color:transparent; padding:0px 14px; color:rgb(124,169,237); font-size:18px; font-family:Arial; font-weight:bold">
Input</div>
<div class="panel_content" style="height:auto; margin:0px; padding:0px 20px; font-size:14px; font-family:'Times New Roman'">
Muiltcases. The first line contains two integer n, m, (1 ≤ n ≤ 10<sup>2</sup>, 1 ≤ m ≤ 10<sup>4</sup> ) the number of the vertices and the number of the edges.
<p>The next m lines, each line contains three intergers u, v, w, representing a directed edge from u to v with weight w. (|w| ≤ 10<sup>3</sup>)</p>
<p>There is no multi-edge. It can contain self-loops. </p>
</div>
<div class="panel_bottom" style="height:auto; margin:0px; font-family:'Times New Roman'; font-size:14px">
 </div>
<p><br style="font-family:'Times New Roman'; font-size:14px"/></p>
<div align="left" class="panel_title" style="height:38px; background-color:transparent; padding:0px 14px; color:rgb(124,169,237); font-size:18px; font-family:Arial; font-weight:bold">
Output</div>
<div class="panel_content" style="height:auto; margin:0px; padding:0px 20px; font-size:14px; font-family:'Times New Roman'">
A n × n matrix representing the APMAWP. The j’s element of the i’s row represents the minimum average weight of all the paths from vertex i to vertex j. If no such path exists, you need to output "NO" instead (DO NOT output quote please). For each real number,<br/>
 you need to keep exactly 3 digits after digit point.
</div>
<div class="panel_bottom" style="height:auto; margin:0px; font-family:'Times New Roman'; font-size:14px">
 </div>
<p><br style="font-family:'Times New Roman'; font-size:14px"/></p>
<div align="left" class="panel_title" style="height:38px; background-color:transparent; padding:0px 14px; color:rgb(124,169,237); font-size:18px; font-family:Arial; font-weight:bold">
Sample Input</div>
<div class="panel_content" style="height:auto; margin:0px; padding:0px 20px; font-size:14px; font-family:'Times New Roman'">
<pre style="margin-top:0px; margin-bottom:0px"><div style="font-family:'Courier New',Courier,monospace">4 4
2 1 2
1 3 -8
2 4 -6
4 3 1
5 8
3 3 735
2 1 946
4 2 276
2 2 -990
3 2 -162
4 4 -18
3 5 783
5 5 -156</div></pre>
</div>
<div class="panel_bottom" style="height:auto; margin:0px; font-family:'Times New Roman'; font-size:14px">
 </div>
<p><br style="font-family:'Times New Roman'; font-size:14px"/></p>
<div align="left" class="panel_title" style="height:38px; background-color:transparent; padding:0px 14px; color:rgb(124,169,237); font-size:18px; font-family:Arial; font-weight:bold">
Sample Output</div>
<div class="panel_content" style="height:auto; margin:0px; padding:0px 20px; font-size:14px; font-family:'Times New Roman'">
<pre style="margin-top:0px; margin-bottom:0px"><div style="font-family:'Courier New',Courier,monospace">NO NO -8.000 NO
2.000 NO -3.000 -6.000
NO NO NO NO
NO NO 1.000 NO
NO NO NO NO NO
-990.000 -990.000 NO NO NO
-990.000 -990.000 735.000 NO -156.000
-990.000 -990.000 NO -18.000 NO
NO NO NO NO -156.000</div></pre>
</div>
<div class="panel_bottom" style="height:auto; margin:0px; font-family:'Times New Roman'; font-size:14px">
 </div>
<p><br style="font-family:'Times New Roman'; font-size:14px"/></p>
<div align="left" class="panel_title" style="height:38px; background-color:transparent; padding:0px 14px; color:rgb(124,169,237); font-size:18px; font-family:Arial; font-weight:bold">
Source</div>
<div class="panel_content" style="height:auto; margin:0px; padding:0px 20px; font-size:14px; font-family:'Times New Roman'">
<a href="http://acm.hdu.edu.cn/search.php?field=problem&amp;key=2013%20Multi-University%20Training%20Contest%205&amp;source=1&amp;searchmode=source" style="color:rgb(26,92,200); text-decoration:none" target="_blank">2013 Multi-University Training Contest<br/>
 5</a></div>
<div class="panel_bottom" style="height:auto; margin:0px; font-family:'Times New Roman'; font-size:14px">
 </div>
<p><br style="font-family:'Times New Roman'; font-size:14px"/></p>
<div align="left" class="panel_title" style="height:38px; background-color:transparent; padding:0px 14px; color:rgb(124,169,237); font-size:18px; font-family:Arial; font-weight:bold">
Recommend</div>
<div class="panel_content" style="height:auto; margin:0px; padding:0px 20px; font-size:14px; font-family:'Times New Roman'">
zhuyuanchen520</div>
<p></p>
<h1>解题思路：</h1>
<div>基本就是抄这个的：<a href="http://blog.csdn.net/nealgavin/article/details/9819371" target="_blank">http://blog.csdn.net/nealgavin/article/details/9819371</a>。比赛的时候没做出来</div>
<div>我阐述下这位的想法，</div>
<div>首先计算出任意两个点之间最少需要经过多少条边可达，记为vis[u][v]表示u到v最少需要经过vis[u][v]条边，如果不可达就是-1；</div>
<div><span style="white-space:pre"></span>这个过程可以看成是floyd，n^3可求</div>
<div>然后分别计算经过k(1&lt;=k&lt;=n)条边的时候，u到v的最短路长度，并用它来更新答案ans[u][v]。</div>
<div><span style="white-space:pre"></span>从1~n来枚举k，利用类似矩阵相乘的n^3方法可以计算经过k条边的最短路，更新ans是n^2。总的来说是n^4</div>
<div>最后是把环考虑进去，前面都是经过了k(k&lt;=n)条边的时候的答案，对于有环的情况ans[x][x]其实是正确的答案，因为如果x-&gt;x有环的话，这个环最多包含n个点，这个环即使重复走多次也不会使ans[x][x]变小的，所以ans[x][x]此时是正确的。</div>
<div>所以就枚举i,j,k，如果有i-&gt;k-&gt;j的路径的话，就用ans[k][k]来尝试更新ans[i][j]就行了。</div>
<h1>代码：</h1>
<div>
<pre class="brush:cpp" name="code">#include&lt;cstdio&gt;
#include&lt;cstring&gt;
#include&lt;iostream&gt;
using namespace std;
const int N = 101;
const double INF = 10000000000.0;
const int INF_INT =10000000;
int side[N][N];
int dis[N][N];
int vis[N][N];
int tmp[N][N];
double ans[N][N];
int main(){
	int n,m;
	//freopen("1008.in","r",stdin);
	//freopen("1008_my.out","w",stdout);
	while(~scanf("%d%d",&amp;n,&amp;m)){
		memset(vis,-1,sizeof(vis));
		for(int i=1;i&lt;=n;i++)for(int j=1;j&lt;=n;j++){ans[i][j]=INF;side[i][j]=INF_INT;}
		for(int i=0;i&lt;m;i++){
			int u,v,w;
			scanf("%d%d%d",&amp;u,&amp;v,&amp;w);
			side[u][v]=w;
			vis[u][v]=1;
		}
		for(int k=1;k&lt;=n;k++)for(int i=1;i&lt;=n;i++)if(vis[i][k]!=-1){
			for(int j=1;j&lt;=n;j++)if(vis[k][j]!=-1){
				if(vis[i][j]==-1)vis[i][j]=vis[i][k]+vis[k][j];
				else vis[i][j]=min(vis[i][j],vis[i][k]+vis[k][j]);
			}
		}
		for(int i=1;i&lt;=n;i++)for(int j=1;j&lt;=n;j++)dis[i][j]=side[i][j];
		for(int k=1;k&lt;=n;k++){
			for(int i=1;i&lt;=n;i++)for(int j=1;j&lt;=n;j++)if(vis[i][j]!=-1&amp;&amp;k&gt;=vis[i][j]){
				ans[i][j]=min(ans[i][j],(double)dis[i][j]/k);
			}
			for(int i=1;i&lt;=n;i++)for(int j=1;j&lt;=n;j++){tmp[i][j]=dis[i][j];dis[i][j]=INF_INT;}
			for(int i=1;i&lt;=n;i++)for(int j=1;j&lt;=n;j++){
				for(int h=1;h&lt;=n;h++){
					if(vis[i][h]==-1||k&lt;vis[i][h])continue;
					if(vis[h][j]==-1||k&lt;vis[h][j])continue;
					dis[i][j]=min(dis[i][j],tmp[i][h]+side[h][j]);
				}
			}
		}
		for(int i=1;i&lt;=n;i++)for(int j=1;j&lt;=n;j++)if(vis[i][j]!=-1){
			for(int k=1;k&lt;=n;k++)if(vis[i][k]!=-1&amp;&amp;vis[k][j]!=-1&amp;&amp;vis[k][k]!=-1){
				ans[i][j]=min(ans[i][j],ans[k][k]);
			}
		}
		for(int i=1;i&lt;=n;i++){
			int j=1;
			if(vis[i][j]==-1)printf("NO");
			else printf("%.3lf",ans[i][j]);
			for(j=2;j&lt;=n;j++){
				if(vis[i][j]==-1)printf(" NO");
				else printf(" %.3lf",ans[i][j]);
			}
			printf("\n");
		}
	}
}
</pre>
</div>
<div style="padding-top:20px">
<p style="font-size:12px;">版权声明：本文为博主原创文章，未经博主允许不得转载。</p>
</div>
<p>参考：http://blog.csdn.net/wh2124335/article/details/9821935</p>
<div>
</script>
<!-- acm-hf-01 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-9460629317209118" data-ad-slot="5011774182" style="display:inline-block;width:728px;height:90px"></ins>

(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<div class="bdsharebuttonbox"><a class="bds_more" data-cmd="more" href="#"></a><a class="bds_qzone" data-cmd="qzone" href="#" title="分享到QQ空间"></a><a class="bds_tsina" data-cmd="tsina" href="#" title="分享到新浪微博"></a><a class="bds_tqq" data-cmd="tqq" href="#" title="分享到腾讯微博"></a><a class="bds_renren" data-cmd="renren" href="#" title="分享到人人网"></a><a class="bds_weixin" data-cmd="weixin" href="#" title="分享到微信"></a></div>

</div><ol id="commentlist">
<li class="comment even thread-even depth-1" id="li-comment-97197">
<article class="comment" id="comment-97197">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919531860" rel="external nofollow">新用户560865</a></span> on <a href="http://www.acmerblog.com/hdu-4650-minimum-average-weight-path-7695.html#comment-97197" rel="nofollow"><time datetime="2017-04-20T00:52:34+00:00" pubdate="">2017年4月20日 at 上午12:52</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>好快 终于沙发了</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
</ol>