<div class="c-top2" id="post-55">
<div class="datetime">2015<br/>09-17</div>
<div class="tit"><h1 class="entry-title">HDU 4610-Cards-最小生成树-[解题报告]HOJ</h1>
<div class="entry-meta iititle2">
<span class="i2"><a href="http://www.acmerblog.com/author/spiderman" rel="author" title="由蜘蛛侠发布">蜘蛛侠</a></span><span class="i1"><a href="http://www.acmerblog.com/category/problemset/hdu" rel="category tag" title="查看HDU-杭电中的全部文章">HDU-杭电</a>, <a href="http://www.acmerblog.com/category/graph/mst" rel="category tag" title="查看最小生成树中的全部文章">最小生成树</a>, <a href="http://www.acmerblog.com/category/basis/enumeration" rel="category tag" title="查看枚举中的全部文章">枚举</a></span><span class="i4">围观62次</span><span class="i3"><a class="ds-thread-count" data-thread-key="7655" href="http://www.acmerblog.com/hdu-4610-cards-7655.html#comments" title="《HDU 4610-Cards-最小生成树-[解题报告]HOJ》上的评论">9 条评论</a></span>
</div>
</div>
<div class="cls"></div>
</div><div class="entry-content">
<div>
<h1 class="mytitle mybigtile">Cards</h1>
</div>
<div>
<p class="mytitle"> 问题描述 :</p>
</div>
<div class="mypanel">
Given some cards each assigned a number, you’re required to select EXACTLY K cards among them.<br/>While you select a card, I will check the number assigned to it and see if it satisfies some of the following conditions:<br/><strong>1.</strong>  the number is a prime number;<br/><strong>2.</strong>  the amount of its divisors is a prime number;<br/><strong>3.</strong>  the sum of its divisors is a prime number;<br/><strong>4.</strong>  the product of all its divisors is a perfect square number. A perfect square number is such a kind of number that it can be written as a square of an integer.<br/>The score you get from this card is equal to the amount of conditions that its number satisfies. The total score you get from the selection of K cards is equal to the sum of scores of each card you select.<br/>After you have selected K cards, I will check if there’s any condition that has never been satisfied by any card you select. If there is, I will add some extra scores to you for each unsatisfied condition. To make the game more interesting, this score may be negative.<br/>After this, you will get your final score. Your task is to figure out the score of each card and find some way to maximize your final score.<br/>Note that 1 is not a prime number. In this problem, we consider a number to be a divisor of itself. For example, considering the number 16, it is not a prime. All its divisors are respectively 1, 2, 4, 8 and 16, and thus, it has 5 divisors with a sum of 31 and a product of 1024. Therefore, it satisfies the condition 2, 3 and 4, which deserves 3 points. </div>
<div>
<p class="mytitle"> 输入:</p>
</div>
<div class="mypanel">
The first line of the input contains the number of test cases T.<br/>Each test case begins with two integers N and K, indicating there are N kinds of cards, and you’re required to select K cards among them.<br/>The next N lines describes all the cards. Each of the N lines consists of two integers A and B, which denote that the number written on this kind of card is A, and you can select at most B cards of this kind.<br/>The last line contains 4 integers, where the ith integer indicates the extra score that will be added to the result if the ith condition is not satisfied. The ABSOLUTE value of these four integers will not exceed 40000.<br/>You may assume 0&lt;N≤10<sup>3</sup>,0&lt;K≤10<sup>4</sup>,1≤A≤10<sup>6</sup>,1≤B≤10<sup>4</sup>,T≤40 and the total N of all cases is no more than 20000. In each case there are always enough cards that you’re able to select exact K cards among them. </div>
<div>
<p class="mytitle"> 输出:</p>
</div>
<div class="mypanel">
The first line of the input contains the number of test cases T.<br/>Each test case begins with two integers N and K, indicating there are N kinds of cards, and you’re required to select K cards among them.<br/>The next N lines describes all the cards. Each of the N lines consists of two integers A and B, which denote that the number written on this kind of card is A, and you can select at most B cards of this kind.<br/>The last line contains 4 integers, where the ith integer indicates the extra score that will be added to the result if the ith condition is not satisfied. The ABSOLUTE value of these four integers will not exceed 40000.<br/>You may assume 0&lt;N≤10<sup>3</sup>,0&lt;K≤10<sup>4</sup>,1≤A≤10<sup>6</sup>,1≤B≤10<sup>4</sup>,T≤40 and the total N of all cases is no more than 20000. In each case there are always enough cards that you’re able to select exact K cards among them.</div>
<div>
<p class="mytitle"> 样例输入:</p>
</div>
<pre class="mypanel iopanel">
1
5 3
1 1
2 1
3 1
4 1
5 1
1 2 3 4</pre>
<div>
<p class="mytitle"> 样例输出:</p>
</div>
<pre class="mypanel iopanel">
1 3 2 2 2
11</pre>
<p> <!-- problem end --></p>
<p><span style="font-size:18px">转载请注明出处，谢谢<a>http://blog.csdn.net/ACM_cxlove?viewmode=contents</a>    by—cxlove</span></p>
<p><span style="font-size:18px">题目：每个数，有4个评估</span></p>
<p><span style="font-size:18px">1、是素数 2、约数个数是素数 3、约数的和是素数 4、约数的乘积是完全平方数</span></p>
<p><span style="font-size:18px">从n个中选出k个，使得分数最高，如果选的k个中没有一个满足某个条件，则有另外的分值</span></p>
<p><span style="font-size:18px"><a>http://acm.hdu.edu.cn/showproblem.php?pid=4610</a><br/>
<br/>
</span></p>
<p><span style="font-size:18px">首先因为数据范围不大，1-1e6，可以预处理，用到的数是20000个</span></p>
<p><span style="font-size:18px">第一次把1e6的所有数的各项评估都完成，直接TLE，N * sqrt(N)的复杂度，其实用到的只有2W，不需要全部预处理，打好素数表就行了。<br/>
<br/>
</span></p>
<p><span style="font-size:18px">第一项直接利用素数表，2、3项枚举约数后利用素数表，第4项不能直接保存乘积再判断，可以发现sqrt(n)枚举约数的时候，每次两个约数 i , n / i 他们的乘积是n，所以约数乘积是n ^ y * (n 是平方数？ sqrt(n) : 1) 。</span></p>
<p><span style="font-size:18px">所以可以边乘边化简。</span></p>
<p><span style="font-size:18px">处理完之后，对于所有的数，可以分为2 ^ 4类。</span></p>
<p><span style="font-size:18px">第一次做法是：枚举哪几种评估不选，然后 贪心，WA，对拍后发现问题，这样选可能某个评估的值还是没有选到，但是额外值没有加入，而额外值又可能是负的。</span></p>
<p><span style="font-size:18px">第二次：枚举2 ^ 16种情况，表现选哪几种，要注意的时候，枚举了哪几种，那么就至少要取一个，否则还是会出现上面的情况。之后还是贪心就行了。</span></p>
<p><span style="font-size:18px"></span></p>
<pre class="brush:cpp" name="code">#include &lt;iostream&gt;
#include &lt;cstdio&gt;
#include &lt;cstring&gt;
#include &lt;vector&gt;
#include &lt;cmath&gt;
#include &lt;algorithm&gt;
using namespace std;
typedef long long LL;
const int N = 1000001;
const int M = 1005;
bool isprime[N &lt;&lt; 2] = {false}, flag[N][4] = {false} , vis[N] = {false};
int score[N] = {0} , state[N];
int n , k , b[4] , cnt[1 &lt;&lt; 4] , get[1 &lt;&lt; 4] , id[1 &lt;&lt; 4];
bool issquare (LL num) {
    LL t = sqrt(num + 0.0);
    if(t * t == num || (t + 1) * (t + 1) == num || (t - 1) * (t - 1) == num) return true;
    return false;
}
bool cmp (int a , int b) {
    return get[a] &gt; get[b];
}
void Init() {
    for (int i = 0 ; i &lt; N &lt;&lt; 2; i ++) {
        isprime[i] = true;
    }
    isprime[1] = false;
    for (int i = 2 ; i &lt; N &lt;&lt; 2 ; i ++) {
        if (! isprime[i]) continue;
        for (int j = 2 ; i * j &lt; N &lt;&lt; 2 ; j ++) {
            isprime[i * j] = false;
        }
    }
    get[0] = 0;
    for (int i = 1 ; i &lt; 1 &lt;&lt; 4 ; i ++) {
        get[i] = get[i &gt;&gt; 1] + (i &amp; 1);
    }
    for (int i = 0 ; i &lt; 1 &lt;&lt; 4 ; i ++) {
        id[i] = i;
    }
    sort (id , id + (1 &lt;&lt; 4) , cmp);
}
void check(int i) {
    if (vis[i]) return ;
    flag[i][0] = isprime[i];
    int sum = 0 , cnt = 0;
    LL product = 1LL;
    for (int j = 1 ; j * j &lt;= i ; j ++) {
        if(i % j == 0) {
            product = (LL)product * j;
            sum += j;
            cnt ++;
            if (j * j != i) {
                product *= i / j;
                sum += i / j;
                cnt ++;
            }
            if (product == (LL)i * i) {
                product = 1LL;
            }
        }
    }
    flag[i][1] = isprime[cnt];
    flag[i][2] = isprime[sum];
    flag[i][3] = issquare(product);
    for (int j = 0 ; j &lt; 4 ; j ++) {
        score[i] += flag[i][j] ? 1 : 0;
        state[i] += (flag[i][j] ? 1 : 0) &lt;&lt; j;
    }
    vis[i] = true;
}
int main () {
    #ifndef ONLINE_JUDGE
        freopen("input.txt", "r" , stdin);
    #endif
    Init();
    int t;
    scanf ("%d", &amp;t);
    while (t --) {
        scanf ("%d %d", &amp;n, &amp;k);
        for (int i = 0 ; i &lt; 1 &lt;&lt; 4; i ++) {
            cnt[i] = 0;
        }
        for (int i = 0 ; i &lt; n ; i ++) {
            int a , b;
            scanf ("%d %d", &amp;a, &amp;b);
            check(a);
            cnt[state[a]] += b;
            printf("%d%c", score[a], i == n - 1 ? '\n' : ' ');
        }
        for (int i = 0 ; i &lt; 4 ; i ++) {
            scanf ("%d", &amp;b[i]);
        }
        int ans = - (1 &lt;&lt; 20);
        for (int i = 0 ; i &lt; 1 &lt;&lt; 16 ; i ++) {
            int remain = k , ret = 0 , cur = 0;
            for (int j = 0 ; j &lt; 1 &lt;&lt; 4 ; j ++) {
                if(! (i &amp; (1 &lt;&lt; id[j]))) continue;
                if(cnt[id[j]]) {
                    remain --;
                    ret += get[id[j]];
                }
                else remain = -1;
            } 
            if (remain &lt; 0) continue;
            for (int j = 0 ; j &lt; 1 &lt;&lt; 4 ; j ++) {
                if(! (i &amp; (1 &lt;&lt; id[j]))) continue;
                cur |= id[j];
                if(remain &amp;&amp; remain &gt; cnt[id[j]] - 1) {
                    remain -= cnt[id[j]] - 1;
                    ret += (cnt[id[j]] - 1) * get[id[j]];
                }
                else {
                    ret += remain * get[id[j]];
                    remain = 0;
                }
            }
            if (remain == 0) {
                for (int j = 0 ; j &lt; 4 ; j ++) {
                    if(! ((1 &lt;&lt; j) &amp; cur) )
                        ret += b[j];
                }
                ans = max (ans , ret);
            }
        }
        printf ("%d\n", ans);
    }
    return 0;
}</pre>
<div style="padding-top:20px">
<p style="font-size:12px;">版权声明：本文为博主原创文章，未经博主允许不得转载。</p>
</div>
<p>参考：http://blog.csdn.net/acm_cxlove/article/details/9491289</p>
<div>
</script>
<!-- acm-hf-01 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-9460629317209118" data-ad-slot="5011774182" style="display:inline-block;width:728px;height:90px"></ins>

(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<div class="bdsharebuttonbox"><a class="bds_more" data-cmd="more" href="#"></a><a class="bds_qzone" data-cmd="qzone" href="#" title="分享到QQ空间"></a><a class="bds_tsina" data-cmd="tsina" href="#" title="分享到新浪微博"></a><a class="bds_tqq" data-cmd="tqq" href="#" title="分享到腾讯微博"></a><a class="bds_renren" data-cmd="renren" href="#" title="分享到人人网"></a><a class="bds_weixin" data-cmd="weixin" href="#" title="分享到微信"></a></div>

</div><ol id="commentlist">
<li class="comment even thread-even depth-1" id="li-comment-97539">
<article class="comment" id="comment-97539">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919461276" rel="external nofollow">新用户733487</a></span> on <a href="http://www.acmerblog.com/hdu-4610-cards-7655.html#comment-97539" rel="nofollow"><time datetime="2017-04-20T05:15:17+00:00" pubdate="">2017年4月20日 at 上午5:15</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>好好看看档在哪。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-66572">
<article class="comment" id="comment-66572">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919525443" rel="external nofollow">新用户722057</a></span> on <a href="http://www.acmerblog.com/hdu-4610-cards-7655.html#comment-66572" rel="nofollow"><time datetime="2017-04-10T22:27:49+00:00" pubdate="">2017年4月10日 at 下午10:27</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>打开 980.so/2RMNNE 都是浪妞</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-66571">
<article class="comment" id="comment-66571">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919525443" rel="external nofollow">新用户722057</a></span> on <a href="http://www.acmerblog.com/hdu-4610-cards-7655.html#comment-66571" rel="nofollow"><time datetime="2017-04-10T22:27:49+00:00" pubdate="">2017年4月10日 at 下午10:27</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>打开 980.so/2RMNNE 都是浪妞</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-66570">
<article class="comment" id="comment-66570">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919525443" rel="external nofollow">新用户722057</a></span> on <a href="http://www.acmerblog.com/hdu-4610-cards-7655.html#comment-66570" rel="nofollow"><time datetime="2017-04-10T22:27:49+00:00" pubdate="">2017年4月10日 at 下午10:27</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>打开 980.so/2RMNNE 都是浪妞</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-66569">
<article class="comment" id="comment-66569">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919525443" rel="external nofollow">新用户722057</a></span> on <a href="http://www.acmerblog.com/hdu-4610-cards-7655.html#comment-66569" rel="nofollow"><time datetime="2017-04-10T22:27:49+00:00" pubdate="">2017年4月10日 at 下午10:27</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>打开 980.so/2RMNNE 都是浪妞</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-66568">
<article class="comment" id="comment-66568">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919525443" rel="external nofollow">新用户722057</a></span> on <a href="http://www.acmerblog.com/hdu-4610-cards-7655.html#comment-66568" rel="nofollow"><time datetime="2017-04-10T22:27:49+00:00" pubdate="">2017年4月10日 at 下午10:27</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>打开 980.so/2RMNNE 都是浪妞</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-66567">
<article class="comment" id="comment-66567">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919525443" rel="external nofollow">新用户722057</a></span> on <a href="http://www.acmerblog.com/hdu-4610-cards-7655.html#comment-66567" rel="nofollow"><time datetime="2017-04-10T22:27:49+00:00" pubdate="">2017年4月10日 at 下午10:27</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>打开 980.so/2RMNNE 都是浪妞</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-66566">
<article class="comment" id="comment-66566">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919525443" rel="external nofollow">新用户722057</a></span> on <a href="http://www.acmerblog.com/hdu-4610-cards-7655.html#comment-66566" rel="nofollow"><time datetime="2017-04-10T22:27:49+00:00" pubdate="">2017年4月10日 at 下午10:27</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>打开 980.so/2RMNNE 都是浪妞</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-66565">
<article class="comment" id="comment-66565">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919525443" rel="external nofollow">新用户722057</a></span> on <a href="http://www.acmerblog.com/hdu-4610-cards-7655.html#comment-66565" rel="nofollow"><time datetime="2017-04-10T22:27:49+00:00" pubdate="">2017年4月10日 at 下午10:27</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>打开 980.so/2RMNNE 都是浪妞</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
</ol>