<div class="c-top2" id="post-55">
<div class="datetime">2014<br/>03-16</div>
<div class="tit"><h1 class="entry-title">HDU 3358-Land Division-数论-[解题报告]HOJ</h1>
<div class="entry-meta iititle2">
<span class="i2"><a href="http://www.acmerblog.com/author/spiderman" rel="author" title="由蜘蛛侠发布">蜘蛛侠</a></span><span class="i1"><a href="http://www.acmerblog.com/category/problemset/hdu" rel="category tag" title="查看HDU-杭电中的全部文章">HDU-杭电</a>, <a href="http://www.acmerblog.com/category/math" rel="category tag" title="查看数学相关中的全部文章">数学相关</a>, <a href="http://www.acmerblog.com/category/basis/enumeration" rel="category tag" title="查看枚举中的全部文章">枚举</a></span><span class="i4">围观363次</span><span class="i3"><a class="ds-thread-count" data-thread-key="5290" href="http://www.acmerblog.com/hdu-3358-land-division-5290.html#comments" title="《HDU 3358-Land Division-数论-[解题报告]HOJ》上的评论">13 条评论</a></span>
</div>
</div>
<div class="cls"></div>
</div><div class="entry-content">
<div>
<h1 class="mytitle mybigtile">Land Division</h1>
</div>
<div>
<p class="mytitle"> 问题描述 :</p>
</div>
<div class="mypanel">
The king of the Far, Far Away Kingdom has passed-away and the kingdom must be split amongst his K sons. The kingdom, which can be drawn on a rectangular map, consists of N cities. To divide the land, they will draw K-1 straight segments on the map, all of them parallel to either the vertical or the horizontal axis of the map. This divides the map into exactly K rectangles, all having equal heights (if the dividing lines where vertical), or equal widths (if the dividing lines where horizontal). No segment should pass through any of the cities. Each son will then be assigned one random region out of the K regions and the cities inside that region will be his share.<br/>Of course, they want the division to be as fair as possible: theoretically, in the fairest division, each son should get N/K cities (we’ll call this value the baseline), but since the baseline isn’t always a whole number, each of the sons wants to be as close as possible to the baseline. We will calculate the unfairness of each son as the absolute difference between the number of cities assigned to him and the baseline. The fairest division is the one that minimizes the average unfairness of all the sons.
<p></p><center><img alt="Stock Chase" src="/img/1395299709097.jpg"/></center>
<p>Consider the example above with 3 sons and 6 cities (so the baseline is 6/3 = 2.0) Figure (a) is the original map. Figure (b) shows a non-optimal division (the dashed lines are the 2 dividing lines.) In this case, the middle region contains 3 cities (unfairness of |3 – 2| = 1), the left region contains 1 city (unfairness of |1 – 2| = 1), while the right region contains 2 cities (perfectly fair, unfairness of 0), so the average unfairness is 2/3.<br/>Figure (c) on the right shows the optimal division since all three regions contain the same number of cities for an average unfairness of 0.<br/>Write a program to determine the fairest land division for a given kingdom. </p></div>
<div>
<p class="mytitle"> 输入:</p>
</div>
<div class="mypanel">
Your program will be tested on one or more test cases. Each test case is described on N +1 lines.<br/>The first line of each test case specifies two positive integers: (N &lt;= 100, 000) and (K &lt;= 10) where N is the number of cities and K is number of children. Note that K &lt;= N.<br/>N lines follows, each describing the coordinates of a city by specifying two integers (x, y) where 0 &lt;= x, y &lt;= 100, 000. Since coordinates are rounded to the nearest integer, more than one city could have the exact same coordinate on the map. You may assume that the map of the kingdom is any rectangle that contains all of the given points (although such information is not needed by the program.) Note also that while all cities lie on integer coordinates, the dividing lines need not be.<br/>The last line of the input file contains two zeros. </div>
<div>
<p class="mytitle"> 输出:</p>
</div>
<div class="mypanel">
Your program will be tested on one or more test cases. Each test case is described on N +1 lines.<br/>The first line of each test case specifies two positive integers: (N &lt;= 100, 000) and (K &lt;= 10) where N is the number of cities and K is number of children. Note that K &lt;= N.<br/>N lines follows, each describing the coordinates of a city by specifying two integers (x, y) where 0 &lt;= x, y &lt;= 100, 000. Since coordinates are rounded to the nearest integer, more than one city could have the exact same coordinate on the map. You may assume that the map of the kingdom is any rectangle that contains all of the given points (although such information is not needed by the program.) Note also that while all cities lie on integer coordinates, the dividing lines need not be.<br/>The last line of the input file contains two zeros.</div>
<div>
<p class="mytitle"> 样例输入:</p>
</div>
<pre class="mypanel iopanel">
6 3
0 4
1 3
2 3
3 1
4 4
5 0
4 3
0 0
0 1
1 1
1 0
0 0</pre>
<div>
<p class="mytitle"> 样例输出:</p>
</div>
<pre class="mypanel iopanel">
1. 0/1
2. 8/9</pre>
<p> <!-- problem end --></p>
<p><span style="font-family:Arial; font-size:14px; line-height:26px">转载请注明出处，谢谢</span><a style="color:rgb(202,0,0); text-decoration:none; font-family:Arial; font-size:14px; line-height:26px"> </a><a style="color:rgb(202,0,0); text-decoration:none; font-family:Arial; font-size:14px; line-height:26px">http://blog.csdn.net/ACM_cxlove?viewmode=contents</a><span style="font-family:Arial; font-size:14px; line-height:26px">          <br/>
 by—cxlove</span></p>
<p><span style="font-family:Arial; font-size:14px; line-height:26px">题目：<a>http://poj.org/problem?id=3358</a></span></p>
<p><span style="font-family:SimHei; font-size:18px">将一个分数化成小数，转化成二进制后寻找循环节</span></p>
<p><span style="font-family:SimHei; font-size:18px">对于分数P/Q而言，首先化成最简，调整为P’=P/GCD(P,Q) Q’=Q/GCD(P,Q)</span></p>
<p><span style="font-family:SimHei; font-size:18px">我们知道转化成二进制，其实就是不断乘2，如果大于1，则去掉1，当前位为1，否则为0.</span></p>
<p><span style="font-family:SimHei; font-size:18px">表示成分数的时候便是P/Q,2*P/Q如果分子大于分母，则减掉，也相当于取余。</span></p>
<p><span style="font-family:SimHei; font-size:18px">于是我们假设在第I位的时候开始循环，第J位出现重复。</span></p>
<p><span style="font-family:SimHei; font-size:18px">而出现循环反正在分数上便是分母和分子都相同，由于在这里分母是不变的，只考虑分子</span></p>
<p><span style="font-family:SimHei; font-size:18px">那么（P’*2^I）%Q’==(P’*2^J)%Q ;</span></p>
<p><span style="font-family:SimHei; font-size:18px">一个同余式，作 些调整  P’*(2^J-2^I)==0(MOD Q’)   P’*2^I*(2^(J-I)-1)==0(MOD Q’)</span></p>
<p><span style="font-family:SimHei; font-size:18px">变成<span style="font-family:SimHei; font-size:18px">P’*2^I*(2^(J-I)-1)|Q’</span></span></p>
<p><span style="font-family:SimHei; font-size:18px"><span style="font-family:SimHei; font-size:18px">其中P’与Q’互质。那么<span style="font-family:SimHei; font-size:18px">2^I*(2^(J-I)-1)|Q’</span></span></span></p>
<p><span style="font-family:SimHei; font-size:18px"><span style="font-family:SimHei; font-size:18px"><span style="font-family:SimHei; font-size:18px">而<span style="font-family:SimHei; font-size:18px">(2^(J-I)-1是奇数，那么I的值便是Q’里面有多少个2^的幂，第一部分已经解决</span></span></span></span></p>
<p><span style="font-family:SimHei; font-size:18px"><span style="font-family:SimHei; font-size:18px"><span style="font-family:SimHei; font-size:18px"><span style="font-family:SimHei; font-size:18px">假设Q’除掉2的幂之后为Q”</span></span></span></span></p>
<p><span style="font-family:SimHei; font-size:18px"><span style="font-family:SimHei; font-size:18px"><span style="font-family:SimHei; font-size:18px"><span style="font-family:SimHei; font-size:18px">那么Q”|<span style="font-family:SimHei; font-size:18px">(2^(J-I)-1)，由费马小定理或者欧拉定理可知</span></span></span></span></span></p>
<p><span style="font-family:SimHei; font-size:18px">若A与P互质，则A^PHI(P) == 1 (MOD P)</span></p>
<p><span style="font-family:SimHei; font-size:18px">所以2^X ==1 (mod Q”)   必定存在解。</span></p>
<p><span style="font-family:SimHei; font-size:18px">我们要求的是最小的解，则枚举PHI(Q”)的因子，从小开始判断</span></p>
<p><span style="font-family:SimHei; font-size:18px">2^X==1(MOD Q”)</span></p>
<p><span style="font-family:SimHei; font-size:18px"></span></p>
<pre class="brush:cpp ">#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;cstring&gt;
#include&lt;algorithm&gt;
#include&lt;cmath&gt;
#define LL long long
#define N 1000000
using namespace std;
LL gcd(LL a,LL b){
	return b==0?a:gcd(b,a%b);
}
LL get_eular(LL n){
	LL ret=1;
	for(LL i=2;i*i&lt;=n;i++)
		if(n%i==0){
			ret*=i-1;
			n/=i;
			while(n%i==0){
				n/=i;
				ret*=i;
			}
		}
	if(n&gt;1)
		ret*=n-1;
	return ret;
}
LL PowMod(LL a,LL b,LL MOD){
	LL ret=1;
	while(b){
		if(b&amp;1)
			ret=(ret*a)%MOD;
		a=(a*a)%MOD;
		b&gt;&gt;=1;
	}
	return ret;
}
LL fact[100000],cnt;
void get_fact(LL n){
	cnt=0;
	for(LL i=2;i*i&lt;=n;i++)
		if(n%i==0){
			fact[cnt++]=i;
			fact[cnt++]=n/i;
		}
}
int main(){
	LL p,q;
	int cas=0;
	while(scanf("%lld/%lld",&amp;p,&amp;q)!=EOF){
		LL t=gcd(p,q);
		p/=t;
		q/=t;
		int c=1;
		while(!(q&amp;1)){
			q/=2;
			c++;
		}
		LL phi=get_eular(q),ans;
		get_fact(phi);
		fact[cnt++]=phi;
		sort(fact,fact+cnt);
		for(int i=0;i&lt;cnt;i++)
			if(PowMod(2,fact[i],q)==1){
				ans=fact[i];
				break;
			}
			printf("Case #%d: %d,%lld\n",++cas,c,ans);
	}
	return 0;
}</pre>
<p></p>
<p><span style="font-family:SimHei; font-size:18px"><span style="font-family:SimHei; font-size:18px"><span style="font-family:SimHei; font-size:18px"><span style="font-family:SimHei; font-size:18px"><br/>
</span></span></span></span></p>
<p><span style="font-family:SimHei; font-size:18px"><span style="font-family:SimHei; font-size:18px"><span style="font-family:SimHei; font-size:18px"><span style="font-family:SimHei; font-size:18px"><br/>
</span></span></span></span></p>
<p><span style="font-family:SimHei; font-size:18px"><span style="font-family:SimHei; font-size:18px"><span style="font-family:SimHei; font-size:18px"><span style="font-family:SimHei; font-size:18px"><br/>
</span></span></span></span></p>
<p><span style="font-family:SimHei; font-size:18px"><span style="font-family:SimHei; font-size:18px"><span style="font-family:SimHei; font-size:18px"><span style="font-family:SimHei; font-size:18px"><br/>
</span></span></span></span></p>
<p><span style="font-family:SimHei; font-size:18px"><span style="font-family:SimHei; font-size:18px"><span style="font-family:SimHei; font-size:18px"><span style="font-family:SimHei; font-size:18px"><br/>
</span></span></span></span></p>
<p>参考：http://blog.csdn.net/acm_cxlove/article/details/7832410</p>
<div>
</script>
<!-- acm-hf-01 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-9460629317209118" data-ad-slot="5011774182" style="display:inline-block;width:728px;height:90px"></ins>

(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<div class="bdsharebuttonbox"><a class="bds_more" data-cmd="more" href="#"></a><a class="bds_qzone" data-cmd="qzone" href="#" title="分享到QQ空间"></a><a class="bds_tsina" data-cmd="tsina" href="#" title="分享到新浪微博"></a><a class="bds_tqq" data-cmd="tqq" href="#" title="分享到腾讯微博"></a><a class="bds_renren" data-cmd="renren" href="#" title="分享到人人网"></a><a class="bds_weixin" data-cmd="weixin" href="#" title="分享到微信"></a></div>

</div><ol id="commentlist">
<li class="comment even thread-even depth-1" id="li-comment-77596">
<article class="comment" id="comment-77596">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919512589" rel="external nofollow">新用户592570</a></span> on <a href="http://www.acmerblog.com/hdu-3358-land-division-5290.html#comment-77596" rel="nofollow"><time datetime="2017-04-12T09:15:01+00:00" pubdate="">2017年4月12日 at 上午9:15</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>您可能因为灵魂太肮脏了，所以只从表面看文章。。。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-63386">
<article class="comment" id="comment-63386">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">PriceKiller</a></span> on <a href="http://www.acmerblog.com/hdu-3358-land-division-5290.html#comment-63386" rel="nofollow"><time datetime="2015-07-18T12:58:56+00:00" pubdate="">2015年7月18日 at 下午12:58</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>确实有点难度，搞了好久。int溢出要注意</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-48578">
<article class="comment" id="comment-48578">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">sgx_go</a></span> on <a href="http://www.acmerblog.com/hdu-3358-land-division-5290.html#comment-48578" rel="nofollow"><time datetime="2015-06-25T05:43:50+00:00" pubdate="">2015年6月25日 at 上午5:43</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>总数为2n，遍历到第n个，就是中间的位置</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-58387">
<article class="comment" id="comment-58387">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">actlea</a></span> on <a href="http://www.acmerblog.com/hdu-3358-land-division-5290.html#comment-58387" rel="nofollow"><time datetime="2015-05-08T23:36:30+00:00" pubdate="">2015年5月8日 at 下午11:36</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>总数为2n，遍历到第n个，就是中间的位置</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-29054">
<article class="comment" id="comment-29054">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">gaoriqiang2</a></span> on <a href="http://www.acmerblog.com/hdu-3358-land-division-5290.html#comment-29054" rel="nofollow"><time datetime="2015-04-08T21:42:47+00:00" pubdate="">2015年4月8日 at 下午9:42</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>加了星号 (*) 表示跳过此数据不读入. 因为scanf是不读取本行回车的</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-29059">
<article class="comment" id="comment-29059">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">NiKaWaLi</a></span> on <a href="http://www.acmerblog.com/hdu-3358-land-division-5290.html#comment-29059" rel="nofollow"><time datetime="2015-02-04T16:12:10+00:00" pubdate="">2015年2月4日 at 下午4:12</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>很强大啊，佩服</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-29058">
<article class="comment" id="comment-29058">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">spiderMan</a></span> on <a href="http://www.acmerblog.com/hdu-3358-land-division-5290.html#comment-29058" rel="nofollow"><time datetime="2015-01-03T20:47:54+00:00" pubdate="">2015年1月3日 at 下午8:47</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>处凡愚而不减，在圣贤而不增；<br/>住烦恼而不乱，居禅定而不寂。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-29053">
<article class="comment" id="comment-29053">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">siaswj</a></span> on <a href="http://www.acmerblog.com/hdu-3358-land-division-5290.html#comment-29053" rel="nofollow"><time datetime="2014-12-12T10:16:42+00:00" pubdate="">2014年12月12日 at 上午10:16</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>#pragma pack(2) 这个用法太坑爹</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-48577">
<article class="comment" id="comment-48577">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">YangXiaoZhong</a></span> on <a href="http://www.acmerblog.com/hdu-3358-land-division-5290.html#comment-48577" rel="nofollow"><time datetime="2014-12-10T15:05:27+00:00" pubdate="">2014年12月10日 at 下午3:05</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>隐藏最深的bug是(start+end)/2有可能上溢</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-29055">
<article class="comment" id="comment-29055">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">Bob</a></span> on <a href="http://www.acmerblog.com/hdu-3358-land-division-5290.html#comment-29055" rel="nofollow"><time datetime="2014-11-18T12:57:59+00:00" pubdate="">2014年11月18日 at 下午12:57</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>已修改。一些字符在编辑的时候转义了</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-29057">
<article class="comment" id="comment-29057">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">xiaobei</a></span> on <a href="http://www.acmerblog.com/hdu-3358-land-division-5290.html#comment-29057" rel="nofollow"><time datetime="2014-10-19T12:47:02+00:00" pubdate="">2014年10月19日 at 下午12:47</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>这怎么用Catalan数啊？求解答！</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-29060">
<article class="comment" id="comment-29060">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">silianbo</a></span> on <a href="http://www.acmerblog.com/hdu-3358-land-division-5290.html#comment-29060" rel="nofollow"><time datetime="2014-08-01T16:50:44+00:00" pubdate="">2014年8月1日 at 下午4:50</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>正是我要找的，适合新手</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-29056">
<article class="comment" id="comment-29056">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">HaibaraAi</a></span> on <a href="http://www.acmerblog.com/hdu-3358-land-division-5290.html#comment-29056" rel="nofollow"><time datetime="2014-07-30T06:59:34+00:00" pubdate="">2014年7月30日 at 上午6:59</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>总数为2n，遍历到第n个，就是中间的位置</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
</ol>