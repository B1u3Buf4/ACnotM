<div class="c-top2" id="post-55">
<div class="datetime">2014<br/>02-17</div>
<div class="tit"><h1 class="entry-title">HDU 2878-Great World of Goo-计算几何-[解题报告]HOJ</h1>
<div class="entry-meta iititle2">
<span class="i2"><a href="http://www.acmerblog.com/author/spiderman" rel="author" title="由蜘蛛侠发布">蜘蛛侠</a></span><span class="i1"><a href="http://www.acmerblog.com/category/problemset/hdu" rel="category tag" title="查看HDU-杭电中的全部文章">HDU-杭电</a>, <a href="http://www.acmerblog.com/category/search" rel="category tag" title="查看搜索中的全部文章">搜索</a>, <a href="http://www.acmerblog.com/category/dp2/line-dp" rel="category tag" title="查看线性DP中的全部文章">线性DP</a></span><span class="i4">围观472次</span><span class="i3"><a class="ds-thread-count" data-thread-key="4521" href="http://www.acmerblog.com/hdu-2878-great-world-of-goo-4521.html#comments" title="《HDU 2878-Great World of Goo-计算几何-[解题报告]HOJ》上的评论">11 条评论</a></span>
</div>
</div>
<div class="cls"></div>
</div><div class="entry-content">
<div>
<h1 class="mytitle mybigtile">Great World of Goo</h1>
</div>
<div>
<p class="mytitle"> 问题描述 :</p>
</div>
<div class="mypanel">
The game is built around the idea of creating large structures using balls of goo. It is based on the prototype game Tower of Goo developed for Kyle Gabler’s rapid game prototyping Experimental Gameplay Project. The game is divided into five chapters, each containing several levels. Each level has its own graphic and musical theme, giving it unique atmosphere, similar in style to Tim Burton’s film designs. There is also a bonus meta-game called World of Goo Corporation, where the objective is to build the highest tower using goo balls which the player collected through the course of the game. Players from all over the world can compete, as the height of the tower and number of goo balls used are being constantly uploaded to the 2D Boy server.<br/>–Wikipedia<br/>As mentioned above, World of Goo is an excellent independent game. Personally I like playing it rather than Plants vs. Zombies though both of them are great.<br/>Let’s consider a simplified version of “Fisty Bog” in Chapter One (Figure 1).
<p>(Figure 1)<br/></p><center><img src="http://www.acmerblog.com/img/1392912126833.jpg"/></center> <br/>Ignore the part before the red line, as it’s given by the system initially. The following goo balls make the bridge using regular triangles, numbered from 1, beginning from left to right. To ensure the bridge formed strictly horizontal, we place a light goo ball every three triangles, and in this problem we don’t need to care about those balls.
<p>From the figure we know that, some triangles are more danger during the construction process. For that case, goo balls want to be placed in different triangles. Risky goo balls want to be placed on the triangle more danger while others want safer ones. Now, my question comes, how many number of solutions exist when all goo balls are used and all wills are satisfied. </p></div>
<div>
<p class="mytitle"> 输入:</p>
</div>
<div class="mypanel">
The first line: and integer k (k&lt;=15) indicates the number of test case;<br/>For each test case:<br/>First line: n and m, 0&lt;m,n&lt;=500 , n represents the number of goo balls, m represents the number of wills;<br/>Line 2…m+1:<br/>Each line is consist of integers K A1 B1 A2 B2 … AK BK P C1 D1 C2 D2 … CP DP, represents a restriction. That means the goo ball(s) numbered between A1 and B1 (inclusive), or between A2 and B2 (inclusive) or … or between Ak and Bk (inclusive) wants to be placed at triangle(s) number between C1 and D1 (inclusive), or between C2 and D2 (inclusive) or … or between Ck and Dk (inclusive). Two restrictions may be the same or partly same. Every restriction is legal. </div>
<div>
<p class="mytitle"> 输出:</p>
</div>
<div class="mypanel">
The first line: and integer k (k&lt;=15) indicates the number of test case;<br/>For each test case:<br/>First line: n and m, 0&lt;m,n&lt;=500 , n represents the number of goo balls, m represents the number of wills;<br/>Line 2…m+1:<br/>Each line is consist of integers K A1 B1 A2 B2 … AK BK P C1 D1 C2 D2 … CP DP, represents a restriction. That means the goo ball(s) numbered between A1 and B1 (inclusive), or between A2 and B2 (inclusive) or … or between Ak and Bk (inclusive) wants to be placed at triangle(s) number between C1 and D1 (inclusive), or between C2 and D2 (inclusive) or … or between Ck and Dk (inclusive). Two restrictions may be the same or partly same. Every restriction is legal.</div>
<div>
<p class="mytitle"> 样例输入:</p>
</div>
<pre class="mypanel iopanel">
3
6 1
1 1 6 1 1 4
6 1
1 1 6 1 1 3
10 1
1 1 10 1 1 8</pre>
<div>
<p class="mytitle"> 样例输出:</p>
</div>
<pre class="mypanel iopanel">
720
0
OVERFLOW!</pre>
<p> <!-- problem end --></p>
<p><strong><span style="font-family: 黑体; font-size: 16px;">HDU_2878</span></strong></p>
<p><span style="font-family: 黑体; font-size: 16px;">    这个题目说实话，感觉这个题的解题思想很好，但是题面的描述啊，&amp;@！#￥&amp;*@！*&amp;！@#&amp;*！@#……&amp;*！@#*（￥@！）！！！！！！！</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">    看这张图就知道我为啥要吐槽题目的描述了……</span></p>
<p><span style="font-family: 黑体; font-size: 16px;"><img alt="" src="http://cdn.acmerblog.com/img/1392912153183.jpg"/></span></p>
<p><span style="font-family: 黑体; font-size: 16px;">    首先，题目里面核心就两个元素——球球和三角形，而且不难发现球球的数量-2就是三角形的数量，如果我们把球球可以放的位置按一定顺序编码的话，就会发现对于一段连续的三角形就会得到一段连续的位置，于是问题就变成了一段标号连续的球可以放到一段标号连续的位置中去，问最后有多少中方案，这就像是在求最大匹配有多少个一样，但是貌似没有直接求最大匹配个数的算法，所以采用搜索来实现。</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">    暂且先解释一下K A1 B1 A2 B2 … AK BK P C1 D1 C2 D2 … CP DP是什么意思,比如2 1 2 4 5 1 4 6，意思就是说标号为1、2、4、5的球可以放到标号为4、5、6的三角形中，转化成位置的话就是说这些球可以放到4、5、6、7、8这些位置上去。还有就是and all wills are satisfied这句话纯属扯淡，如果按所有will都满足去做的话就会是WA，实际上只要满足其中一个will就行，相当于将题目中的这些will取并集，而不是取交集。</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">    接下来就是思维很好的部分了，这个我也是在找到题解之后才会的（蛋疼的是只有题解没标程，所以一直到今早枚举题意的时候才偶然AC了这个题……）。建立一个N*N行2*N列的稀疏矩阵，每一行表示了某个球放到某个位置这样的特定的方案，如果这个球可以放到这个位置，就将这行中两列置为1，一列表示的是这是哪个球，另一列表示的是这是哪个位置，这样建好矩阵之后就转化成了选取某些行使得每列有且仅有一个1的模型，用Dancing Links搞之即可。</span></p>
<pre class="brush:cpp ">#include&lt;stdio.h&gt;
#include&lt;string.h&gt;
#include&lt;algorithm&gt;
#define MAXM 1010
#define MAXN 250010
#define MAXD 501010
#define INF 0x3f3f3f3f
int N, M, K, P, a[510], b[510], g[510][510];
int size, U[MAXD], D[MAXD], L[MAXD], R[MAXD], C[MAXD];
int S[MAXM], H[MAXN], ANS;
void read(int X, int *a, int c)
{
    int i, j, x, y, n;
    memset(a, 0, sizeof(int) * (N + 1));
    for(i = 0; i &lt; X; i ++)
    {
        scanf("%d%d", &amp;x, &amp;y);
        if(x &gt; y) std::swap(x, y);
        if(c) y += 2;
        for(j = x; j &lt;= y; j ++) a[j] = 1;
    }
}
void prep(int n, int m)
{
    int i;
    for(i = 0; i &lt;= m; i ++)
    {
        R[i] = i + 1, L[i + 1] = i;
        U[i] = D[i] = i, S[i] = 0;
    }
    R[m] = 0, size = m;
    for(i = 0; i &lt;= n; i ++) H[i] = -1;
}
void insert(int r, int c)
{
    ++ size;
    C[size] = c, ++ S[c];
    D[size] = D[c], U[size] = c, U[D[c]] = size, D[c] = size;
    if(H[r] == -1) L[size] = R[size] = size, H[r] = size;
    else L[size] = H[r], R[size] = R[H[r]], L[R[H[r]]] = size, R[H[r]] = size;
}
void init()
{
    int i, j, k;
    scanf("%d%d", &amp;N, &amp;M);
    memset(g, 0, sizeof(g));
    for(i = 0; i &lt; M; i ++)
    {
        scanf("%d", &amp;K), read(K, a, 0);
        scanf("%d", &amp;P), read(P, b, 1);
        for(j = 1; j &lt;= N; j ++)
            if(a[j])
                for(k = 1; k &lt;= N; k ++)
                    if(b[k]) g[j][k] = 1;
    }
    prep(N * N, N + N);
    for(i = 1; i &lt;= N; i ++)
        for(j = 1; j &lt;= N; j ++)
            if(g[i][j]) insert((i - 1) * N + j, i), insert((i - 1) * N + j, N + j);
}
void remove(int c)
{
    int i, j;
    R[L[c]] = R[c], L[R[c]] = L[c];
    for(i = D[c]; i != c; i = D[i])
        for(j = R[i]; j != i; j = R[j])
            U[D[j]] = U[j], D[U[j]] = D[j], -- S[C[j]];
}
void resume(int c)
{
    int i, j;
    for(i = U[c]; i != c; i = U[i])
        for(j = L[i]; j != i; j = L[j])
            U[D[j]] = j, D[U[j]] = j, ++ S[C[j]];
    R[L[c]] = c, L[R[c]] = c;
}
void dance()
{
    if(R[0] == 0)
    {
        ++ ANS;
        return ;
    }
    int i, j, t = INF, id;
    for(i = R[0]; i != 0; i = R[i])
        if(S[i] &lt; t) t = S[i], id = i;
    remove(id);
    for(i = D[id]; i != id; i = D[i])
    {
        for(j = R[i]; j != i; j = R[j]) remove(C[j]);
        dance();
        if(ANS &gt; 65535) return ;
        for(j = L[i]; j != i; j = L[j]) resume(C[j]);
    }
    resume(id);
}
void solve()
{
    ANS = 0;
    dance();
    if(ANS &gt; 65535) printf("OVERFLOW!\n");
    else printf("%d\n", ANS);
}
int main()
{
    int t;
    scanf("%d", &amp;t);
    while(t --)
    {
        init();
        solve();
    }
    return 0;
}</pre>
<p> </p>
<p> </p>
<p>解题参考：http://www.cnblogs.com/staginner/archive/2012/09/19/2693186.html</p>
<div>
</script>
<!-- acm-hf-01 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-9460629317209118" data-ad-slot="5011774182" style="display:inline-block;width:728px;height:90px"></ins>

(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<div class="bdsharebuttonbox"><a class="bds_more" data-cmd="more" href="#"></a><a class="bds_qzone" data-cmd="qzone" href="#" title="分享到QQ空间"></a><a class="bds_tsina" data-cmd="tsina" href="#" title="分享到新浪微博"></a><a class="bds_tqq" data-cmd="tqq" href="#" title="分享到腾讯微博"></a><a class="bds_renren" data-cmd="renren" href="#" title="分享到人人网"></a><a class="bds_weixin" data-cmd="weixin" href="#" title="分享到微信"></a></div>

</div><ol id="commentlist">
<li class="comment even thread-even depth-1" id="li-comment-81556">
<article class="comment" id="comment-81556">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919522999" rel="external nofollow">新用户939362</a></span> on <a href="http://www.acmerblog.com/hdu-2878-great-world-of-goo-4521.html#comment-81556" rel="nofollow"><time datetime="2017-04-12T18:13:50+00:00" pubdate="">2017年4月12日 at 下午6:13</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>我还以为是杰宝的意思……</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-46827">
<article class="comment" id="comment-46827">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">bai</a></span> on <a href="http://www.acmerblog.com/hdu-2878-great-world-of-goo-4521.html#comment-46827" rel="nofollow"><time datetime="2015-07-12T06:52:19+00:00" pubdate="">2015年7月12日 at 上午6:52</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>第一个真的要比较两次吗，换成else if 不可以吗</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-46822">
<article class="comment" id="comment-46822">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">645198</a></span> on <a href="http://www.acmerblog.com/hdu-2878-great-world-of-goo-4521.html#comment-46822" rel="nofollow"><time datetime="2014-11-19T05:31:17+00:00" pubdate="">2014年11月19日 at 上午5:31</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>Java真是解决大数的利器</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-46825">
<article class="comment" id="comment-46825">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">Bob</a></span> on <a href="http://www.acmerblog.com/hdu-2878-great-world-of-goo-4521.html#comment-46825" rel="nofollow"><time datetime="2014-11-01T14:43:00+00:00" pubdate="">2014年11月1日 at 下午2:43</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>大哥，你复制也看看是不是这题的答案才复制吧。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-46828">
<article class="comment" id="comment-46828">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">yunyang088</a></span> on <a href="http://www.acmerblog.com/hdu-2878-great-world-of-goo-4521.html#comment-46828" rel="nofollow"><time datetime="2014-09-11T21:28:09+00:00" pubdate="">2014年9月11日 at 下午9:28</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>算法是程序的灵魂，算法分简单和复杂，如果不搞大数据类，程序员了解一下简单点的算法也是可以的，但是会算法的一定要会编程才行，程序员不一定要会算法，利于自己项目需要的可以简单了解。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-46824">
<article class="comment" id="comment-46824">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">CCCat</a></span> on <a href="http://www.acmerblog.com/hdu-2878-great-world-of-goo-4521.html#comment-46824" rel="nofollow"><time datetime="2014-09-09T06:23:57+00:00" pubdate="">2014年9月9日 at 上午6:23</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>0000</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-46826">
<article class="comment" id="comment-46826">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">sgx_go</a></span> on <a href="http://www.acmerblog.com/hdu-2878-great-world-of-goo-4521.html#comment-46826" rel="nofollow"><time datetime="2014-09-02T07:16:23+00:00" pubdate="">2014年9月2日 at 上午7:16</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>真心不错，力顶作者</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-46823">
<article class="comment" id="comment-46823">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">753951</a></span> on <a href="http://www.acmerblog.com/hdu-2878-great-world-of-goo-4521.html#comment-46823" rel="nofollow"><time datetime="2014-07-11T17:19:27+00:00" pubdate="">2014年7月11日 at 下午5:19</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>具体实现上有所差别，但思路是一样的</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-46829">
<article class="comment" id="comment-46829">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">zoe_music</a></span> on <a href="http://www.acmerblog.com/hdu-2878-great-world-of-goo-4521.html#comment-46829" rel="nofollow"><time datetime="2014-06-27T02:49:21+00:00" pubdate="">2014年6月27日 at 上午2:49</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>正解，已改正。应该都是protected</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-25398">
<article class="comment" id="comment-25398">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">biantiao</a></span> on <a href="http://www.acmerblog.com/hdu-2878-great-world-of-goo-4521.html#comment-25398" rel="nofollow"><time datetime="2014-05-27T08:12:20+00:00" pubdate="">2014年5月27日 at 上午8:12</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>这一题的代码这样提交时错误的~少考虑了很多情况</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-25399">
<article class="comment" id="comment-25399">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">xuelanghu</a></span> on <a href="http://www.acmerblog.com/hdu-2878-great-world-of-goo-4521.html#comment-25399" rel="nofollow"><time datetime="2014-03-18T04:45:45+00:00" pubdate="">2014年3月18日 at 上午4:45</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>多谢支持！</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
</ol>