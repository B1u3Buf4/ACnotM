<div class="c-top2" id="post-55">
<div class="datetime">2015<br/>07-16</div>
<div class="tit"><h1 class="entry-title">HDU 4413-Logical Expression-图-[解题报告]HOJ</h1>
<div class="entry-meta iititle2">
<span class="i2"><a href="http://www.acmerblog.com/author/spiderman" rel="author" title="由蜘蛛侠发布">蜘蛛侠</a></span><span class="i1"><a href="http://www.acmerblog.com/category/search/dfs" rel="category tag" title="查看DFS搜索中的全部文章">DFS搜索</a>, <a href="http://www.acmerblog.com/category/problemset/hdu" rel="category tag" title="查看HDU-杭电中的全部文章">HDU-杭电</a>, <a href="http://www.acmerblog.com/category/basis/sort" rel="category tag" title="查看排序中的全部文章">排序</a></span><span class="i4">围观108次</span><span class="i3"><a class="ds-thread-count" data-thread-key="7426" href="http://www.acmerblog.com/hdu-4413-logical-expression-7426.html#comments" title="《HDU 4413-Logical Expression-图-[解题报告]HOJ》上的评论">6 条评论</a></span>
</div>
</div>
<div class="cls"></div>
</div><div class="entry-content">
<div>
<h1 class="mytitle mybigtile">Logical Expression</h1>
</div>
<div>
<p class="mytitle"> 问题描述 :</p>
</div>
<div class="mypanel">
Happy birthday to you!
<p>Your professor gives you a strange device as your birthday gift. But your experience tells you, it is a trap.</p>
<p>Just as expected, he smirks, and then says slowly: "This device is my new invention. Only you, my most brilliant student, deserve to have it."</p>
<p>"Thanks, I will keep it up." You reply.</p>
<p>"However," silent for a while, he starts again: "unfortunately, I have lost its original circuit diagram. So I need you to do some researches on it and use a simple logical expression to describe its characteristics. You won’t let me down, will you?"</p>
<p>He laughs, pats you on the back, then turns and stalks off, leaves you, the poor guy, with the "gift" on your hands.</p>
<p>You collect yourself, and start looking at the "lovely" thing. It is a black box, with n inputs labeled from the first capital letter (A) to the n-th capital letter, as well as one unique output. All the inputs and the output are one-bit binary numbers (either 0 or 1).</p>
<p>Then you sit down, put the device on the desk, take out the tools, examine all possible combinations of input values and record the output on the paper.</p>
<p>After everything gets ready, now it is just a piece of cake for you to give a correct logical expression for it.</p>
<p>A correct logical expression should be:<br/>1. A <b>not null</b> string only contains ‘+’, ‘-’ and capital letters from the first (A) to the n-th;<br/>2. A single capital letter in range is a legal logical expression, and its output equals to the value of the input labeled by this letter;<br/>3. If E is a legal logical expression, then NOT operation -E is a legal logical expression;<br/>4. If E and F are legal logical expressions, then AND operation EF is a legal logical expression;<br/>5. If E and F are legal logical expressions, then OR operation E+F is a legal logical expression;<br/>6. In a legal logical expression, you should first do NOT operations from the left to the right, then AND operations from the left to the right, and finally the OR operations from the left to the right;<br/>7. A logical expression is correct if and only if with any possible combinations of input values, its output is the same as which the device outputs.</p>
<p>But as a down-to-earth idealist, you are never satisfied with this. You want to give the most beautiful logical expression like this:<br/>1. It is a correct logical expression;<br/>2. It is the shortest one (<b>not null</b>) among all correct logical expressions;<br/>3. If there are still many available logical expressions, choose the lexicographically least one. </p></div>
<div>
<p class="mytitle"> 输入:</p>
</div>
<div class="mypanel">
There are several test cases in the input.
<p>Each test case begins with one integer n (1 &lt;= n &lt;= 5), indicating the number of inputs of the device.<br/>Then 2<sup>n</sup> lines follow. Each line contains (n + 1) one-bit binary numbers, separated by spaces. The first n numbers indicate the value of the n inputs in order, and the last one is the corresponding output.<br/>The 2<sup>n</sup> sets of inputs are different with each other.<br/>The input ends with n = 0. </p></div>
<div>
<p class="mytitle"> 输出:</p>
</div>
<div class="mypanel">
There are several test cases in the input.
<p>Each test case begins with one integer n (1 &lt;= n &lt;= 5), indicating the number of inputs of the device.<br/>Then 2<sup>n</sup> lines follow. Each line contains (n + 1) one-bit binary numbers, separated by spaces. The first n numbers indicate the value of the n inputs in order, and the last one is the corresponding output.<br/>The 2<sup>n</sup> sets of inputs are different with each other.<br/>The input ends with n = 0.</p></div>
<div>
<p class="mytitle"> 样例输入:</p>
</div>
<pre class="mypanel iopanel">
3
0 0 0 0
0 0 1 1
0 1 0 1
0 1 1 0
1 0 0 0
1 0 1 1
1 1 0 0
1 1 1 1
0</pre>
<div>
<p class="mytitle"> 样例输出:</p>
</div>
<pre class="mypanel iopanel">
-A-CB+-BC+AC
<div style="font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px"><div style="font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed"><i>Hint</i></div>
In ASCII table, '+' &lt; '-' &lt; 'A' &lt; 'B' &lt; 'C' &lt; 'D' &lt; 'E'.
</div><i style="font-size:1px"> </i></pre>
<p> <!-- problem end --></p>
<h2>Abstract</h2>
<p>HDU 4413 Logical Expression</p>
<p>乱搞 卡诺图</p>
<p> </p>
<h2>Body</h2>
<h3>Source</h3>
<p><a>http://acm.hdu.edu.cn/showproblem.php?pid=4413</a><a><br/></a></p>
<h3>Description</h3>
<p>给定N变量的所有2^N最小项，求一个符合所有最小项的最优美（长度最短的情况下字典序最小）的与或式。</p>
<h3>Solution</h3>
<p>天王还是太自信了……唉……</p>
<p>思路其实很简单。</p>
<p>复习一下卡诺图吧，考虑在卡诺图上圈一些圈，这些圈（可以重叠）覆盖且仅覆盖了所有为1的最小项，表达式就是这些圈项的或。</p>
<p>考虑卡诺图上的某个1，则所有覆盖这个1的非极大圈都不可能是最终答案的项，反证如下：假设某个覆盖这个1的非极大圈是最终答案的项，由于圈非极大，那么它一定属于某个极大圈，显然极大圈化简出的项长度比非极大圈要小。</p>
<p>于是所有可能的属于最终答案的项就是卡诺图上的所有极大圈。天王的错误就在于他只求出覆盖了每个1的最大（在所有极大圈中最优美）圈，这就相当于贪心，肯定是不对的（有可能某个非最大拼上其它的会更优）。这个地方不是很容易想明白，我也是试了一些数据才知道。</p>
<p>所以我们就对每个1求覆盖它的所有极大圈，得到一个极大圈集合（注意unique一下）。注意每个极大圈的表达式长度一定，所以先对每个极大圈求最优表达式（sort每个与项，比较函数是str1+str2&lt;str2+str1）。然后就是用这些极大圈求最优覆盖，这个好像没什么好方法，只能搜。对极大圈集合排序一下可以加快搜索速度。</p>
<h3>Code</h3>
<p>代码是在天王那个wa的代码基础上改的，所以挺难看的……</p>
<pre class="brush:cpp">#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;cstring&gt;
#include&lt;vector&gt;
#include&lt;algorithm&gt;
#include&lt;string&gt;
using namespace std;

typedef pair&lt;string, int&gt; node;
vector&lt;node&gt; ans;
bool vis[50];
int V[50];

bool cmp(string s1,string s2){
    return s1+s2&lt;s2+s1;
}
bool cmp2(string s1,string s2){
    return s1+"+"+s2&lt;s2+"+"+s1;
}
bool hmr(node a, node b) {
    if (a.second==b.second) {
        if (a.first.length()==b.first.length()) return a.first&lt;b.first;
        return a.first.length()&lt;b.first.length();
    }
    return a.second&lt;b.second;
}

bool operator==(node a, node b) {
    return a.first==b.first &amp;&amp; a.second==b.second;
}

string StInS(int s,int n,int ors){
    int i;
    vector&lt;string&gt; tmpAns;
    for (i=0;i&lt;(1&lt;&lt;n);i++){
        if ((i&amp;s)==(ors&amp;s))
            if (V[i]==0) return "";
    }
    if (s==0) return "1";
    string tmp;
    for (i=0;i&lt;n;i++) if (s&amp;(1&lt;&lt;i)){
        tmp="";
        if (!(ors&amp;(1&lt;&lt;i)))
            tmp+='-';
        tmp+=(char)(i+'A');
        tmpAns.push_back(tmp);
    }
    sort(tmpAns.begin(),tmpAns.end(),cmp);
    tmp="";
    for (i=0;i&lt;tmpAns.size();i++)
        tmp+=tmpAns[i];
    return tmp;
}

void getans(int s, int n) {
    int i,j;
    int minsize = 0x3fff;
    vector&lt;node&gt; tmp;
    for (i=0;i&lt;(1&lt;&lt;n);i++) {
        int ctrl=__builtin_popcount(i);
        if (ctrl&gt;minsize) continue;
        string tans2=StInS(i,n,s);
        if (tans2.empty()) continue;
        if (ctrl&lt;minsize) {
            minsize = ctrl;
            tmp.clear();
        }
        int res = 0;
        for (j = 0; j &lt; 1&lt;&lt;n; ++j)
            if ((j&amp;i)==(s&amp;i)) res |= 1&lt;&lt;j;
        tmp.push_back(make_pair(tans2, res));
    }
    for (i = 0; i &lt; tmp.size(); ++i)
        ans.push_back(tmp[i]);
}

int N, M;
int all;
int best;
bool use[64], ause[64];

void dfs(int i, int len, int cover) {
    if (len &gt;= best) return;
    if (cover==all) {
        memcpy(ause, use, sizeof(use));
        best = len;
        return;
    }
    if (i==M) return;
    use[i] = 1;
    dfs(i+1, len+ans[i].first.length()+1, cover|ans[i].second);
    use[i] = 0;
    dfs(i+1, len, cover);
}

int main(){
    int i,s,j,v;
    int cas=0;
    for (;;){
        scanf("%d",&amp;N);
        if (N==0) break;
        for (i=0;i&lt;(1&lt;&lt;N);i++){
            s=0;
            vis[i] = 0;
            for (j=0;j&lt;N;j++){
                scanf("%d",&amp;v);
                s^=(v&lt;&lt;j);
            }
            scanf("%d",&amp;V[s]);
        }
        ans.clear();
        memset(vis, 0, sizeof vis);
        all = 0;
        for (s = 0; s &lt; 1&lt;&lt;N; ++s)
            if (V[s]){
                all |= 1&lt;&lt;s;
                getans(s, N);
            }
        if (ans.size()==0) {
            puts("-AA");
            continue;
        }
        if (ans[0].first[0]=='1') {
            puts("-A+A");
            continue;
        }
        sort(ans.begin(), ans.end(), hmr);
        M = unique(ans.begin(), ans.end())-ans.begin();
        sort(ans.begin(), ans.begin()+M);
        best = 0x3fffffff;
        memset(use, 0, sizeof use);
        memset(ause, 0, sizeof ause);
        dfs(0, 0, 0);
        vector&lt;string&gt; astr;
        for (i = 0; i &lt; M; ++i)
            if (ause[i]) astr.push_back(ans[i].first);
        sort(astr.begin(), astr.end(), cmp2);
        string fin = astr[0];
        for (i = 1; i &lt; astr.size(); ++i)
            fin += "+"+astr[i];
        cout &lt;&lt; fin &lt;&lt; '\n';
    }
    return 0;
}</pre>
<p>参考：http://www.cnblogs.com/jffifa/archive/2012/09/23/2699253.html</p>
<div>
</script>
<!-- acm-hf-01 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-9460629317209118" data-ad-slot="5011774182" style="display:inline-block;width:728px;height:90px"></ins>

(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<div class="bdsharebuttonbox"><a class="bds_more" data-cmd="more" href="#"></a><a class="bds_qzone" data-cmd="qzone" href="#" title="分享到QQ空间"></a><a class="bds_tsina" data-cmd="tsina" href="#" title="分享到新浪微博"></a><a class="bds_tqq" data-cmd="tqq" href="#" title="分享到腾讯微博"></a><a class="bds_renren" data-cmd="renren" href="#" title="分享到人人网"></a><a class="bds_weixin" data-cmd="weixin" href="#" title="分享到微信"></a></div>

</div><ol id="commentlist">
<li class="comment even thread-even depth-1" id="li-comment-98104">
<article class="comment" id="comment-98104">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919519469" rel="external nofollow">新用户643546</a></span> on <a href="http://www.acmerblog.com/hdu-4413-logical-expression-7426.html#comment-98104" rel="nofollow"><time datetime="2017-04-20T11:47:09+00:00" pubdate="">2017年4月20日 at 上午11:47</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>滇池盒是不是***了？</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-98103">
<article class="comment" id="comment-98103">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919519469" rel="external nofollow">新用户643546</a></span> on <a href="http://www.acmerblog.com/hdu-4413-logical-expression-7426.html#comment-98103" rel="nofollow"><time datetime="2017-04-20T11:47:09+00:00" pubdate="">2017年4月20日 at 上午11:47</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>滇池盒是不是***了？</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-98102">
<article class="comment" id="comment-98102">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919519469" rel="external nofollow">新用户643546</a></span> on <a href="http://www.acmerblog.com/hdu-4413-logical-expression-7426.html#comment-98102" rel="nofollow"><time datetime="2017-04-20T11:47:09+00:00" pubdate="">2017年4月20日 at 上午11:47</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>滇池盒是不是***了？</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-98101">
<article class="comment" id="comment-98101">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919519469" rel="external nofollow">新用户643546</a></span> on <a href="http://www.acmerblog.com/hdu-4413-logical-expression-7426.html#comment-98101" rel="nofollow"><time datetime="2017-04-20T11:47:09+00:00" pubdate="">2017年4月20日 at 上午11:47</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>滇池盒是不是***了？</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-98100">
<article class="comment" id="comment-98100">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919519469" rel="external nofollow">新用户643546</a></span> on <a href="http://www.acmerblog.com/hdu-4413-logical-expression-7426.html#comment-98100" rel="nofollow"><time datetime="2017-04-20T11:47:09+00:00" pubdate="">2017年4月20日 at 上午11:47</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>滇池盒是不是***了？</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-68022">
<article class="comment" id="comment-68022">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919512383" rel="external nofollow">新用户404420</a></span> on <a href="http://www.acmerblog.com/hdu-4413-logical-expression-7426.html#comment-68022" rel="nofollow"><time datetime="2017-04-11T03:57:02+00:00" pubdate="">2017年4月11日 at 上午3:57</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>志乃你好牛B</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
</ol>