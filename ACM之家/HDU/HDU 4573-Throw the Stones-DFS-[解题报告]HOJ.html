<div class="c-top2" id="post-55">
<div class="datetime">2015<br/>09-16</div>
<div class="tit"><h1 class="entry-title">HDU 4573-Throw the Stones-DFS-[解题报告]HOJ</h1>
<div class="entry-meta iititle2">
<span class="i2"><a href="http://www.acmerblog.com/author/spiderman" rel="author" title="由蜘蛛侠发布">蜘蛛侠</a></span><span class="i1"><a href="http://www.acmerblog.com/category/problemset/hdu" rel="category tag" title="查看HDU-杭电中的全部文章">HDU-杭电</a>, <a href="http://www.acmerblog.com/category/basis/enumeration" rel="category tag" title="查看枚举中的全部文章">枚举</a>, <a href="http://www.acmerblog.com/category/geometry/solid-geometry" rel="category tag" title="查看立体几何中的全部文章">立体几何</a></span><span class="i4">围观61次</span><span class="i3"><a class="ds-thread-count" data-thread-key="7617" href="http://www.acmerblog.com/hdu-4573-throw-the-stones-7617.html#comments" title="《HDU 4573-Throw the Stones-DFS-[解题报告]HOJ》上的评论">12 条评论</a></span>
</div>
</div>
<div class="cls"></div>
</div><div class="entry-content">
<h1>Throw the Stones</h1>
<p><span><strong><span style="font-family:Arial; font-size:12px; color:green; font-weight:bold">Time Limit: 2000/1000 MS (Java/Others)    Memory Limit: 32768/32768 K (Java/Others)<br/>
Total Submission(s): 13    Accepted Submission(s): 2<br/>
</span></strong></span></p>
<div align="left" class="panel_title">Problem Description</div>
<div class="panel_content">　　Remember our childhood? A few naked children throw stones standing on the same position, the one throws farther win the game. Aha, of course, there are some naughty boys who care more about whether they can urinate father.<br/>
　　You believe it or not, anyway, I believed. Nowadays, some of the children are smarter than we were, while others may be more naughty.<br/>
　　A week ago, I saw several children throw stones. In fact, they are more clever than we were, since the game they played, apparently, is more complex than we did. Maybe you have different points of view, however, you’d better learn about the rules of the game<br/>
 before expressing your views. A group of children take turns to throw stones standing on the same position. After some child throw a stone, the children will draw a convex polyhedron with smallest volume together to enclose all the stones thrown by them. You<br/>
 may assume that the stone is so small as to be abstracted as a point in three-dimensional space. Naively, the children regard the space enclosed by the convex polyhedron as territory under their control. After a child throw his stone, the score he obtains<br/>
 equals the incremental of the volume of their territory.   Unfortunately, the first three child’s score will always be zero. At last, the child with the highest score will win the game, and known as the "King".<br/>
　　I think you have accepted my opinion already, for the rules of their throwing stones game are really complicated. But, you also don’t need to be frustrated for it. Now, in order to show you are smarter, maybe you can write a program to help the children point<br/>
 out their "King".</div>
<div class="panel_bottom"> </div>
<p></p>
<div align="left" class="panel_title">Input</div>
<div class="panel_content">　　Input consists of a number of cases. The data of each case appears on a number of input lines, the first of which contains an integer N. The following N lines contain three number (x<sub>i</sub>, y<sub>i</sub>, z<sub>i</sub>) indicating<br/>
 coordinates of the stone thrown by the i-th child.<span> </span><br/>
Note: 1 &lt;= N &lt;= 10^4, 1 &lt;= i &lt;= N, -10^4 &lt;= x<sub>i</sub><span> </span>, y<sub>i</sub><span> </span>, z<sub>i</sub><span> </span>&lt;= 10^4.</div>
<div class="panel_bottom"> </div>
<p></p>
<div align="left" class="panel_title">Output</div>
<div class="panel_content">　　For each test case, you should output two lines. The first line is "Case #K:", K means the number of the test case. The second line is "i v", i means index of the "King" and v means the score of the "King". If there are more than<br/>
 one "King", output the one throws stone earlier than others.<br/>
　　Please round the result to 2 digits after decimal point if necessary.</div>
<div class="panel_bottom"> </div>
<p></p>
<div align="left" class="panel_title">Sample Input</div>
<div class="panel_content">
<pre style="margin:0px; font-size:14px"><div style="font-family:'Courier New',Courier,monospace">4
1 0 0
1 1 0
0 1 0
0 0 1
5
1 0 0
1 1 0
0 1 0
0 0 0
0 0 1</div></pre>
</div>
<div class="panel_bottom"> </div>
<p></p>
<div align="left" class="panel_title">Sample Output</div>
<div class="panel_content">
<pre style="margin:0px; font-size:14px"><div style="font-family:'Courier New',Courier,monospace">Case #1：
4 0.17
Case #2：
5 0.33</div></pre>
</div>
<div class="panel_bottom"> </div>
<p></p>
<div align="left" class="panel_title">Source</div>
<div class="panel_content"><a href="http://acm.hdu.edu.cn/search.php?field=problem&amp;key=2013%20ACM-ICPC%B3%A4%C9%B3%C8%FC%C7%F8%C8%AB%B9%FA%D1%FB%C7%EB%C8%FC%A1%AA%A1%AA%CC%E2%C4%BF%D6%D8%CF%D6&amp;source=1&amp;searchmode=source" style="color:rgb(26,92,200); text-decoration:none">2013<br/>
 ACM-ICPC长沙赛区全国邀请赛——题目重现</a></div>
<div class="panel_bottom"> </div>
<p></p>
<div align="left" class="panel_title">Recommend</div>
<div class="panel_content">zhoujiaqi2010</div>
<div class="panel_bottom"> </div>
<p><span style="font-size:14px">•</span>    <span style="font-size:14px">题意较简单，略去。</span></p>
<p><span style="font-size:14px">•</span>    <span style="font-size:14px">典型的三维计算几何问题。</span></p>
<p><span style="font-size:14px">•</span>   <span style="font-size:14px">题目难度为偏难。</span></p>
<p><span style="font-size:14px">•</span>    <span style="font-size:14px">最简单直接的方法是暴力计算三维凸包</span></p>
<p><span style="font-size:14px">–</span>  <span style="font-size:14px">时间复杂度为<span style="font-family:Times New Roman">O(n^2)</span>，超时。</span></p>
<p><span style="font-size:14px">•</span>    <span style="font-size:14px">解题思路：</span></p>
<p><span style="font-size:14px">–</span>  <span style="font-size:14px">记录每个面的外法向量，类似邻接表的方式存储凸包记录相邻面信息。</span></p>
<p><span style="font-size:14px">–</span>  <span style="font-size:14px">对于新添加进来的一个石子（视作点光源），剔除当前凸包中的所有可见面，并更新维护凸包。</span></p>
<p><span style="font-size:14px">–</span>  <span style="font-size:14px">在删除和维护的过程中动态的更新凸包的体积，记录最大体积增量。</span></p>
<p><span style="font-size:14px">–</span>  <span style="font-size:14px">时间复杂度为<span style="font-family:Times New Roman">O(n*sqrt(n))</span></span></p>
<p> </p>
<p> </p>
<pre class="brush:cpp" name="code">#include &lt;cstdio&gt;
#include &lt;cmath&gt;
#include &lt;algorithm&gt;
using namespace std;

#define db double
#define rt return
#define cs const
#define cp const P&amp;
#define op operator

cs db eps = 1e-9;

inline int sig(db x){rt (x&gt;eps)-(x&lt;-eps);}

cs int N = 10001;

struct P {
    db x, y, z;
    P(db a = 0, db b = 0, db c = 0):x(a),y(b),z(c){}
    void in(){scanf("%lf%lf%lf", &amp;x, &amp;y, &amp;z);}
    P op+(cp a)cs{rt P(x+a.x, y+a.y, z+a.z);}
    P op-(cp a)cs{rt P(x-a.x, y-a.y, z-a.z);}
    P op*(cs db&amp;k)cs{rt P(x*k, y*k, z*k);}
    P op^(cp a)cs{rt P(y*a.z-a.y*z, z*a.x-a.z*x, x*a.y-a.x*y);}
    db op*(cp a)cs{rt x*a.x + y*a.y + z*a.z;}
    P cross(P a, P b){rt a-*this ^ b-*this;}
    db dot(P a, P b){rt (a-*this) * (b-*this);}
    db L(){rt sqrt(x*x + y*y + z*z);}
    db V6(P b, P c){rt (b ^ c) * (*this);}
}p[N];

int n;

db diff_vol, max_diff;

struct convex {
    int cnt, blg[N][N];
    struct face {
       int a, b, c, is;
       face(int x=0,int y=0,int z=0,int w=0):a(x),b(y),c(z),is(w){}
       int visible(P me) {
           rt sig(p[a].cross(p[b],p[c]) * (me-p[a])) &gt; 0;
       }
    }fac[N*10];
    int col(int a, int b, int c){rt p[a].cross(p[b],p[c]).L() &lt; eps;}
    int cop(int a, int b, int c, int d){rt !sig(p[a].cross(p[b],p[c])*(p[d]-p[a]));}
    void deal(int k, int a, int b) {
       int f = blg[a][b];
       if(fac[f].is) {
           if(fac[f].visible(p[k])) dfs(k, f);
           else {
               diff_vol += p[b].V6(p[a], p[k]);
               face add = face(b, a, k, 1);
               blg[b][a] = blg[a][k] = blg[k][b] = cnt;
               fac[cnt++] = add;
           }
       }
    }
    void dfs(int k, int cur) {
       diff_vol -= p[fac[cur].a].V6(p[fac[cur].b], p[fac[cur].c]);
       fac[cur].is = 0;
       deal(k, fac[cur].b, fac[cur].a);
       deal(k, fac[cur].c, fac[cur].b);
       deal(k, fac[cur].a, fac[cur].c);
    }
    void init() {
        cnt = 0;
        for(int i = 0; i &lt; 4; i++) {
           face add = face((i+1)%4, (i+2)%4, (i+3)%4, 1);
           if(add.visible(p[i])) swap(add.b, add.c);
           blg[add.a][add.b] = blg[add.b][add.c] = blg[add.c][add.a] = cnt;
           fac[cnt++] = add;
        }
    }
    void update(int k) {
        for(int i = 0; i &lt; cnt; i++)
            if(fac[i].is &amp;&amp; fac[i].visible(p[k])) {
                dfs(k, i); break;
            }
    }
    db volume() {
       db v = 0.;
       for(int i = 0; i &lt; cnt; i++)
           v += fac[i].is * p[fac[i].a].V6(p[fac[i].b], p[fac[i].c]);
       rt v / 6.;
    }
}hull;

void solve(int number, int cas) {
    max_diff = 0.;
    int king = 1, tag = 1;
    p[0].in();
    for(int i = 1; i &lt; number; i++) {
        p[i].in();
        if(tag == 1) {
            tag += sig((p[0]-p[i]).L());
            if(tag &gt; 1) swap(p[1], p[i]);
            continue;
        }
        if(tag == 2) {
            tag += sig((p[0].cross(p[1], p[i])).L());
            if(tag &gt; 2) swap(p[2], p[i]);
            continue;
        }
        if(tag == 3) {
            tag += sig(p[0].cross(p[1], p[2]) * (p[i]-p[0])) != 0;
            if(tag &gt; 3) {
                swap(p[3], p[i]);
                hull.init();
                for(int j = 4; j &lt;= i; j++) hull.update(j);
                king = i + 1, max_diff = hull.volume();
            }
            continue;
        }
        diff_vol = 0.;
        hull.update(i);
        diff_vol /= 6.;
        if(sig(diff_vol - max_diff) &gt; 0) {
            max_diff = diff_vol;
            king = i + 1;
        }
    }
    printf("Case #%d:\n%d %.2lf\n", cas, king, max_diff);
}

int main() {
    //freopen("Throw_The_Stones.in", "r", stdin);
    //freopen("testThrow_The_Stones.out", "w", stdout);
    int number, cas = 1;
    while(scanf("%d", &amp;number) != -1) solve(number, cas++);
    rt 0;
}
</pre>
<p> </p>
<div style="padding-top:20px">
<p style="font-size:12px;">版权声明：本文为博主原创文章，未经博主允许不得转载。</p>
</div>
<p>参考：http://blog.csdn.net/spark_007/article/details/9017561</p>
<div>
</script>
<!-- acm-hf-01 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-9460629317209118" data-ad-slot="5011774182" style="display:inline-block;width:728px;height:90px"></ins>

(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<div class="bdsharebuttonbox"><a class="bds_more" data-cmd="more" href="#"></a><a class="bds_qzone" data-cmd="qzone" href="#" title="分享到QQ空间"></a><a class="bds_tsina" data-cmd="tsina" href="#" title="分享到新浪微博"></a><a class="bds_tqq" data-cmd="tqq" href="#" title="分享到腾讯微博"></a><a class="bds_renren" data-cmd="renren" href="#" title="分享到人人网"></a><a class="bds_weixin" data-cmd="weixin" href="#" title="分享到微信"></a></div>

</div><ol id="commentlist">
<li class="comment even thread-even depth-1" id="li-comment-97559">
<article class="comment" id="comment-97559">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919521223" rel="external nofollow">新用户616101</a></span> on <a href="http://www.acmerblog.com/hdu-4573-throw-the-stones-7617.html#comment-97559" rel="nofollow"><time datetime="2017-04-20T05:15:17+00:00" pubdate="">2017年4月20日 at 上午5:15</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"></div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-66884">
<article class="comment" id="comment-66884">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919513081" rel="external nofollow">新用户535441</a></span> on <a href="http://www.acmerblog.com/hdu-4573-throw-the-stones-7617.html#comment-66884" rel="nofollow"><time datetime="2017-04-10T22:27:50+00:00" pubdate="">2017年4月10日 at 下午10:27</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>只是免费升级，成本已经算在整机里面了</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-66883">
<article class="comment" id="comment-66883">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919513081" rel="external nofollow">新用户535441</a></span> on <a href="http://www.acmerblog.com/hdu-4573-throw-the-stones-7617.html#comment-66883" rel="nofollow"><time datetime="2017-04-10T22:27:50+00:00" pubdate="">2017年4月10日 at 下午10:27</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>只是免费升级，成本已经算在整机里面了</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-66882">
<article class="comment" id="comment-66882">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919513081" rel="external nofollow">新用户535441</a></span> on <a href="http://www.acmerblog.com/hdu-4573-throw-the-stones-7617.html#comment-66882" rel="nofollow"><time datetime="2017-04-10T22:27:50+00:00" pubdate="">2017年4月10日 at 下午10:27</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>只是免费升级，成本已经算在整机里面了</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-66881">
<article class="comment" id="comment-66881">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919513081" rel="external nofollow">新用户535441</a></span> on <a href="http://www.acmerblog.com/hdu-4573-throw-the-stones-7617.html#comment-66881" rel="nofollow"><time datetime="2017-04-10T22:27:50+00:00" pubdate="">2017年4月10日 at 下午10:27</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>只是免费升级，成本已经算在整机里面了</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-66880">
<article class="comment" id="comment-66880">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919513081" rel="external nofollow">新用户535441</a></span> on <a href="http://www.acmerblog.com/hdu-4573-throw-the-stones-7617.html#comment-66880" rel="nofollow"><time datetime="2017-04-10T22:27:50+00:00" pubdate="">2017年4月10日 at 下午10:27</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>只是免费升级，成本已经算在整机里面了</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-66879">
<article class="comment" id="comment-66879">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919513081" rel="external nofollow">新用户535441</a></span> on <a href="http://www.acmerblog.com/hdu-4573-throw-the-stones-7617.html#comment-66879" rel="nofollow"><time datetime="2017-04-10T22:27:50+00:00" pubdate="">2017年4月10日 at 下午10:27</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>只是免费升级，成本已经算在整机里面了</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-66878">
<article class="comment" id="comment-66878">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919513081" rel="external nofollow">新用户535441</a></span> on <a href="http://www.acmerblog.com/hdu-4573-throw-the-stones-7617.html#comment-66878" rel="nofollow"><time datetime="2017-04-10T22:27:50+00:00" pubdate="">2017年4月10日 at 下午10:27</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>只是免费升级，成本已经算在整机里面了</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-66877">
<article class="comment" id="comment-66877">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919513081" rel="external nofollow">新用户535441</a></span> on <a href="http://www.acmerblog.com/hdu-4573-throw-the-stones-7617.html#comment-66877" rel="nofollow"><time datetime="2017-04-10T22:27:50+00:00" pubdate="">2017年4月10日 at 下午10:27</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>只是免费升级，成本已经算在整机里面了</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-66876">
<article class="comment" id="comment-66876">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919513081" rel="external nofollow">新用户535441</a></span> on <a href="http://www.acmerblog.com/hdu-4573-throw-the-stones-7617.html#comment-66876" rel="nofollow"><time datetime="2017-04-10T22:27:50+00:00" pubdate="">2017年4月10日 at 下午10:27</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>只是免费升级，成本已经算在整机里面了</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-66875">
<article class="comment" id="comment-66875">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919513081" rel="external nofollow">新用户535441</a></span> on <a href="http://www.acmerblog.com/hdu-4573-throw-the-stones-7617.html#comment-66875" rel="nofollow"><time datetime="2017-04-10T22:27:50+00:00" pubdate="">2017年4月10日 at 下午10:27</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>只是免费升级，成本已经算在整机里面了</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-66874">
<article class="comment" id="comment-66874">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919513081" rel="external nofollow">新用户535441</a></span> on <a href="http://www.acmerblog.com/hdu-4573-throw-the-stones-7617.html#comment-66874" rel="nofollow"><time datetime="2017-04-10T22:27:50+00:00" pubdate="">2017年4月10日 at 下午10:27</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>只是免费升级，成本已经算在整机里面了</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
</ol>