<div class="c-top2" id="post-55">
<div class="datetime">2014<br/>03-16</div>
<div class="tit"><h1 class="entry-title">HDU 3338-Kakuro Extension-DFS-[解题报告]HOJ</h1>
<div class="entry-meta iititle2">
<span class="i2"><a href="http://www.acmerblog.com/author/spiderman" rel="author" title="由蜘蛛侠发布">蜘蛛侠</a></span><span class="i1"><a href="http://www.acmerblog.com/category/search/bfs" rel="category tag" title="查看BFS搜索中的全部文章">BFS搜索</a>, <a href="http://www.acmerblog.com/category/search/dfs" rel="category tag" title="查看DFS搜索中的全部文章">DFS搜索</a>, <a href="http://www.acmerblog.com/category/problemset/hdu" rel="category tag" title="查看HDU-杭电中的全部文章">HDU-杭电</a></span><span class="i4">围观867次</span><span class="i3"><a class="ds-thread-count" data-thread-key="5270" href="http://www.acmerblog.com/hdu-3338-kakuro-extension-5270.html#comments" title="《HDU 3338-Kakuro Extension-DFS-[解题报告]HOJ》上的评论">14 条评论</a></span>
</div>
</div>
<div class="cls"></div>
</div><div class="entry-content">
<div>
<h1 class="mytitle mybigtile">Kakuro Extension</h1>
</div>
<div>
<p class="mytitle"> 问题描述 :</p>
</div>
<div class="mypanel">
<font color="red">If you solved problem like <a href="http://acm.sgu.ru/problem.php?contest=0&amp;problem=454">this</a>, forget it.Because you need to use a completely different algorithm to solve the following one.</font><br/>Kakuro puzzle is played on a  grid of "black" and "white" cells. Apart from the top row and leftmost column which are entirely black, the grid has some amount of white cells which form "runs" and some amount of black cells. "Run" is a vertical or horizontal maximal one-lined block of adjacent white cells. Each row and column of the puzzle can contain more than one "run". Every white cell belongs to exactly two runs ― one horizontal and one vertical run. Each horizontal "run" always has a number in the black half-cell to its immediate left, and each vertical "run" always has a number in the black half-cell immediately above it. These numbers are located in "black" cells and are called "clues".The rules of the puzzle are simple: 
<p>1.place a single digit from 1 to 9 in each "white" cell<br/>2.for all runs, the sum of all digits in a "run" must match the clue associated with the "run"</p>
<p>Given the grid, your task is to find a solution for the puzzle.<br/>　　　　　　　　<img alt="Guess the number" src="/img/1395299022156.png"/> 　　　　　<img alt="Guess the number" src="/img/1395299022311.png"/><br/>　　　　　　　　Picture of the first sample input　　　　　　　　　　　　Picture of the first sample output </p></div>
<div>
<p class="mytitle"> 输入:</p>
</div>
<div class="mypanel">
The first line of input contains two integers n and m (2 ≤ n,m ≤ 100) ― the number of rows and columns correspondingly. Each of the next n lines contains descriptions of m cells. Each cell description is one of the following 7-character strings: 
<p>…….― "white" cell;<br/>XXXXXXX― "black" cell with no clues;<br/>AAA\BBB― "black" cell with one or two clues. AAA is either a 3-digit clue for the corresponding vertical run, or XXX if there is no associated vertical run. BBB is either a 3-digit clue for the corresponding horizontal run, or XXX if there is no associated horizontal run.<br/>The first row and the first column of the grid will never have any white cells. The given grid will have at least one "white" cell.It is guaranteed that the given puzzle has at least one solution. </p></div>
<div>
<p class="mytitle"> 输出:</p>
</div>
<div class="mypanel">
The first line of input contains two integers n and m (2 ≤ n,m ≤ 100) ― the number of rows and columns correspondingly. Each of the next n lines contains descriptions of m cells. Each cell description is one of the following 7-character strings: 
<p>…….― "white" cell;<br/>XXXXXXX― "black" cell with no clues;<br/>AAA\BBB― "black" cell with one or two clues. AAA is either a 3-digit clue for the corresponding vertical run, or XXX if there is no associated vertical run. BBB is either a 3-digit clue for the corresponding horizontal run, or XXX if there is no associated horizontal run.<br/>The first row and the first column of the grid will never have any white cells. The given grid will have at least one "white" cell.It is guaranteed that the given puzzle has at least one solution.</p></div>
<div>
<p class="mytitle"> 样例输入:</p>
</div>
<pre class="mypanel iopanel">
6 6
XXXXXXX XXXXXXX 028\XXX 017\XXX 028\XXX XXXXXXX
XXXXXXX 022\022 ....... ....... ....... 010\XXX
XXX\034 ....... ....... ....... ....... .......
XXX\014 ....... ....... 016\013 ....... .......
XXX\022 ....... ....... ....... ....... XXXXXXX
XXXXXXX XXX\016 ....... ....... XXXXXXX XXXXXXX
5 8
XXXXXXX 001\XXX 020\XXX 027\XXX 021\XXX 028\XXX 014\XXX 024\XXX
XXX\035 ....... ....... ....... ....... ....... ....... .......
XXXXXXX 007\034 ....... ....... ....... ....... ....... .......
XXX\043 ....... ....... ....... ....... ....... ....... .......
XXX\030 ....... ....... ....... ....... ....... ....... XXXXXXX</pre>
<div>
<p class="mytitle"> 样例输出:</p>
</div>
<pre class="mypanel iopanel">
_ _ _ _ _ _
_ _ 5 8 9 _
_ 7 6 9 8 4
_ 6 8 _ 7 6
_ 9 2 7 4 _
_ _ 7 9 _ _
_ _ _ _ _ _ _ _
_ 1 9 9 1 1 8 6
_ _ 1 7 7 9 1 9
_ 1 3 9 9 9 3 9
_ 6 7 2 4 9 2 _</pre>
<p> <!-- problem end --></p>
<p>题意：看图就知道大概是个什么意思了，就是每行连续的数之和等于一个规定的数，每列连续的数之和等于一个规定的数。</p>
<p><img alt="Kakuro Extension" src="/img/1395299039653.png"/>           <img alt="Kakuro Extension" src="/img/1395299039794.png"/></p>
<p>神题啊。。这都可以是网络流。。貌似也只能是网络流了。。直接搜的题解。。觉得建图也不是那么神奇  但是就是觉得真的不可思议。。</p>
<p>首先，流量有下界，是1，那么干脆所有的边的流量都把这个1的部分减掉。</p>
<p>直接贴这个博客上说的：<a>http://www.cnblogs.com/ylfdrib/archive/2010/08/15/1799903.html</a></p>
<p>建图：</p>
<p>一共有四类点：</p>
<p>1. 构造源点S，汇点T</p>
<p>2. 有行和的格子，此类节点设为A</p>
<p>3. 空白格，设为B</p>
<p>4. 有列和的格子，设为C</p>
<p>则可以建边：</p>
<p>1. &lt;S, A&gt; 容量和行和</p>
<p>2. &lt;A, B&gt; 容量为8</p>
<p>3. &lt;B, C&gt; 容量为8</p>
<p>4. &lt;C, T&gt; 容量为列和</p>
<p>最后怎么去填格子里的数字呢？</p>
<p>每个格子里的数字等于1+从行和中流向这个格子的流量和</p>
<p><img alt="Kakuro Extension" id="code_img_closed_2799379b-fbef-4130-87c3-fd4ad94b04f9" src="/img/1395299039991.gif"/><img alt="Kakuro Extension" id="code_img_opened_2799379b-fbef-4130-87c3-fd4ad94b04f9" onclick="cnblogs_code_hide('2799379b-fbef-4130-87c3-fd4ad94b04f9',event)" src="/img/1395299040138.gif" style="display: none;"/></p>
<pre class="brush:cpp ">#include &lt;iostream&gt;
 #include &lt;cstdio&gt;
 #include &lt;cstring&gt;
 #include &lt;algorithm&gt;
 #define INF 0x7fffffff
 #define maxn 20010
 #define maxm 500000
 using namespace std;
 int v[maxm],next[maxm],w[maxm];
 int first[maxn],d[maxn],work[maxn],q[maxn];
 int e,S,T;
 int map[105][105];
 struct Row{
     int x,y,z;
 }row[maxn];
 struct Col{
     int x,y,z;
 }col[maxn];
 
 void init(){
     e = 0;
     memset(first,-1,sizeof(first));
 }
 
 void add_edge(int a,int b,int c){
     //printf("add:%d to %d,cap = %d\n",a,b,c);
     v[e] = b;w[e] = c;next[e] = first[a];first[a] = e++;
     v[e] = a;w[e] = 0;next[e] = first[b];first[b] = e++;
 }
 
 int bfs(){
     int rear = 0;
     memset(d,-1,sizeof(d));
     d[S] = 0;q[rear++] = S;
     for(int i = 0;i &lt; rear;i++){
         for(int j = first[q[i]];j != -1;j = next[j])
             if(w[j] &amp;&amp; d[v[j]] == -1){
                 d[v[j]] = d[q[i]] + 1;
                 q[rear++] = v[j];
                 if(v[j] == T)   return 1;
             }
     }
     return 0;
 }
 
 int dfs(int cur,int a){
     if(cur == T)    return a;
     for(int &amp;i = work[cur];i != -1;i = next[i]){
         if(w[i] &amp;&amp; d[v[i]] == d[cur] + 1)
             if(int t = dfs(v[i],min(a,w[i]))){
                 w[i] -= t;w[i^1] += t;
                 return t;
             }
     }
     return 0;
 }
 
 int dinic(){
     int ans = 0;
     while(bfs()){
         memcpy(work,first,sizeof(first));
         while(int t = dfs(S,INF))   ans += t;
     }
     return ans;
 }
 
 int cal(int id,int row_cnt){
     int cnt = 0,pos = id+row_cnt;
     for(int i = first[pos];i != -1;i = next[i])
         if(v[i] &lt;= row_cnt) cnt += w[i];
     return cnt+1;
 }
 
 int main()
 {
     int n,m;
     char str[10];
     while(scanf("%d%d",&amp;n,&amp;m) == 2){
         init();
         int row_cnt,col_cnt,id;
         row_cnt = col_cnt = id = 0;
         for(int i = 1;i &lt;= n;i++){
             for(int j = 1;j &lt;= m;j++){
                 scanf("%s",str);
                 if(str[0] == '.'){
                     map[i][j] = ++id;
                 }else{
                     map[i][j] = -1;
                     if(str[0] != 'X'){
                         int tmp = (str[0]-'0')*100 + (str[1]-'0')*10 + str[2]-'0';
                         col[++col_cnt].x = i;
                         col[col_cnt].y = j;
                         col[col_cnt].z = tmp;
                     }
                     if(str[4] != 'X'){
                         int tmp = (str[4]-'0')*100 + (str[5]-'0')*10 + str[6]-'0';
                         row[++row_cnt].x = i;
                         row[row_cnt].y = j;
                         row[row_cnt].z = tmp;
                     }
                 }
             }
         }
         S = 0,T = row_cnt+id+col_cnt+1;
         for(int i = 1;i &lt;= row_cnt;i++){
             int x = row[i].x;
             int y = row[i].y;
             int cnt_len = 0;
             for(y = y+1;y &lt;= m;y++){
                 if(map[x][y] != -1){
                     cnt_len++;
                     add_edge(i,row_cnt+map[x][y],8);
                 }
                 else   break;
             }
             add_edge(S,i,row[i].z-cnt_len);
         }
         for(int i = 1;i &lt;= col_cnt;i++){
             int x = col[i].x;
             int y = col[i].y;
             int cnt_len = 0;
             for(x = x+1;x &lt;= n;x++){
                 if(map[x][y] != -1){
                     cnt_len++;
                     add_edge(row_cnt+map[x][y],row_cnt+id+i,8);
                 }
                 else    break;
             }
             add_edge(row_cnt+id+i,T,col[i].z-cnt_len);
         }
         dinic();
         for(int i = 1;i &lt;= n;i++){
             for(int j = 1;j &lt;= m;j++){
                 if(map[i][j] == -1) printf("_ ");
                 else    printf("%d ",cal(map[i][j],row_cnt));
             }
             printf("\n");
         }
     }
     return 0;
 }</pre>
<p><span>View Code </span></p>
<p> </p>
<p>参考：http://www.cnblogs.com/zhexipinnong/archive/2013/10/24/3386959.html</p>
<div>
</script>
<!-- acm-hf-01 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-9460629317209118" data-ad-slot="5011774182" style="display:inline-block;width:728px;height:90px"></ins>

(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<div class="bdsharebuttonbox"><a class="bds_more" data-cmd="more" href="#"></a><a class="bds_qzone" data-cmd="qzone" href="#" title="分享到QQ空间"></a><a class="bds_tsina" data-cmd="tsina" href="#" title="分享到新浪微博"></a><a class="bds_tqq" data-cmd="tqq" href="#" title="分享到腾讯微博"></a><a class="bds_renren" data-cmd="renren" href="#" title="分享到人人网"></a><a class="bds_weixin" data-cmd="weixin" href="#" title="分享到微信"></a></div>

</div><ol id="commentlist">
<li class="comment even thread-even depth-1" id="li-comment-77613">
<article class="comment" id="comment-77613">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919524415" rel="external nofollow">新用户799821</a></span> on <a href="http://www.acmerblog.com/hdu-3338-kakuro-extension-5270.html#comment-77613" rel="nofollow"><time datetime="2017-04-12T09:15:02+00:00" pubdate="">2017年4月12日 at 上午9:15</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>我就想问，周围的那几个人还活着么？</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-48500">
<article class="comment" id="comment-48500">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">mysteriousAngel_love</a></span> on <a href="http://www.acmerblog.com/hdu-3338-kakuro-extension-5270.html#comment-48500" rel="nofollow"><time datetime="2015-07-07T18:06:03+00:00" pubdate="">2015年7月7日 at 下午6:06</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>这是什么编译器啊，不通过</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-28905">
<article class="comment" id="comment-28905">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">fermi</a></span> on <a href="http://www.acmerblog.com/hdu-3338-kakuro-extension-5270.html#comment-28905" rel="nofollow"><time datetime="2015-05-06T17:18:44+00:00" pubdate="">2015年5月6日 at 下午5:18</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>沙发呢，我抢到了沙发</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-28904">
<article class="comment" id="comment-28904">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">woweizhineng</a></span> on <a href="http://www.acmerblog.com/hdu-3338-kakuro-extension-5270.html#comment-28904" rel="nofollow"><time datetime="2015-03-18T04:56:30+00:00" pubdate="">2015年3月18日 at 上午4:56</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>给力</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-48503">
<article class="comment" id="comment-48503">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">bai</a></span> on <a href="http://www.acmerblog.com/hdu-3338-kakuro-extension-5270.html#comment-48503" rel="nofollow"><time datetime="2015-03-03T05:58:54+00:00" pubdate="">2015年3月3日 at 上午5:58</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>分三种情况讨论。Not Possible就是impossible</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-28909">
<article class="comment" id="comment-28909">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">zclzcllove</a></span> on <a href="http://www.acmerblog.com/hdu-3338-kakuro-extension-5270.html#comment-28909" rel="nofollow"><time datetime="2015-01-22T10:52:12+00:00" pubdate="">2015年1月22日 at 上午10:52</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>C语言版本的代码好像有点问题</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-28906">
<article class="comment" id="comment-28906">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">fiftyonejiao</a></span> on <a href="http://www.acmerblog.com/hdu-3338-kakuro-extension-5270.html#comment-28906" rel="nofollow"><time datetime="2015-01-01T09:29:38+00:00" pubdate="">2015年1月1日 at 上午9:29</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>
	welcome!</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-48502">
<article class="comment" id="comment-48502">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">huangduanjing</a></span> on <a href="http://www.acmerblog.com/hdu-3338-kakuro-extension-5270.html#comment-48502" rel="nofollow"><time datetime="2014-12-29T07:15:34+00:00" pubdate="">2014年12月29日 at 上午7:15</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>顺利测试通过了，多谢</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-28903">
<article class="comment" id="comment-28903">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">daisyleedq</a></span> on <a href="http://www.acmerblog.com/hdu-3338-kakuro-extension-5270.html#comment-28903" rel="nofollow"><time datetime="2014-09-20T12:57:28+00:00" pubdate="">2014年9月20日 at 下午12:57</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>很高兴你会喜欢这个网站。目前还没有一个开发团队，网站是我一个人在维护，都是用的开源系统，也没有太多需要开发的部分，主要是内容整理。非常感谢你的关注。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-28911">
<article class="comment" id="comment-28911">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">HDC</a></span> on <a href="http://www.acmerblog.com/hdu-3338-kakuro-extension-5270.html#comment-28911" rel="nofollow"><time datetime="2014-08-06T14:29:01+00:00" pubdate="">2014年8月6日 at 下午2:29</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>感谢分享 学习了`(*∩_∩*)′</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-48501">
<article class="comment" id="comment-48501">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">Silence.L</a></span> on <a href="http://www.acmerblog.com/hdu-3338-kakuro-extension-5270.html#comment-48501" rel="nofollow"><time datetime="2014-07-23T02:48:46+00:00" pubdate="">2014年7月23日 at 上午2:48</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>18题的C也是错误的</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-28908">
<article class="comment" id="comment-28908">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">winter</a></span> on <a href="http://www.acmerblog.com/hdu-3338-kakuro-extension-5270.html#comment-28908" rel="nofollow"><time datetime="2014-05-09T16:19:12+00:00" pubdate="">2014年5月9日 at 下午4:19</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>有点意思</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-28907">
<article class="comment" id="comment-28907">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">jupiterhyun</a></span> on <a href="http://www.acmerblog.com/hdu-3338-kakuro-extension-5270.html#comment-28907" rel="nofollow"><time datetime="2014-04-11T03:31:05+00:00" pubdate="">2014年4月11日 at 上午3:31</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>1234百位上出现的次数应该是200吧。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-28910">
<article class="comment" id="comment-28910">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">gaoriqiang2</a></span> on <a href="http://www.acmerblog.com/hdu-3338-kakuro-extension-5270.html#comment-28910" rel="nofollow"><time datetime="2014-04-07T18:59:01+00:00" pubdate="">2014年4月7日 at 下午6:59</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>…. 配图居然是没方向的。。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
</ol>