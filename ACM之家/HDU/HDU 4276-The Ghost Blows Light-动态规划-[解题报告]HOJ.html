<div class="c-top2" id="post-55">
<div class="datetime">2015<br/>05-23</div>
<div class="tit"><h1 class="entry-title">HDU 4276-The Ghost Blows Light-动态规划-[解题报告]HOJ</h1>
<div class="entry-meta iititle2">
<span class="i2"><a href="http://www.acmerblog.com/author/spiderman" rel="author" title="由蜘蛛侠发布">蜘蛛侠</a></span><span class="i1"><a href="http://www.acmerblog.com/category/problemset/hdu" rel="category tag" title="查看HDU-杭电中的全部文章">HDU-杭电</a>, <a href="http://www.acmerblog.com/category/graph/shortest-path" rel="category tag" title="查看最短路径中的全部文章">最短路径</a>, <a href="http://www.acmerblog.com/category/dp2/line-dp" rel="category tag" title="查看线性DP中的全部文章">线性DP</a></span><span class="i4">围观151次</span><span class="i3"><a class="ds-thread-count" data-thread-key="7289" href="http://www.acmerblog.com/hdu-4276-the-ghost-blows-light-7289.html#comments" title="《HDU 4276-The Ghost Blows Light-动态规划-[解题报告]HOJ》上的评论">2 条评论</a></span>
</div>
</div>
<div class="cls"></div>
</div><div class="entry-content">
<div>
<h1 class="mytitle mybigtile">The Ghost Blows Light</h1>
</div>
<div>
<p class="mytitle"> 问题描述 :</p>
</div>
<div class="mypanel">
<br/>My name is Hu Bayi, robing an ancient tomb in Tibet. The tomb consists of N rooms (numbered from 1 to N) which are connected by some roads (pass each road should cost some time). There is exactly one route between any two rooms, and each room contains some treasures. Now I am located at the 1st room and the exit is located at the Nth room. <br/>Suddenly, alert occurred! The tomb will topple down in T minutes, and I should reach exit room in T minutes. Human beings die in pursuit of wealth, and birds die in pursuit of food! Although it is life-threatening time, I also want to get treasure out as much as possible. Now I wonder the maximum number of treasures I can take out in T minutes. </div>
<div>
<p class="mytitle"> 输入:</p>
</div>
<div class="mypanel">
There are multiple test cases.<br/>The first line contains two integer N and T. (1 &lt;= n &lt;= 100, 0 &lt;= T &lt;= 500)<br/>Each of the next N – 1 lines contains three integers a, b, and t indicating there is a road between a and b which costs t minutes. (1&lt;=a&lt;=n, 1&lt;=b&lt;=n, a!=b, 0 &lt;= t &lt;= 100)<br/>The last line contains N integers, which Ai indicating the number of treasure in the ith room. (0 &lt;= Ai &lt;= 100) </div>
<div>
<p class="mytitle"> 输出:</p>
</div>
<div class="mypanel">
There are multiple test cases.<br/>The first line contains two integer N and T. (1 &lt;= n &lt;= 100, 0 &lt;= T &lt;= 500)<br/>Each of the next N – 1 lines contains three integers a, b, and t indicating there is a road between a and b which costs t minutes. (1&lt;=a&lt;=n, 1&lt;=b&lt;=n, a!=b, 0 &lt;= t &lt;= 100)<br/>The last line contains N integers, which Ai indicating the number of treasure in the ith room. (0 &lt;= Ai &lt;= 100)</div>
<div>
<p class="mytitle"> 样例输入:</p>
</div>
<pre class="mypanel iopanel">
5 10
1 2 2 
2 3 2
2 5 3
3 4 3
1 2 3 4 5</pre>
<div>
<p class="mytitle"> 样例输出:</p>
</div>
<pre class="mypanel iopanel">
11</pre>
<p> <!-- problem end --></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px; text-align:left">
<span style="font-size:18px">转载请注明出处，谢谢<a style="color:rgb(202,0,0); text-decoration:none"></a><a style="color:rgb(202,0,0); text-decoration:none">http://blog.csdn.net/acm_cxlove/article/details/7854526</a>      <br/>
 by—cxlove </span></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px; text-align:left">
<span style="font-size:18px">题目：给出一棵树，从1走到n，总时间为T，每走一条边需要花费一定时间，每个结点有一定价值，问在指定时间内回到T的能获取的最大价值</span></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px; text-align:left">
<span style="font-size:18px"><a>http://acm.hdu.edu.cn/showproblem.php?pid=4276</a> </span></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; line-height:26px; text-align:left">
<span style="font-size:18px">比赛的时候是yobobobo出的这题。</span></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; line-height:26px; text-align:left">
<span style="font-size:18px">不知道怎么处理回到n点，果然DP不是我的菜。</span></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; line-height:26px; text-align:left">
<span style="font-size:18px">首先spfa求一次最短路，如果从1到n的最短花费都小于总时间，则是不可能。</span></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; line-height:26px; text-align:left">
<span style="font-size:18px">而且在最短路的时候记录每个节点的父节点，以及边的编号</span></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; line-height:26px; text-align:left">
<span style="font-size:18px">然后将最短路径上的所有边权置为0.将总时间减去最短路径。</span></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; line-height:26px; text-align:left">
<span style="font-size:18px">这样处理的目的是，显然最短路上的边只会走一遍才是最优的，而且剩下的边要么不走，要么走两次，而且DFS求一次树形DP之后，不需要考虑回到n的情况，因为1-n的最短路径走了一遍，其它边走0次或两次，肯定是回到n的。</span></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; line-height:26px; text-align:left">
<span style="font-size:18px">这样就成了树上的分组背包了~~~囧，</span></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; line-height:26px; text-align:left">
<span style="font-size:18px">树形DP很弱，手很生</span></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; line-height:26px; text-align:left">
<span style="font-size:18px"></span></p>
<pre class="brush:cpp" name="code">#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;map&gt;
#include&lt;cstring&gt;
#include&lt;cmath&gt;
#include&lt;vector&gt;
#include&lt;algorithm&gt;
#include&lt;set&gt;
#include&lt;queue&gt;
#define inf 1&lt;&lt;27
#define N 105
#define M 505
#define Min(a,b) ((a)&lt;(b)?(a):(b))
#define Max(a,b) ((a)&gt;(b)?(a):(b))
#define pb(a) push_back(a)
#define LL long long
#define mem(a,b) memset(a,b,sizeof(a))
using namespace std;
struct Node{
	int v,w,next;
}edge[N*2];
int tot,start[N],val[N],dist[N];
int n,t,dp[N][M],pre[N],p[N];
void _addedge(int u,int v,int w){
	edge[tot].v=v;edge[tot].w=w;
	edge[tot].next=start[u];
	start[u]=tot++;
}
void addedge(int u,int v,int w){
	_addedge(u,v,w);
	_addedge(v,u,w);
}
void spfa(int s){
	queue&lt;int&gt;que;
	int vis[N];
	mem(vis,0);mem(pre,0);
	for(int i=1;i&lt;=n;i++)
		if(i==s)
			dist[i]=0;
		else
			dist[i]=inf;
	que.push(s);
	vis[s]=1;
	while(!que.empty()){
		int u=que.front();
		que.pop();
		vis[u]=0;
		for(int i=start[u];i!=-1;i=edge[i].next){
			int v=edge[i].v,w=edge[i].w;
			if(dist[v]&gt;dist[u]+w){
				dist[v]=dist[u]+w;
				pre[v]=u;
				p[v]=i;
				if(!vis[v]){
					vis[v]=1;
					que.push(v);
				}
			}
		}
	}
	for(int i=n;i!=1;i=pre[i]){
		edge[p[i]].w=0;
		edge[p[i]^1].w=0;
	}
}
void dfs(int u,int father){
	for(int i=start[u];i!=-1;i=edge[i].next){
		int v=edge[i].v,w=edge[i].w*2;
		if(v==father) continue;
		dfs(v,u);
		for(int i=t;i&gt;=w;i--)
			for(int j=i-w;j&gt;=0;j--)
				dp[u][i]=max(dp[u][i],dp[u][j]+dp[v][i-j-w]);
	}
	for(int i=0;i&lt;=t;i++)
		dp[u][i]+=val[u];
}
int main(){	
	while(scanf("%d%d",&amp;n,&amp;t)!=EOF){
		tot=0;mem(start,-1);
		for(int i=1;i&lt;n;i++){
			int u,v,w;
			scanf("%d%d%d",&amp;u,&amp;v,&amp;w);
			addedge(u,v,w);
		}
		for(int i=1;i&lt;=n;i++)
		    scanf("%d",&amp;val[i]);
		spfa(1);
		if(dist[n]&gt;t){
			puts("Human beings die in pursuit of wealth, and birds die in pursuit of food!");
			continue;
		}
		mem(dp,0);
		t-=dist[n];
		dfs(1,0);
		printf("%d\n",dp[1][t]);
	}
	return 0;
}
</pre>
<div style="padding-top:20px">
<p style="font-size:12px;">版权声明：本文为博主原创文章，未经博主允许不得转载。</p>
</div>
<p>参考：http://blog.csdn.net/acm_cxlove/article/details/7964739</p>
<div>
</script>
<!-- acm-hf-01 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-9460629317209118" data-ad-slot="5011774182" style="display:inline-block;width:728px;height:90px"></ins>

(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<div class="bdsharebuttonbox"><a class="bds_more" data-cmd="more" href="#"></a><a class="bds_qzone" data-cmd="qzone" href="#" title="分享到QQ空间"></a><a class="bds_tsina" data-cmd="tsina" href="#" title="分享到新浪微博"></a><a class="bds_tqq" data-cmd="tqq" href="#" title="分享到腾讯微博"></a><a class="bds_renren" data-cmd="renren" href="#" title="分享到人人网"></a><a class="bds_weixin" data-cmd="weixin" href="#" title="分享到微信"></a></div>

</div><ol id="commentlist">
<li class="comment even thread-even depth-1" id="li-comment-98933">
<article class="comment" id="comment-98933">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919521173" rel="external nofollow">新用户598135</a></span> on <a href="http://www.acmerblog.com/hdu-4276-the-ghost-blows-light-7289.html#comment-98933" rel="nofollow"><time datetime="2017-04-20T14:27:53+00:00" pubdate="">2017年4月20日 at 下午2:27</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>看世界杯有必要下迷药吗？女孩听到了呐喊声，醒来了……</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-68639">
<article class="comment" id="comment-68639">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919518216" rel="external nofollow">新用户638226</a></span> on <a href="http://www.acmerblog.com/hdu-4276-the-ghost-blows-light-7289.html#comment-68639" rel="nofollow"><time datetime="2017-04-11T07:10:17+00:00" pubdate="">2017年4月11日 at 上午7:10</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>是男L人L就L上的L网C战，A 片：htTP://uVU.Cc/ijW6  </p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
</ol>