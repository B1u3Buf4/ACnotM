<div class="c-top2" id="post-55">
<div class="datetime">2015<br/>07-16</div>
<div class="tit"><h1 class="entry-title">HDU 4481-Slalom-动态规划-[解题报告]HOJ</h1>
<div class="entry-meta iititle2">
<span class="i2"><a href="http://www.acmerblog.com/author/spiderman" rel="author" title="由蜘蛛侠发布">蜘蛛侠</a></span><span class="i1"><a href="http://www.acmerblog.com/category/problemset/hdu" rel="category tag" title="查看HDU-杭电中的全部文章">HDU-杭电</a>, <a href="http://www.acmerblog.com/category/math/probability" rel="category tag" title="查看概率计算中的全部文章">概率计算</a>, <a href="http://www.acmerblog.com/category/dp2/line-dp" rel="category tag" title="查看线性DP中的全部文章">线性DP</a></span><span class="i4">围观91次</span><span class="i3"><a class="ds-thread-count" data-thread-key="7494" href="http://www.acmerblog.com/hdu-4481-slalom-7494.html#comments" title="《HDU 4481-Slalom-动态规划-[解题报告]HOJ》上的评论">12 条评论</a></span>
</div>
</div>
<div class="cls"></div>
</div><div class="entry-content">
<div>
<h1 class="mytitle mybigtile">Slalom</h1>
</div>
<div>
<p class="mytitle"> 问题描述 :</p>
</div>
<div class="mypanel">
　　You are competing in ski slalom, and you need to select an optimal path for the race to maximize the number of gates you can pass through.<br/>　　There are N gates in total, and the gates can be considered as points. If you pass the left or the right of one gate, this gate should not be considered as a gate that you passed through. The i<sup>th</sup> gate occurs at distance y<sub>i</sub> down the hill, with the horizontal position of the i<sup>th</sup> gate given by x<sub>i</sub>. Each gate is further down the hill than the previous gate (i.e. y<sub>i</sub> &lt; y<sub>i+1</sub> for all i).<br/>　　Your pairs of skis has speed v<sub>d</sub> (i.e. you move with a constant downward velocity of v<sub>d</sub> meters per second). Additionally, at any time you may move at a horizontal speed of at most v<sub>h</sub> meters per second.<br/>You may start and finish at any two positions. Your task now is to calculate how many gates at most that you can pass through. </div>
<div>
<p class="mytitle"> 输入:</p>
</div>
<div class="mypanel">
　　There is an integer T (1 &lt;= T &lt;= 1000) in the first line, which indicates there are T test cases in total.<br/>　　For each test case, there are three integers N (1 &lt;= N &lt;= 30000), v<sub>d</sub> (1 &lt;= v<sub>d</sub> &lt;= 10000) and v<sub>h</sub> (1 &lt;= v<sub>h</sub> &lt;= 10000) in the first line, which have the same meaning as above. The following N lines each contain two integers x<sub>i</sub> (1 &lt;= x<sub>i</sub> &lt;= 1000000) and y<sub>i</sub> (1 &lt;= y<sub>i</sub> &lt;= 1000000), the horizontal and vertical positions respectively of the i<sup>th</sup> gate.<br/>　　　<strong>There are at most 10 test cases that satisfy N &gt; 100.</strong> </div>
<div>
<p class="mytitle"> 输出:</p>
</div>
<div class="mypanel">
　　There is an integer T (1 &lt;= T &lt;= 1000) in the first line, which indicates there are T test cases in total.<br/>　　For each test case, there are three integers N (1 &lt;= N &lt;= 30000), v<sub>d</sub> (1 &lt;= v<sub>d</sub> &lt;= 10000) and v<sub>h</sub> (1 &lt;= v<sub>h</sub> &lt;= 10000) in the first line, which have the same meaning as above. The following N lines each contain two integers x<sub>i</sub> (1 &lt;= x<sub>i</sub> &lt;= 1000000) and y<sub>i</sub> (1 &lt;= y<sub>i</sub> &lt;= 1000000), the horizontal and vertical positions respectively of the i<sup>th</sup> gate.<br/>　　　<strong>There are at most 10 test cases that satisfy N &gt; 100.</strong></div>
<div>
<p class="mytitle"> 样例输入:</p>
</div>
<pre class="mypanel iopanel">
2
3 2 1
1 1
5 3
6 5
4 1 1
5 1
6 2
3 3
3 4</pre>
<div>
<p class="mytitle"> 样例输出:</p>
</div>
<pre class="mypanel iopanel">
2
3
<div style="font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px"><div style="font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed"><i>Hint</i></div>
 For Sample 1, you can select to pass through gate 2 and gate 3 to maximize the number of gates you passed through.
    For Sample 2, you can select to pass through gate 1, gate 3 and gate 4 to maximize the number of gates you passed through.
</div><i style="font-size:1px"> </i></pre>
<p> <!-- problem end --></p>
<p><span style="font-size:18px"><a target="_blank">http://acm.hdu.edu.cn/showproblem.php?pid=4418</a></span></p>
<p>
</p>
<p><span style="font-size:18px">读了一遍题后大体明白意思，但有些细节不太确定。就是当它处在i点处，它有1~m步可以走，但他走的方向不确定呢。后来想想这个方向是确定的，就是他走到i点的方向，它会继续朝着这个方向走，直到转向回头。</span></p>
<p><span style="font-size:18px">首先要解决的一个问题是处在i点处，它下一步该到哪个点。为了解决方向不确定的问题，将n个点转化为2*(n-1)个点。例如当n=4时由原来的0123变为012321，它对应的编号为012345，这样就不用管它哪个方向，统一处理了，当向前走k步时即(i+k)%n。</span></p>
<p><span style="font-size:18px"><br/>
</span></p>
<p><span style="font-size:18px">然后设出dp[i]表示在i点处时到达终点的期望步数，那么可列出转移方程dp[i] = ∑( pk * (dp[ (x+k)%n ] +k) )。但是有些点是永远无法到达的，因此先bfs出所有到达的点，然后列出方程组解方程。</span></p>
<p><span style="font-size:18px">有许多注意的点，判断p[i]是否为0等。</span></p>
<p><span style="font-size:18px"><br/>
</span></p>
<p><span style="font-size:18px"></span></p>
<pre class="brush:cpp" name="code">#include &lt;stdio.h&gt;
#include &lt;iostream&gt;
#include &lt;map&gt;
#include &lt;set&gt;
#include &lt;list&gt;
#include &lt;stack&gt;
#include &lt;vector&gt;
#include &lt;math.h&gt;
#include &lt;string.h&gt;
#include &lt;queue&gt;
#include &lt;string&gt;
#include &lt;stdlib.h&gt;
#include &lt;algorithm&gt;
//#define LL __int64
#define LL long long
#define eps 1e-9
#define PI acos(-1.0)
using namespace std;
const int INF = 0x3f3f3f3f;
const int maxn = 210;

double p[maxn];
double a[maxn][maxn];//增广矩阵
double X[maxn];//解集
int num[maxn];//给每个能给到达的point离散化
int n,m,x,y,d;
int equ,var,cnt;

bool Gauss()
{
    int row,col,max_r,i,j;
    row = 0;
    col = 0;
    while(row &lt; equ &amp;&amp; col &lt; var)
    {
        max_r = row;
        for(i = row+1; i &lt; equ; i++)
        {
            if(fabs(a[i][col]) &gt; fabs(a[max_r][col]))
                max_r = i;
        }
        if(max_r != row)
        {
            for(j = col; j &lt;= var; j++)
                swap(a[row][j], a[max_r][j]);
        }
        if(fabs(a[row][col]) &lt; eps)
        {
            col++;
            continue;
        }
        for(i = row+1; i &lt; equ; i++)
        {
            if(fabs(a[i][col]) &lt; eps) continue;
            double t = a[i][col]/a[row][col];
            a[i][col] = 0.0;
            for(j = col+1; j &lt;= var; j++)
                a[i][j] -= a[row][j]*t;
        }
        row++;
        col++;
    }

    for(i = row; i &lt; equ; i++)
        if(fabs(a[i][var]) &gt; eps)
            return false; //无解
    for(i = equ-1; i &gt;= 0; i--)
    {
        if(fabs(a[i][i]) &lt; eps) continue;
        double t = a[i][var];
        for(j = i+1; j &lt; var; j++)
            t -= a[i][j]*X[j];
        X[i] = t/a[i][i];
    }
    return true;
}

void bfs(int s) //bfs找出所有能够到达的点并离散化
{
    queue &lt;int&gt; que;
    que.push(s);
    num[s] = cnt++;
    while(!que.empty())
    {
        int u = que.front();
        que.pop();
        for(int i = 1; i &lt;= m; i++)
        {
            if(fabs(p[i]) &lt; eps)
                continue;
            int v = (u+i)%n;
            if(num[v] == -1)
            {
                num[v] = cnt++;
                que.push(v);
            }
        }
    }
}

int main()
{
	int test;
	scanf("%d",&amp;test);
	for(int item = 1; item &lt;= test; item++)
	{
		scanf("%d %d %d %d %d",&amp;n,&amp;m,&amp;y,&amp;x,&amp;d);
		for(int i = 1; i &lt;= m; i++)
		{
			scanf("%lf",&amp;p[i]);
			p[i] /= 100;
		}
		if(x == y)
		{
			printf("0.00\n");
			continue;
		}
		n = 2*(n-1);
		if(d == 1)
            x = n-x;
		memset(num,-1,sizeof(num));
		cnt = 0;
		bfs(x);
		if(num[y] == -1 &amp;&amp; num[n-y] == -1) //注意这里是 &amp;&amp;，只有当两个方向都走不到才算走不到
		{
		    printf("Impossible !\n");
		    continue;
		}

		memset(a,0,sizeof(a));
		memset(X,0,sizeof(X));
		equ = var = cnt;

		for(int i = 0; i &lt; n; i++)
		{
		    if(num[i] != -1)
		    {
		        if(i == y || i == n-y) //注意特判终点
                {
                    a[num[i]][num[i]] = 1;
                    a[num[i]][cnt] = 0;
                    continue;
                }
		        a[num[i]][num[i]] = 1;
		        for(int j = 1; j &lt;= m; j++)
		        {
		            int t = (i+j)%n;
		            if(num[t] != -1)
                        a[num[i]][num[t]] -= p[j];
                    a[num[i]][cnt] += j*p[j];
		        }
		    }
		}
		if(Gauss())
            printf("%.2lf\n",X[num[x]]);
        else printf("Impossible !\n");
	}
	return 0;
}
</pre>
<p><span style="font-size:18px"><br/>
</span></p>
<div style="padding-top:20px">
<p style="font-size:12px;">版权声明：本文为博主原创文章，未经博主允许不得转载。</p>
</div>
<p>参考：http://blog.csdn.net/u013081425/article/details/39240021</p>
<div>
</script>
<!-- acm-hf-01 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-9460629317209118" data-ad-slot="5011774182" style="display:inline-block;width:728px;height:90px"></ins>

(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<div class="bdsharebuttonbox"><a class="bds_more" data-cmd="more" href="#"></a><a class="bds_qzone" data-cmd="qzone" href="#" title="分享到QQ空间"></a><a class="bds_tsina" data-cmd="tsina" href="#" title="分享到新浪微博"></a><a class="bds_tqq" data-cmd="tqq" href="#" title="分享到腾讯微博"></a><a class="bds_renren" data-cmd="renren" href="#" title="分享到人人网"></a><a class="bds_weixin" data-cmd="weixin" href="#" title="分享到微信"></a></div>

</div><ol id="commentlist">
<li class="comment even thread-even depth-1" id="li-comment-97882">
<article class="comment" id="comment-97882">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919523120" rel="external nofollow">新用户833465</a></span> on <a href="http://www.acmerblog.com/hdu-4481-slalom-7494.html#comment-97882" rel="nofollow"><time datetime="2017-04-20T08:48:51+00:00" pubdate="">2017年4月20日 at 上午8:48</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>我在想，到底谁是他心里的那个人，又或许只是他内心的寂寞。。他会痴痴地等他的伴侣和知己吗，我很怀疑。。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-67550">
<article class="comment" id="comment-67550">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919516473" rel="external nofollow">新用户598566</a></span> on <a href="http://www.acmerblog.com/hdu-4481-slalom-7494.html#comment-67550" rel="nofollow"><time datetime="2017-04-11T00:40:28+00:00" pubdate="">2017年4月11日 at 上午12:40</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>心累，只想跳过….这个情节</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-67549">
<article class="comment" id="comment-67549">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919516473" rel="external nofollow">新用户598566</a></span> on <a href="http://www.acmerblog.com/hdu-4481-slalom-7494.html#comment-67549" rel="nofollow"><time datetime="2017-04-11T00:40:28+00:00" pubdate="">2017年4月11日 at 上午12:40</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>心累，只想跳过….这个情节</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-67548">
<article class="comment" id="comment-67548">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919516473" rel="external nofollow">新用户598566</a></span> on <a href="http://www.acmerblog.com/hdu-4481-slalom-7494.html#comment-67548" rel="nofollow"><time datetime="2017-04-11T00:40:28+00:00" pubdate="">2017年4月11日 at 上午12:40</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>心累，只想跳过….这个情节</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-67547">
<article class="comment" id="comment-67547">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919516473" rel="external nofollow">新用户598566</a></span> on <a href="http://www.acmerblog.com/hdu-4481-slalom-7494.html#comment-67547" rel="nofollow"><time datetime="2017-04-11T00:40:28+00:00" pubdate="">2017年4月11日 at 上午12:40</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>心累，只想跳过….这个情节</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-67546">
<article class="comment" id="comment-67546">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919516473" rel="external nofollow">新用户598566</a></span> on <a href="http://www.acmerblog.com/hdu-4481-slalom-7494.html#comment-67546" rel="nofollow"><time datetime="2017-04-11T00:40:28+00:00" pubdate="">2017年4月11日 at 上午12:40</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>心累，只想跳过….这个情节</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-67545">
<article class="comment" id="comment-67545">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919516473" rel="external nofollow">新用户598566</a></span> on <a href="http://www.acmerblog.com/hdu-4481-slalom-7494.html#comment-67545" rel="nofollow"><time datetime="2017-04-11T00:40:28+00:00" pubdate="">2017年4月11日 at 上午12:40</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>心累，只想跳过….这个情节</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-67544">
<article class="comment" id="comment-67544">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919516473" rel="external nofollow">新用户598566</a></span> on <a href="http://www.acmerblog.com/hdu-4481-slalom-7494.html#comment-67544" rel="nofollow"><time datetime="2017-04-11T00:40:28+00:00" pubdate="">2017年4月11日 at 上午12:40</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>心累，只想跳过….这个情节</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-67543">
<article class="comment" id="comment-67543">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919516473" rel="external nofollow">新用户598566</a></span> on <a href="http://www.acmerblog.com/hdu-4481-slalom-7494.html#comment-67543" rel="nofollow"><time datetime="2017-04-11T00:40:28+00:00" pubdate="">2017年4月11日 at 上午12:40</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>心累，只想跳过….这个情节</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-67542">
<article class="comment" id="comment-67542">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919516473" rel="external nofollow">新用户598566</a></span> on <a href="http://www.acmerblog.com/hdu-4481-slalom-7494.html#comment-67542" rel="nofollow"><time datetime="2017-04-11T00:40:28+00:00" pubdate="">2017年4月11日 at 上午12:40</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>心累，只想跳过….这个情节</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-67541">
<article class="comment" id="comment-67541">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919516473" rel="external nofollow">新用户598566</a></span> on <a href="http://www.acmerblog.com/hdu-4481-slalom-7494.html#comment-67541" rel="nofollow"><time datetime="2017-04-11T00:40:28+00:00" pubdate="">2017年4月11日 at 上午12:40</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>心累，只想跳过….这个情节</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-67540">
<article class="comment" id="comment-67540">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919516473" rel="external nofollow">新用户598566</a></span> on <a href="http://www.acmerblog.com/hdu-4481-slalom-7494.html#comment-67540" rel="nofollow"><time datetime="2017-04-11T00:40:28+00:00" pubdate="">2017年4月11日 at 上午12:40</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>心累，只想跳过….这个情节</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
</ol>