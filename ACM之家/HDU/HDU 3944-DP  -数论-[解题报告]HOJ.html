<div class="c-top2" id="post-55">
<div class="datetime">2015<br/>04-14</div>
<div class="tit"><h1 class="entry-title">HDU 3944-DP?  -数论-[解题报告]HOJ</h1>
<div class="entry-meta iititle2">
<span class="i2"><a href="http://www.acmerblog.com/author/spiderman" rel="author" title="由蜘蛛侠发布">蜘蛛侠</a></span><span class="i1"><a href="http://www.acmerblog.com/category/problemset/hdu" rel="category tag" title="查看HDU-杭电中的全部文章">HDU-杭电</a>, <a href="http://www.acmerblog.com/category/math" rel="category tag" title="查看数学相关中的全部文章">数学相关</a>, <a href="http://www.acmerblog.com/category/math/number-theory" rel="category tag" title="查看数论应用中的全部文章">数论应用</a></span><span class="i4">围观561次</span><span class="i3"><a class="ds-thread-count" data-thread-key="6948" href="http://www.acmerblog.com/hdu-3944-dp-6948.html#comments" title="《HDU 3944-DP?  -数论-[解题报告]HOJ》上的评论">15 条评论</a></span>
</div>
</div>
<div class="cls"></div>
</div><div class="entry-content">
<div>
<h1 class="mytitle mybigtile">DP?  </h1>
</div>
<div>
<p class="mytitle"> 问题描述 :</p>
</div>
<div class="mypanel">
<center><img alt="K-th Nya Number" src="http://www.acmerblog.com/img/1436202530856.jpg"/></center> <br/>Figure 1 shows the Yang Hui Triangle. We number the row from top to bottom 0,1,2,…and the column from left to right 0,1,2,….If using C(n,k) represents the number of row n, column k. The Yang Hui Triangle has a regular pattern as follows.<br/>C(n,0)=C(n,n)=1 (n ≥ 0) <br/>C(n,k)=C(n-1,k-1)+C(n-1,k) (0&lt;k&lt;n)<br/>Write a program that calculates the minimum sum of numbers passed on a route that starts at the top and ends at row n, column k. Each step can go either straight down or diagonally down to the right like figure 2.<br/>As the answer may be very large, you only need to output the answer mod p which is a prime. </div>
<div>
<p class="mytitle"> 输入:</p>
</div>
<div class="mypanel">
Input to the problem will consists of series of up to 100000 data sets. For each data there is a line contains three integers n, k(0&lt;=k&lt;=n&lt;10^9)  p(p&lt;10^4 and p is a prime) . Input is terminated by end-of-file. </div>
<div>
<p class="mytitle"> 输出:</p>
</div>
<div class="mypanel">
Input to the problem will consists of series of up to 100000 data sets. For each data there is a line contains three integers n, k(0&lt;=k&lt;=n&lt;10^9)  p(p&lt;10^4 and p is a prime) . Input is terminated by end-of-file.</div>
<div>
<p class="mytitle"> 样例输入:</p>
</div>
<pre class="mypanel iopanel">
1 1 2
4 2 7</pre>
<div>
<p class="mytitle"> 样例输出:</p>
</div>
<pre class="mypanel iopanel">
Case #1: 0
Case #2: 5</pre>
<p> <!-- problem end --></p>
<p><span style="font-size:16px">原题连接：</span><span style="color:#000000"><span style="font-size:16px"><a>http://acm.hdu.edu.cn/showproblem.php?pid=3944</a></span></span></p>
<p><span style="font-size:16px">题目大意：求杨辉三角中从塔尖到n行k列所经过的路径中，虽经过数字之和最小的一条路</span></p>
<p><span style="font-size:16px">经过观察，很容易想到的一个结论就是，这个最小值是从定点开始，然后到合适的位置45度斜着走到（n,k）的位置，也就是</span></p>
<p><span style="font-size:16px">//c(m,n) 表示n中选m个</span></p>
<p><span style="font-size:16px">c(0,n-k)+c(1,n-k+1)+c(2,n-k+2) + …… + c(k,n) + n – k;</span></p>
<p><span style="font-size:16px">现在的关键就是求前面的那些组合数的和的公式</span></p>
<p><span style="font-size:16px">当时，我并不知道<span style="font-size:16px">c(0,n-k)+c(1,n-k+1)+c(2,n-k+2) + …… + c(k,n) 的公式</span></span></p>
<p><span style="font-size:16px"><span style="font-size:16px">然后我就用组合数学的式子证明了，<span style="font-size:16px">c(0,n-k)+c(1,n-k+1)+c(2,n-k+2) + …… + c(k,n)  = c(k,n+1)</span></span></span></p>
<p><span style="font-size:16px">证明过程如下：</span></p>
<p><span style="font-size:16px">有G{c(k,n+k)} = 1 / (1-x)^(n+1);这个是组合数学里面关于生成函数的式子</span></p>
<p><span style="font-size:16px">现在我们有：G{c(m,n-k+m)} = 1 / (1-x)^(n-k+1)</span></p>
<p><span style="font-size:16px">即：c(m,n-l+m) 的生成函数是  A(x) = <span style="font-size:16px">1 / (1-x)^(n-k+1)；</span></span></p>
<p><span style="font-size:16px"><span style="font-size:16px">令：B(x) = A(0) + A(1) + A(2) +…..+A(x)</span></span></p>
<p><span style="font-size:16px">则:B(x) = A(x)/(1-x) = 1 / (1 – k)^(n-k+2); //这个是生成函数的一个重要性质</span></p>
<p><span style="font-size:16px">再次使用<span style="font-size:16px">G{c(k,n+k)} = 1 / (1-x)^(n+1)</span></span></p>
<p><span style="font-size:16px"><span style="font-size:16px">就可以求得：B(x) = G{c(k,n – k+1)} 所以B(x)的第k项的系数为c(k,n+1)</span></span></p>
<p><span style="font-size:16px"><br/>
</span></p>
<p><span style="font-size:16px">我原以为这个到这儿就要结束了，总结上面的就是,结果为 (c(k,n+1)+n-k) modp</span></p>
<p><span style="font-size:16px">哎，我刚刚学习数学啊，还是太幼稚了</span></p>
<p><span style="font-size:16px">由于n和k的值都很大，也就是说，求c(k,n+1)的时候还是一个很大的麻烦，怎么求呢？？</span></p>
<p><span style="font-size:16px">这儿就有了一个 <a name="OLE_LINK3">Lucas定理</a></span></p>
<p><span style="font-size:16px"><a name="OLE_LINK3">定理是这样的：</a></span></p>
<p><span style="font-size:16px"><a name="OLE_LINK3"><span style="font-family:'WenQuanYi Micro Hei'; font-size:16px; line-height:24px"><span style="color:#ff0000">A、B是非负整数，p是质数。AB写成p进制：A=a[n]a[n-1]…a[0]，B=b[n]b[n-1]…b[0]。</span></span><span style="font-family:'WenQuanYi Micro Hei'; font-size:16px; line-height:24px"><span style="color:#ff0000"><br style="font-family:'WenQuanYi Micro Hei'!important; font-size:16px!important"/><br/>
</span></span><span style="font-family:'WenQuanYi Micro Hei'; font-size:16px; line-height:24px"><span style="color:#ff0000">则组合数C(A,B)与C(a[n],b[n])*C(a[n-1],b[n-1])*…*C(a[0],b[0]) </span></span><span style="font-family:'WenQuanYi Micro Hei'; font-size:16px; line-height:24px"><span style="color:#ff0000"><wbr style="font-family:'WenQuanYi Micro Hei'!important; font-size:16px!important"/></span></span><span style="font-family:'WenQuanYi Micro Hei'; font-size:16px; line-height:24px"><span style="color:#ff0000"> mod<br/>
 p同余</span></span><br/>
</a></span></p>
<p>Lucas定理的证明用到了数论的知识，我的数论还在起步的状态，我没有看懂！</p>
<p><span style="font-size:16px"><a name="OLE_LINK3"><span style="font-family:'WenQuanYi Micro Hei'; font-size:16px; color:#323e32; line-height:24px">然后就是求组合数连乘了</span></a></span></p>
<p><span style="font-size:16px"><a name="OLE_LINK3"><span style="font-family:'WenQuanYi Micro Hei'; font-size:16px; color:#323e32; line-height:24px">但是当我敲进了一个模板的时候，tle，我傻眼了，原来这个题需要预处理一下，因为，这儿的数据规模太大了</span></a></span></p>
<p><span style="font-size:16px"><a name="OLE_LINK3"><span style="font-family:'WenQuanYi Micro Hei'; font-size:16px; color:#323e32; line-height:24px">下面的东西，我看的那个解题报告我没看懂，包含的内容如下:筛素数，素数阶乘模逆    好像是这样的，我由于数论还没有看多少，没看懂</span></a></span></p>
<p><span style="font-size:16px"><a name="OLE_LINK3"><span style="font-family:'WenQuanYi Micro Hei'; font-size:16px; color:#323e32; line-height:24px"><br/>
</span></a></span></p>
<p><span style="font-family:'WenQuanYi Micro Hei'; font-size:18px; color:#323e32"><span style="font-size:16px; line-height:24px">我是第一次推导这样的公式，如有不妥的地方，还望多多交流</span></span></p>
<p><span style="font-family:'WenQuanYi Micro Hei'; font-size:18px; color:#323e32"><span style="font-size:16px; line-height:24px">贴一个代码吧：</span></span></p>
<p><span style="font-family:'WenQuanYi Micro Hei'; font-size:18px; color:#323e32"><span style="font-size:16px; line-height:24px"></span></span></p>
<pre class="brush:cpp" name="code">#include &lt;cstdio&gt;
#include &lt;cstring&gt;
#include &lt;vector&gt;
#define maxn 10000
using namespace std;
int flag[maxn],pim[maxn],tol;
int p[1229][9973];
int ni[1229][9973];
int mp[10000];
void init()
{
    tol=0;
    for(int i=2; i&lt;maxn; i++) //素数筛
    {
        if(!flag[i])  pim[tol++]=i;
        for(int j=0; j&lt;tol&amp;&amp;i*pim[j]&lt;maxn; j++)
        {
            flag[i*pim[j]]=1;
            if(i%pim[j]==0) break;
        }
    }
    for(int i=0; i&lt;tol; i++) //对每一个素数求各阶乘模和逆
    {
        int k=pim[i];
        mp[k]=i;
        p[i][0]=1, p[i][1]=1;
        ni[i][0]=1,ni[i][1]=1;
        for(int j=2; j&lt;k; j++) //从2！到（p-1）！
        {
            p[i][j]=j*p[i][j-1]%pim[i];
            ni[i][j]=-k/j*ni[i][k%j]%k;
            if(ni[i][j]&lt;0) ni[i][j]+=k;
        }
    }
    for(int i=0; i&lt;tol; i++) //求阶乘逆
    {
        int k=pim[i];
        for(int j=1; j&lt;k; j++)
        {
            ni[i][j]=ni[i][j]*ni[i][j-1]%k;
        }
    }
}
int cal(int n,int m,int v)
{
    if(n&lt;m) return 0;
    int x=mp[v];
    return p[x][n] * ni[x][m]%v * ni[x][n-m]%v;
}
int main()
{
    int n,k,p,ca=0;
    init();
    while(scanf("%d %d %d",&amp;n,&amp;k,&amp;p)==3)
    {
        if(k&gt;n/2) k=n-k;
        int res=1,u_u=n-k;
        n++;
        while(n&amp;&amp;k)
        {
            res=res*cal(n%p,k%p,p)%p;
            if(res==0) break;
            n/=p;
            k/=p;
        }
        printf("Case #%d: %d\n",++ca,(res+u_u)%p);
    }
    return 0;
}</pre>
<p><span style="font-size:16px"><span style="font-size:16px"><br/>
</span></span></p>
<div style="padding-top:20px">
<p style="font-size:12px;">版权声明：本文为博主原创文章，未经博主允许不得转载。</p>
</div>
<p>参考：http://blog.csdn.net/wukonwukon/article/details/6897136</p>
<div>
</script>
<!-- acm-hf-01 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-9460629317209118" data-ad-slot="5011774182" style="display:inline-block;width:728px;height:90px"></ins>

(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<div class="bdsharebuttonbox"><a class="bds_more" data-cmd="more" href="#"></a><a class="bds_qzone" data-cmd="qzone" href="#" title="分享到QQ空间"></a><a class="bds_tsina" data-cmd="tsina" href="#" title="分享到新浪微博"></a><a class="bds_tqq" data-cmd="tqq" href="#" title="分享到腾讯微博"></a><a class="bds_renren" data-cmd="renren" href="#" title="分享到人人网"></a><a class="bds_weixin" data-cmd="weixin" href="#" title="分享到微信"></a></div>

</div><ol id="commentlist">
<li class="comment even thread-even depth-1" id="li-comment-100072">
<article class="comment" id="comment-100072">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919514870" rel="external nofollow">新用户661028</a></span> on <a href="http://www.acmerblog.com/hdu-3944-dp-6948.html#comment-100072" rel="nofollow"><time datetime="2017-04-20T21:02:07+00:00" pubdate="">2017年4月20日 at 下午9:02</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>这是毕业生找工作</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-71361">
<article class="comment" id="comment-71361">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919514613" rel="external nofollow">新用户886451</a></span> on <a href="http://www.acmerblog.com/hdu-3944-dp-6948.html#comment-71361" rel="nofollow"><time datetime="2017-04-11T15:16:35+00:00" pubdate="">2017年4月11日 at 下午3:16</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>比起卡提我比较喜欢茉莉</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-34891">
<article class="comment" id="comment-34891">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">samjustin</a></span> on <a href="http://www.acmerblog.com/hdu-3944-dp-6948.html#comment-34891" rel="nofollow"><time datetime="2015-07-14T04:01:52+00:00" pubdate="">2015年7月14日 at 上午4:01</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>通不过。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-34888">
<article class="comment" id="comment-34888">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">a997930294</a></span> on <a href="http://www.acmerblog.com/hdu-3944-dp-6948.html#comment-34888" rel="nofollow"><time datetime="2015-07-11T10:22:47+00:00" pubdate="">2015年7月11日 at 上午10:22</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>总结的很全面，学习了！</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-51659">
<article class="comment" id="comment-51659">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">April</a></span> on <a href="http://www.acmerblog.com/hdu-3944-dp-6948.html#comment-51659" rel="nofollow"><time datetime="2015-06-26T00:36:48+00:00" pubdate="">2015年6月26日 at 上午12:36</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>哎，path[0]应该是从零开始吧，为什么是赋值1呢？</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-34890">
<article class="comment" id="comment-34890">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">_Tree</a></span> on <a href="http://www.acmerblog.com/hdu-3944-dp-6948.html#comment-34890" rel="nofollow"><time datetime="2015-06-17T22:22:42+00:00" pubdate="">2015年6月17日 at 下午10:22</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>方法4中使用hash表，只要用出现次数作为Value，就可以解决重复元素的问题了。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-51662">
<article class="comment" id="comment-51662">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">dreams</a></span> on <a href="http://www.acmerblog.com/hdu-3944-dp-6948.html#comment-51662" rel="nofollow"><time datetime="2015-06-16T20:11:02+00:00" pubdate="">2015年6月16日 at 下午8:11</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>已更正。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-64159">
<article class="comment" id="comment-64159">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">BGPY243956</a></span> on <a href="http://www.acmerblog.com/hdu-3944-dp-6948.html#comment-64159" rel="nofollow"><time datetime="2015-05-22T17:56:58+00:00" pubdate="">2015年5月22日 at 下午5:56</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>不同的编译器，printf(),执行的顺序不同，所以结果也就不同，建议不要那么写</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-51661">
<article class="comment" id="comment-51661">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">0xc0de</a></span> on <a href="http://www.acmerblog.com/hdu-3944-dp-6948.html#comment-51661" rel="nofollow"><time datetime="2015-05-22T05:17:51+00:00" pubdate="">2015年5月22日 at 上午5:17</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>很有用，收藏了</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-51660">
<article class="comment" id="comment-51660">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">changjf</a></span> on <a href="http://www.acmerblog.com/hdu-3944-dp-6948.html#comment-51660" rel="nofollow"><time datetime="2015-05-16T13:12:40+00:00" pubdate="">2015年5月16日 at 下午1:12</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>可以根据二叉排序树的定义进行严格的排序树创建和后序遍历操作。如果形成的排序树相同，其树的前、中、后序遍历是相同的，但在此处不能使用中序遍历，因为，中序遍历的结果就是排序的结果。经在九度测试，运行时间90ms，比楼主的要快。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-59895">
<article class="comment" id="comment-59895">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">zhuliyan</a></span> on <a href="http://www.acmerblog.com/hdu-3944-dp-6948.html#comment-59895" rel="nofollow"><time datetime="2015-05-08T13:23:28+00:00" pubdate="">2015年5月8日 at 下午1:23</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>很全很强大！</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-34887">
<article class="comment" id="comment-34887">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">sam_justin</a></span> on <a href="http://www.acmerblog.com/hdu-3944-dp-6948.html#comment-34887" rel="nofollow"><time datetime="2015-04-20T22:00:03+00:00" pubdate="">2015年4月20日 at 下午10:00</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>有点意思</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-59894">
<article class="comment" id="comment-59894">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">gnipuohz</a></span> on <a href="http://www.acmerblog.com/hdu-3944-dp-6948.html#comment-59894" rel="nofollow"><time datetime="2015-04-20T01:30:56+00:00" pubdate="">2015年4月20日 at 上午1:30</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>代码过于复杂了吧</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-34889">
<article class="comment" id="comment-34889">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">piaoyi</a></span> on <a href="http://www.acmerblog.com/hdu-3944-dp-6948.html#comment-34889" rel="nofollow"><time datetime="2015-04-18T08:26:45+00:00" pubdate="">2015年4月18日 at 上午8:26</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>先从简单的做起，归并排序，二叉树相关的遍历等</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-51658">
<article class="comment" id="comment-51658">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">tangzhihua</a></span> on <a href="http://www.acmerblog.com/hdu-3944-dp-6948.html#comment-51658" rel="nofollow"><time datetime="2015-04-15T11:59:35+00:00" pubdate="">2015年4月15日 at 上午11:59</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>看见的晚了，只能提交一次唉</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
</ol>