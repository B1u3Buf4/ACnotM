<div class="c-top2" id="post-55">
<div class="datetime">2015<br/>07-25</div>
<div class="tit"><h1 class="entry-title">HDU 4560-我是歌手-网络流-[解题报告]HOJ</h1>
<div class="entry-meta iititle2">
<span class="i2"><a href="http://www.acmerblog.com/author/spiderman" rel="author" title="由蜘蛛侠发布">蜘蛛侠</a></span><span class="i1"><a href="http://www.acmerblog.com/category/problemset/hdu" rel="category tag" title="查看HDU-杭电中的全部文章">HDU-杭电</a>, <a href="http://www.acmerblog.com/category/graph/flow" rel="category tag" title="查看网络流中的全部文章">网络流</a>, <a href="http://www.acmerblog.com/category/basis/recursion" rel="category tag" title="查看递归和分治中的全部文章">递归和分治</a></span><span class="i4">围观95次</span><span class="i3"><a class="ds-thread-count" data-thread-key="7581" href="http://www.acmerblog.com/hdu-4560-7581.html#comments" title="《HDU 4560-我是歌手-网络流-[解题报告]HOJ》上的评论">2 条评论</a></span>
</div>
</div>
<div class="cls"></div>
</div><div class="entry-content">
<div>
<h1 class="mytitle mybigtile">我是歌手</h1>
</div>
<div>
<p class="mytitle"> 问题描述 :</p>
</div>
<div class="mypanel">
2013年一开始，一档音乐节目“我是歌手”就惊艳了大家一回。闲话少说，现在，你成为了这档节目的总导演，你的任务很简单，安排每一期节目的内容。
<p>现在有N个歌手，M种歌曲流派（Rock，Pop之类），每个歌手都有自己擅长的流派领域，这些资料都已整理好。你的工作是，安排尽可能多场的演唱比赛。每一场比赛所有歌手都必须上场，为了提高收视率，每个人演唱的歌曲类型不能相同，即便一些歌手要被迫选择一些他们不擅长的。同时，为了展现全面性，在不同的演唱比赛上，每个歌手都会安排不同的歌曲流派。</p>
<p>但是问题是，对于任何一个歌曲流派的歌迷，如果超过K个不擅长的歌手演唱了这种歌曲，他们就会表示不满，比如，发一些宣泄不满的帖子微博，为了表示观点挑起事端等等。你当然不希望这些事情与你的节目有关，在这个前提下，你可以任意安排尽可能多的比赛场次。 </p></div>
<div>
<p class="mytitle"> 输入:</p>
</div>
<div class="mypanel">
输入第一行为T，表示有T组测试数据。<br/>每组数据以四个数字N，M，L, K开始。L表示有L组擅长关系，接下来的L行，每一行有两个数字Ai，Bi，表示歌手Ai擅长Bi类型的歌曲。
<p>[Technical Specification]</p>
<p>1. 1 &lt;= T &lt;= 100<br/>2. 1 &lt;= N &lt;= M &lt;= 74, 0 &lt;= K &lt;= N<br/>3. 0 &lt;= L &lt;= N*M<br/>4. 1 &lt;= Ai &lt;= N, 1 &lt;= Bi &lt;= M, 相同关系不会重复出现 </p></div>
<div>
<p class="mytitle"> 输出:</p>
</div>
<div class="mypanel">
输入第一行为T，表示有T组测试数据。<br/>每组数据以四个数字N，M，L, K开始。L表示有L组擅长关系，接下来的L行，每一行有两个数字Ai，Bi，表示歌手Ai擅长Bi类型的歌曲。
<p>[Technical Specification]</p>
<p>1. 1 &lt;= T &lt;= 100<br/>2. 1 &lt;= N &lt;= M &lt;= 74, 0 &lt;= K &lt;= N<br/>3. 0 &lt;= L &lt;= N*M<br/>4. 1 &lt;= Ai &lt;= N, 1 &lt;= Bi &lt;= M, 相同关系不会重复出现</p></div>
<div>
<p class="mytitle"> 样例输入:</p>
</div>
<pre class="mypanel iopanel">
3
1 1 1 0
1 1
1 3 0 1
3 3 5 1
1 1
1 2
2 2
2 3
3 1</pre>
<div>
<p class="mytitle"> 样例输出:</p>
</div>
<pre class="mypanel iopanel">
Case 1: 1
Case 2: 3
Case 3: 2

<div style="font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px"><div style="font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed"><i>Hint</i></div>
对第三组样例，可以如此安排：
第一场三位歌手分别演唱（2,3,1）类型的歌曲，第二场分别演唱（1,2,3）。
这样只有类型3被不擅长的歌手演唱过1次，挑剔的歌迷观众还可以接受。
</div><i style="font-size:1px"> </i></pre>
<p> <!-- problem end --></p>
<p><span style="font-size:24px"><span style="font-family:Comic Sans MS"><strong>题意：2013年一开始，一档音乐节目“我是歌手”就惊艳了大家一回。闲话少说，现在，你成为了这档节目的总导演，你的任务很简单，安排每一期节目的内容。</strong></span></span></p>
<p>现在有N个歌手，M种歌曲流派（Rock，Pop之类），每个歌手都有自己擅长的流派领域，这些资料都已整理好。你的工作是，安排尽可能多场的演唱比赛。每一场比赛所有歌手都必须上场，为了提高收视率，每个人演唱的歌曲类型不能相同，即便一些歌手要被迫选择一些他们不擅长的。同时，为了展现全面性，在不同的演唱比赛上，每个歌手都会安排不同的歌曲流派。</p>
<p>但是问题是，对于任何一个歌曲流派的歌迷，如果超过K个不擅长的歌手演唱了这种歌曲，他们就会表示不满，比如，发一些宣泄不满的帖子微博，为了表示观点挑起事端等等。你当然不希望这些事情与你的节目有关，在这个前提下，你可以任意安排尽可能多的比赛场次。</p>
<p><span style="font-family:Comic Sans MS; font-size:24px"><strong><br/>
</strong></span></p>
<p><span style="font-family:Comic Sans MS; font-size:24px"><strong>想法：没得说这题是网络流，就是看怎么建图，设最大的场次为tim，我们知道，0&lt;=tim&lt;=歌曲流派数，因为每一次每个歌手唱的不一样。</strong></span></p>
<p><strong><span style="font-family:Comic Sans MS; font-size:24px">建图：虚拟超级原点source和汇点sink。</span></strong></p>
<p><strong><span style="font-family:Comic Sans MS; font-size:24px">1.s到每一个歌手i连一条容量为tim的边：显然每个歌手是要参加tim场演唱的；</span></strong></p>
<p><strong><span style="font-family:Comic Sans MS; font-size:24px">2.每一个歌手i向他擅长的歌曲流派k连一条容量为1的边：他只能一场唱一次；</span></strong></p>
<p><strong><span style="font-family:Comic Sans MS; font-size:24px">3.每一个歌手i向他不擅长的歌曲流派k‘连一条容量为1的边：它可以唱不擅长的，但是还是只能唱一首歌；</span></strong></p>
<p><strong><span style="font-family:Comic Sans MS; font-size:24px">4.k’到k连一条容量为K（题中的K，大写）：限制一条歌手唱不擅长的歌曲流派的人数，当人数&gt;K的时候，显然只能流过去K个人；</span></strong></p>
<p><strong><span style="font-family:Comic Sans MS; font-size:24px">5.k到sink连一条容量为tim的边：是对唱这个歌曲流派的总人数（包括擅长的歌手也包括不擅长的歌手）的限制。</span></strong></p>
<p><strong><span style="font-family:Comic Sans MS; font-size:24px"><br/>
</span></strong></p>
<p><strong><span style="font-family:Comic Sans MS; font-size:24px"></span></strong></p>
<pre class="brush:cpp" name="code">#include&lt;iostream&gt;
#include&lt;cstring&gt;
#include&lt;cstdio&gt;
#include&lt;queue&gt;
#define inf 0x7fffffff
using namespace std;
const int nodes=300;
const int edges=180000;
int n,m,l,k;
int map[80][80];
int s,t;
struct node 
{
	int v,next;
	int flow;
}e[edges];
int head[nodes],cnt;
class Dinic
{
    public:
        int spath()
        {
            queue&lt;int&gt;q;
            while(!q.empty()) q.pop();
            memset(dis,-1,sizeof(dis));
            dis[s]=0;
            q.push(s);
            while(!q.empty())
            {
                int u=q.front();
                q.pop();
                for(int i=head[u];i+1;i=e[i].next)
                {
                    int v=e[i].v;
                    if(dis[v]==-1&amp;&amp;e[i].flow&gt;0)
                    {
                        dis[v]=dis[u]+1;
                        q.push(v);
                    }
                }
            }
            return dis[t]!=-1;
        }
        int Min(int a,int b)
        {
            if(a&lt;b) return a;
            return b;
        }
        int dfs(int u,int flow)
        {
            int cost=0;
            if(u==t) return flow;
            for(int i=head[u];i+1;i=e[i].next)
            {
                int v=e[i].v;
                if(dis[v]==dis[u]+1&amp;&amp;e[i].flow&gt;0)
                {
                    int min=dfs(v,Min(e[i].flow,flow-cost));
                    if(min&gt;0)
                    {
                        e[i].flow-=min;
                        e[i^1].flow+=min;
                        cost+=min;
                        if(cost==flow) break;
                    }
                    else dis[v]=-1;
                }
            }
            return cost;
        }
        int result()
        {
            int res=0;
            while(spath())
            {
                res+=dfs(s,inf);
            }
            return res;
        }
    private:
        int dis[nodes];
}dinic;
void Init()
{
	memset(head,-1,sizeof(head));
	cnt=0;
}
void add(int a,int b,int c)
{
	e[cnt].v=b;
	e[cnt].next=head[a];
	e[cnt].flow=c;
	head[a]=cnt++;
	
	e[cnt].v=a;
	e[cnt].next=head[b];
	e[cnt].flow=0;
	head[b]=cnt++;
}
void Input()
{
	scanf("%d%d%d%d",&amp;n,&amp;m,&amp;l,&amp;k);
	memset(map,0,sizeof(map));
	for(int i=1;i&lt;=l;i++)
	{
		int a,b;
		scanf("%d%d",&amp;a,&amp;b);
		map[a][b]=1;
	}
}
bool judge(int tim)
{
	s=0;t=2*m+n+1;
	Init();
	for(int i=1;i&lt;=n;i++)
	add(s,i,tim);
	for(int i=1;i&lt;=n;i++)
	{
		for(int j=1;j&lt;=m;j++)
		{
			if(map[i][j]) add(i,n+j,1);
			else add(i,n+m+j,1);
		}
	}
	for(int i=1;i&lt;=m;i++)
	{
		add(n+m+i,n+i,k);
		add(n+i,t,tim);
	}
	int k=dinic.result();
	if(k&gt;=tim*n) return true;
	else return false;
}
void treatment(int ca)
{
	int ans;
	int low=0,up=m;
	while(low&lt;=up)
	{
		int mid=(low+up)/2;
		if(judge(mid))
		{
			ans=mid;
			low=mid+1;
		}
		else up=mid-1;
	}
	printf("Case %d: %d\n",ca,ans);
} 
int main()
{
	int t,ca=1;
	scanf("%d",&amp;t);
	while(t--)
	{
		Input();
		treatment(ca++);
	}
	return 0;
}</pre>
<p>
</p>
<div style="top:0px"><span style="font-family:Comic Sans MS">﻿﻿</span></div>
<div style="padding-top:20px">
<p style="font-size:12px;">版权声明：本文为博主原创文章，未经博主允许不得转载。</p>
</div>
<p>参考：http://blog.csdn.net/triple_wdf/article/details/49286229</p>
<div>
</script>
<!-- acm-hf-01 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-9460629317209118" data-ad-slot="5011774182" style="display:inline-block;width:728px;height:90px"></ins>

(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<div class="bdsharebuttonbox"><a class="bds_more" data-cmd="more" href="#"></a><a class="bds_qzone" data-cmd="qzone" href="#" title="分享到QQ空间"></a><a class="bds_tsina" data-cmd="tsina" href="#" title="分享到新浪微博"></a><a class="bds_tqq" data-cmd="tqq" href="#" title="分享到腾讯微博"></a><a class="bds_renren" data-cmd="renren" href="#" title="分享到人人网"></a><a class="bds_weixin" data-cmd="weixin" href="#" title="分享到微信"></a></div>

</div><ol id="commentlist">
<li class="comment even thread-even depth-1" id="li-comment-97571">
<article class="comment" id="comment-97571">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919514030" rel="external nofollow">新用户208209</a></span> on <a href="http://www.acmerblog.com/hdu-4560-7581.html#comment-97571" rel="nofollow"><time datetime="2017-04-20T05:15:18+00:00" pubdate="">2017年4月20日 at 上午5:15</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>消失得很不正常。应该不是星星。难道是被云挡住了？</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-67000">
<article class="comment" id="comment-67000">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919520335" rel="external nofollow">新用户570274</a></span> on <a href="http://www.acmerblog.com/hdu-4560-7581.html#comment-67000" rel="nofollow"><time datetime="2017-04-10T22:27:51+00:00" pubdate="">2017年4月10日 at 下午10:27</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>***************</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
</ol>