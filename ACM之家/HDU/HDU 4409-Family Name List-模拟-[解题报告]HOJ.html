<div class="c-top2" id="post-55">
<div class="datetime">2015<br/>07-16</div>
<div class="tit"><h1 class="entry-title">HDU 4409-Family Name List-模拟-[解题报告]HOJ</h1>
<div class="entry-meta iititle2">
<span class="i2"><a href="http://www.acmerblog.com/author/spiderman" rel="author" title="由蜘蛛侠发布">蜘蛛侠</a></span><span class="i1"><a href="http://www.acmerblog.com/category/problemset/hdu" rel="category tag" title="查看HDU-杭电中的全部文章">HDU-杭电</a>, <a href="http://www.acmerblog.com/category/basis/sort" rel="category tag" title="查看排序中的全部文章">排序</a>, <a href="http://www.acmerblog.com/category/basis/simulate" rel="category tag" title="查看模拟法中的全部文章">模拟法</a></span><span class="i4">围观108次</span><span class="i3"><a class="ds-thread-count" data-thread-key="7422" href="http://www.acmerblog.com/hdu-4409-family-name-list-7422.html#comments" title="《HDU 4409-Family Name List-模拟-[解题报告]HOJ》上的评论">12 条评论</a></span>
</div>
</div>
<div class="cls"></div>
</div><div class="entry-content">
<div>
<h1 class="mytitle mybigtile">Family Name List</h1>
</div>
<div>
<p class="mytitle"> 问题描述 :</p>
</div>
<div class="mypanel">
Kong belongs to a huge family. Recently he got a family name list which lists all men (no women) in his family over many generations. 
<p>The list shows that the whole family has a common ancestor, let’s call him Mr. X. Of course, everybody except Mr.X in the list is Mr. X’s descendant. Everybody’s father is shown in the list except that Mr. X’s father is not recorded. We define that Mr. X’s generation number is 0. His son’s generation number is 1.His grandson’s generation number is 2, and so on. In a word, everybody’s generation number is 1 smaller than his son’s generation number. Everybody’s generation number is marked in some way in the list.</p>
<p>Now Kong is willing to pay a lot of money for a program which can re-arrange the list as he requires ,and answer his questions such as how many brothers does a certain man have, etc. Please write this program for him. </p></div>
<div>
<p class="mytitle"> 输入:</p>
</div>
<div class="mypanel">
There are no more than 15 test cases. <br/>For each test case:<br/>The first line is an integer N( 1 &lt;= N &lt;= 30,000), indicating the number of names in the list.<br/>The second line is the name of Mr. X.<br/>In the next N-1 lines, there is a man’s name in each line. And if the man’s generation number is K, there are K dots( ‘.’) before his name.
<p>Please note that :<br/>1) A name consists of only letters or digits( ’0′-’9′).<br/>2) All names are unique.<br/>3) Every line’s length is no more than 60 characters.<br/>4) In the list, a man M’s father is the closest one above M whose generation number is 1 less than M.<br/>5) For any 2 adjacent lines in the list, if the above line’s generation number is G1 and the lower line’ s generation number is G2, than G2 &lt;= G1 +1 is guaranteed. </p>
<p>After the name list, a line containing an integer Q(1&lt;=Q&lt;=30,000) follows, meaning that there are Q queries or operations below.</p>
<p>In the Next Q lines, each line indicates a query or operation. It can be in the following 3 formats:<br/>1) L<br/>Print the family list in the same format as the input, but in a sorted way. The sorted way means that: if A and B are brothers(cousins don’t count), and A’s name is alphabetically smaller than B’s name, then A must appear earlier than B. <br/>2) b name<br/>Print out how many brothers does "name" have, including "name" himself.<br/>3) c name1 name2<br/>Print out the closest common ancestor of "name1" and "name2". "Closest" means the generation number is the largest. Since Mr. X has no ancestor in the list, so it’s guaranteed that there is no question asking about Mr. X’s ancestor. </p>
<p>The input ends with N = 0. </p></div>
<div>
<p class="mytitle"> 输出:</p>
</div>
<div class="mypanel">
There are no more than 15 test cases. <br/>For each test case:<br/>The first line is an integer N( 1 &lt;= N &lt;= 30,000), indicating the number of names in the list.<br/>The second line is the name of Mr. X.<br/>In the next N-1 lines, there is a man’s name in each line. And if the man’s generation number is K, there are K dots( ‘.’) before his name.
<p>Please note that :<br/>1) A name consists of only letters or digits( ’0′-’9′).<br/>2) All names are unique.<br/>3) Every line’s length is no more than 60 characters.<br/>4) In the list, a man M’s father is the closest one above M whose generation number is 1 less than M.<br/>5) For any 2 adjacent lines in the list, if the above line’s generation number is G1 and the lower line’ s generation number is G2, than G2 &lt;= G1 +1 is guaranteed. </p>
<p>After the name list, a line containing an integer Q(1&lt;=Q&lt;=30,000) follows, meaning that there are Q queries or operations below.</p>
<p>In the Next Q lines, each line indicates a query or operation. It can be in the following 3 formats:<br/>1) L<br/>Print the family list in the same format as the input, but in a sorted way. The sorted way means that: if A and B are brothers(cousins don’t count), and A’s name is alphabetically smaller than B’s name, then A must appear earlier than B. <br/>2) b name<br/>Print out how many brothers does "name" have, including "name" himself.<br/>3) c name1 name2<br/>Print out the closest common ancestor of "name1" and "name2". "Closest" means the generation number is the largest. Since Mr. X has no ancestor in the list, so it’s guaranteed that there is no question asking about Mr. X’s ancestor. </p>
<p>The input ends with N = 0.</p></div>
<div>
<p class="mytitle"> 样例输入:</p>
</div>
<pre class="mypanel iopanel">
9
Kongs
.son1
..son1son2
..son1son1
...sonkson2son1
...son1son2son2
..son1son3
...son1son3son1
.son0	
7
L
b son1son3son1
b son1son2
b sonkson2son1
b son1
c sonkson2son1 son1son2son2
c son1son3son1 son1son2
0 </pre>
<div>
<p class="mytitle"> 样例输出:</p>
</div>
<pre class="mypanel iopanel">
Kongs
.son0
.son1
..son1son1
...son1son2son2
...sonkson2son1
..son1son2
..son1son3
...son1son3son1
1
3
2
2
son1son1
son1</pre>
<p> <!-- problem end --></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px; text-align:left">
<span style="color:rgb(255,102,102)">题目：</span><a style="color:rgb(202,0,0)"></a><a>http://acm.hdu.edu.cn/showproblem.php?pid=4409</a></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px; text-align:left">
<span style="color:rgb(51,102,255)">题意：</span>给你一个家族表，同时有3种操作，问你操作后的结果。</p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px; text-align:left">
<span style="color:rgb(204,51,204)">题解：</span>模拟题，把3个操作处理好就行了。题目有个陷阱，比如a是b的父亲，b是c的父亲，当问你b和c的最近的共同父辈是谁的时候，答案是a而不是b。还有问最开头那个祖先的兄弟时要返回1。</p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px; text-align:left">
代码：</p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px; text-align:left">
</p><pre class="brush:cpp" name="code">#include&lt;cstdio&gt;
#include&lt;cstring&gt;
#include&lt;string&gt;
#include&lt;vector&gt;
#include&lt;map&gt;
#include&lt;set&gt;
#include&lt;stack&gt;
using namespace std;
#define M 30005
map&lt;int,string&gt; hasht;
map&lt;string,int&gt; hashx;
struct cmp//排序
{
    bool operator()(const int &amp;a, const int &amp;b)
    {
        return hasht.find(a)-&gt;second&lt;hasht.find(b)-&gt;second;
    }
};
struct point
{
    int pre;//父结点的位置
    set&lt;int,cmp&gt; son;//子结点的位置
    string name;//当前结点的名字
}node[M];
struct px
{
    int idx,len;//结点的位置，结点的辈分
} temp;
int cnt;
stack&lt;struct px&gt; father;
void dfs(int idx,int len)//递归输出族谱
{
    for(int i=0; i&lt;len; ++i) printf(".");
    printf("%s\n",node[idx].name.c_str());
    for(set&lt;int,cmp&gt;::iterator it=node[idx].son.begin(); it!=node[idx].son.end(); ++it)
        dfs(*it,len+1);
}
void out_all()//Print the family list
{
    dfs(0,0);
}
void out_child()//Print out how many brothers does "name" have, including "name" himself.
{
    char s[70];
    scanf("%s",s);
    if(hashx.count(string(s))==0)
    {
        printf("0\n");
        return;
    }
    if(string(s)==node[0].name)
    {
        printf("1\n");
        return;
    }
    int idx=hashx.find(string(s))-&gt;second;
    printf("%d\n",node[node[idx].pre].son.size());
}
void out_pre()//Print out the closest common ancestor of "name1" and "name2".
{
    char a[70],b[70];
    scanf("%s%s",a,b);
    set&lt;int&gt; ax;
    int ida=hashx.find(string(a))-&gt;second;
    int idb=hashx.find(string(b))-&gt;second;
    for(; ida!=-1;)
    {
        ida=node[ida].pre;
        ax.insert(ida);
    }
    for(; idb!=-1;)
    {
        idb=node[idb].pre;
        if(ax.count(idb)!=0) break;
    }
    printf("%s\n",node[idb].name.c_str());
}
int main()
{
    int n,m,pre;
    char s[70],c,ord[10];
    string sx;
    for(; scanf("%d",&amp;n),n;)
    {
        for(int i=0; i&lt;=n; ++i)
        {
            node[i].pre=-1;
            node[i].son.clear();
        }
        hashx.clear();
        hasht.clear();
        for(; !father.empty(); father.pop());
        cnt=0;
        temp.idx=0;
        temp.len=0;
        scanf("%s",s);
        sx=string(s);
        node[cnt++].name=sx;
        hashx.insert(make_pair(sx,0));
        hasht.insert(make_pair(0,sx));
        father.push(temp);
        for(int i=1; i&lt;n; ++i)
        {
            for(; getchar()!='.';);
            int ll=1;
            for(; (c=getchar())=='.'; ++ll);
            s[0]=c;
			int llt;
            for(llt=1;(s[llt]=getchar())!='\n';++llt);
			s[llt]='\0';
            temp.len=ll;
            temp.idx=cnt;
            for(;;)
            {
                struct px tx=father.top();
                if(tx.len&gt;=temp.len)
                    father.pop();
                else
                    break;
            }
            sx=string(s);
            int tx=father.top().idx;
            node[cnt].pre=tx;
            node[cnt].name=sx;
            hasht.insert(make_pair(cnt,sx));
            hashx.insert(make_pair(sx,cnt));
            node[tx].son.insert(cnt);
            cnt++;
            father.push(temp);
        }
        scanf("%d",&amp;m);
        for(; m--;)//处理查询
        {
            scanf("%s",ord);
            if(ord[0]=='L')
                out_all();
            else if(ord[0]=='b')
                out_child();
            else if(ord[0]=='c')
                out_pre();
        }
    }
    return 0;
}
</pre>
<p>来源：<a>http://blog.csdn.net/acm_ted/article/details/8007857</a></p>
<div style="padding-top:20px">
<p style="font-size:12px;">版权声明：本文为博主原创文章，未经博主允许不得转载。</p>
</div>
<p>参考：http://blog.csdn.net/acm_ted/article/details/8007857</p>
<div>
</script>
<!-- acm-hf-01 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-9460629317209118" data-ad-slot="5011774182" style="display:inline-block;width:728px;height:90px"></ins>

(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<div class="bdsharebuttonbox"><a class="bds_more" data-cmd="more" href="#"></a><a class="bds_qzone" data-cmd="qzone" href="#" title="分享到QQ空间"></a><a class="bds_tsina" data-cmd="tsina" href="#" title="分享到新浪微博"></a><a class="bds_tqq" data-cmd="tqq" href="#" title="分享到腾讯微博"></a><a class="bds_renren" data-cmd="renren" href="#" title="分享到人人网"></a><a class="bds_weixin" data-cmd="weixin" href="#" title="分享到微信"></a></div>

</div><ol id="commentlist">
<li class="comment even thread-even depth-1" id="li-comment-98124">
<article class="comment" id="comment-98124">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919530757" rel="external nofollow">新用户071422</a></span> on <a href="http://www.acmerblog.com/hdu-4409-family-name-list-7422.html#comment-98124" rel="nofollow"><time datetime="2017-04-20T11:47:09+00:00" pubdate="">2017年4月20日 at 上午11:47</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>垃圾扔了5吨最多倡导下国民素质啊，研究下解决办法也就算了，最离谱的是扔垃圾跟爱国居然存在相关性，好像公知从来就没扔过似的，结果五毛跪舔失败还美其名曰负面营销。。。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-98123">
<article class="comment" id="comment-98123">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919530757" rel="external nofollow">新用户071422</a></span> on <a href="http://www.acmerblog.com/hdu-4409-family-name-list-7422.html#comment-98123" rel="nofollow"><time datetime="2017-04-20T11:47:09+00:00" pubdate="">2017年4月20日 at 上午11:47</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>垃圾扔了5吨最多倡导下国民素质啊，研究下解决办法也就算了，最离谱的是扔垃圾跟爱国居然存在相关性，好像公知从来就没扔过似的，结果五毛跪舔失败还美其名曰负面营销。。。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-98122">
<article class="comment" id="comment-98122">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919530757" rel="external nofollow">新用户071422</a></span> on <a href="http://www.acmerblog.com/hdu-4409-family-name-list-7422.html#comment-98122" rel="nofollow"><time datetime="2017-04-20T11:47:09+00:00" pubdate="">2017年4月20日 at 上午11:47</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>垃圾扔了5吨最多倡导下国民素质啊，研究下解决办法也就算了，最离谱的是扔垃圾跟爱国居然存在相关性，好像公知从来就没扔过似的，结果五毛跪舔失败还美其名曰负面营销。。。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-98121">
<article class="comment" id="comment-98121">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919530757" rel="external nofollow">新用户071422</a></span> on <a href="http://www.acmerblog.com/hdu-4409-family-name-list-7422.html#comment-98121" rel="nofollow"><time datetime="2017-04-20T11:47:09+00:00" pubdate="">2017年4月20日 at 上午11:47</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>垃圾扔了5吨最多倡导下国民素质啊，研究下解决办法也就算了，最离谱的是扔垃圾跟爱国居然存在相关性，好像公知从来就没扔过似的，结果五毛跪舔失败还美其名曰负面营销。。。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-98120">
<article class="comment" id="comment-98120">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919530757" rel="external nofollow">新用户071422</a></span> on <a href="http://www.acmerblog.com/hdu-4409-family-name-list-7422.html#comment-98120" rel="nofollow"><time datetime="2017-04-20T11:47:09+00:00" pubdate="">2017年4月20日 at 上午11:47</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>垃圾扔了5吨最多倡导下国民素质啊，研究下解决办法也就算了，最离谱的是扔垃圾跟爱国居然存在相关性，好像公知从来就没扔过似的，结果五毛跪舔失败还美其名曰负面营销。。。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-68076">
<article class="comment" id="comment-68076">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919514635" rel="external nofollow">新用户499008</a></span> on <a href="http://www.acmerblog.com/hdu-4409-family-name-list-7422.html#comment-68076" rel="nofollow"><time datetime="2017-04-11T03:57:03+00:00" pubdate="">2017年4月11日 at 上午3:57</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>虽然我也喜欢凉夕，但是我不允许你说别的漫画里面女主的坏话！你有本事和她们比颜值，你肯定比她们丑！</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-68075">
<article class="comment" id="comment-68075">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919514635" rel="external nofollow">新用户499008</a></span> on <a href="http://www.acmerblog.com/hdu-4409-family-name-list-7422.html#comment-68075" rel="nofollow"><time datetime="2017-04-11T03:57:03+00:00" pubdate="">2017年4月11日 at 上午3:57</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>虽然我也喜欢凉夕，但是我不允许你说别的漫画里面女主的坏话！你有本事和她们比颜值，你肯定比她们丑！</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-68074">
<article class="comment" id="comment-68074">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919514635" rel="external nofollow">新用户499008</a></span> on <a href="http://www.acmerblog.com/hdu-4409-family-name-list-7422.html#comment-68074" rel="nofollow"><time datetime="2017-04-11T03:57:03+00:00" pubdate="">2017年4月11日 at 上午3:57</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>虽然我也喜欢凉夕，但是我不允许你说别的漫画里面女主的坏话！你有本事和她们比颜值，你肯定比她们丑！</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-68073">
<article class="comment" id="comment-68073">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919514635" rel="external nofollow">新用户499008</a></span> on <a href="http://www.acmerblog.com/hdu-4409-family-name-list-7422.html#comment-68073" rel="nofollow"><time datetime="2017-04-11T03:57:03+00:00" pubdate="">2017年4月11日 at 上午3:57</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>虽然我也喜欢凉夕，但是我不允许你说别的漫画里面女主的坏话！你有本事和她们比颜值，你肯定比她们丑！</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-68072">
<article class="comment" id="comment-68072">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919514635" rel="external nofollow">新用户499008</a></span> on <a href="http://www.acmerblog.com/hdu-4409-family-name-list-7422.html#comment-68072" rel="nofollow"><time datetime="2017-04-11T03:57:03+00:00" pubdate="">2017年4月11日 at 上午3:57</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>虽然我也喜欢凉夕，但是我不允许你说别的漫画里面女主的坏话！你有本事和她们比颜值，你肯定比她们丑！</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-68071">
<article class="comment" id="comment-68071">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919514635" rel="external nofollow">新用户499008</a></span> on <a href="http://www.acmerblog.com/hdu-4409-family-name-list-7422.html#comment-68071" rel="nofollow"><time datetime="2017-04-11T03:57:03+00:00" pubdate="">2017年4月11日 at 上午3:57</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>虽然我也喜欢凉夕，但是我不允许你说别的漫画里面女主的坏话！你有本事和她们比颜值，你肯定比她们丑！</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-68070">
<article class="comment" id="comment-68070">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919514635" rel="external nofollow">新用户499008</a></span> on <a href="http://www.acmerblog.com/hdu-4409-family-name-list-7422.html#comment-68070" rel="nofollow"><time datetime="2017-04-11T03:57:03+00:00" pubdate="">2017年4月11日 at 上午3:57</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>虽然我也喜欢凉夕，但是我不允许你说别的漫画里面女主的坏话！你有本事和她们比颜值，你肯定比她们丑！</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
</ol>