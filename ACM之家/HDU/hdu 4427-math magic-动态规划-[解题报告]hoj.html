<div class="c-top2" id="post-55">
<div class="datetime">2015<br/>07-16</div>
<div class="tit"><h1 class="entry-title">hdu 4427-math magic-动态规划-[解题报告]hoj</h1>
<div class="entry-meta iititle2">
<span class="i2"><a href="http://www.acmerblog.com/author/spiderman" rel="author" title="由蜘蛛侠发布">蜘蛛侠</a></span><span class="i1"><a href="http://www.acmerblog.com/category/problemset/hdu" rel="category tag" title="查看HDU-杭电中的全部文章">HDU-杭电</a>, <a href="http://www.acmerblog.com/category/basis/sort" rel="category tag" title="查看排序中的全部文章">排序</a>, <a href="http://www.acmerblog.com/category/dp2/line-dp" rel="category tag" title="查看线性DP中的全部文章">线性DP</a></span><span class="i4">围观135次</span><span class="i3"><a class="ds-thread-count" data-thread-key="7440" href="http://www.acmerblog.com/hdu-4427-math-magic-7440.html#comments" title="《hdu 4427-math magic-动态规划-[解题报告]hoj》上的评论">18 条评论</a></span>
</div>
</div>
<div class="cls"></div>
</div><div class="entry-content">
<h1 style="color:#1a5cc8">Math Magic</h1>
<p><span size="+0" style=""><strong><span style="font-size:12px; font-family:Arial; color:green">Time Limit: 4000/2000 MS (Java/Others)    Memory Limit: 32768/32768 K (Java/Others)<br/>
Total Submission(s): 495    Accepted Submission(s): 210<br/>
</span></strong></span></p>
<div align="left" class="panel_title">Problem Description</div>
<div class="panel_content">Yesterday, my teacher taught us about math: +, -, *, /, GCD, LCM… As you know, LCM (Least common multiple) of two positive numbers can be solved easily because of a * b = GCD (a, b) * LCM (a, b).<br/>
In class, I raised a new idea: “how to calculate the LCM of K numbers”. It’s also an easy problem indeed, which only cost me 1 minute to solve it. I raised my hand and told teacher about my outstanding algorithm. Teacher just smiled and smiled…<br/>
After class, my teacher gave me a new problem and he wanted me solve it in 1 minute, too.<br/>
If we know three parameters N, M, K, and two equations:<br/>
<strong>1.</strong> SUM (A<sub>1</sub>, A<sub>2</sub>, …, A<sub>i</sub>, A<sub>i+1</sub>,…, A<sub>K</sub>) = N<br/>
<strong>2.</strong> LCM (A<sub>1</sub>, A<sub>2</sub>, …, A<sub>i</sub>, A<sub>i+1</sub>,…, A<sub>K</sub>) = M<br/>
Can you calculate how many kinds of solutions are there for A<sub>i</sub> (A<sub>i</sub> are all positive numbers).<br/>
I began to roll cold sweat but teacher just smiled and smiled. <br/>
Can you solve this problem in 1 minute?
</div>
<div class="panel_bottom"> </div>
<p></p>
<div align="left" class="panel_title">Input</div>
<div class="panel_content">There are multiple test cases.<br/>
Each test case contains three integers N, M, K. (1 &lt;= N, M &lt;= 1,000, 1 &lt;= K &lt;= 100)
</div>
<div class="panel_bottom"> </div>
<p></p>
<div align="left" class="panel_title">Output</div>
<div class="panel_content">For each test case, output an integer indicating the number of solution modulo 1,000,000,007(10<sup>9</sup> + 7).<br/>
You can get more details in the sample and hint below.
</div>
<div class="panel_bottom"> </div>
<p></p>
<div align="left" class="panel_title">Sample Input</div>
<div class="panel_content">
<pre><div style="font-family:Courier New,Courier,monospace">4 2 2
3 2 2</div></pre>
</div>
<div class="panel_bottom"> </div>
<p></p>
<div align="left" class="panel_title">Sample Output</div>
<div class="panel_content">
<pre><div style="font-family:Courier New,Courier,monospace">1
2

<div style="font-size:14px; border-top:#b7cbff 1px dashed; font-family:Times New Roman; border-right:#b7cbff 1px dashed; border-bottom:#b7cbff 1px dashed; padding-bottom:6px; padding-top:6px; padding-left:6px; border-left:#b7cbff 1px dashed; padding-right:6px; background-color:#f4fbff"><div style="font-family:Arial; border-bottom:#b7cbff 1px dashed; font-weight:bold; color:#7ca9ed"><em>Hint</em></div>
The first test case: the only solution is (2, 2).
The second test case: the solution are (1, 2) and (2, 1).
</div><span style="font-size:1px"> </span></div></pre>
</div>
<div class="panel_bottom"> </div>
<p></p>
<div align="left" class="panel_title">Source</div>
<div class="panel_content"><a href="http://acm.hdu.edu.cn/search.php?field=problem&amp;key=2012%20Asia%20ChangChun%20Regional%20Contest&amp;source=1&amp;searchmode=source" target="_blank">2012 Asia ChangChun Regional Contest<br/>
</a></div>
<div class="panel_bottom"> </div>
<p></p>
<div align="left" class="panel_title">Recommend</div>
<div class="panel_content">zhuyuanchen520</div>
<div class="panel_bottom"> </div>
<p><span style="font-size:18px">题意：</span></p>
<p><span style="font-size:18px">给你k个数的和和k个数的最小公倍数。问你一共有多少满足条件的解。</span></p>
<p><span style="font-size:18px">开始SB了。以为是算组合数。纠结了半天。结果一看样例就凌乱了。</span></p>
<p><span style="font-size:18px">1,2。2,1。是不同的组合也就是说和排序有关。</span></p>
<p><span style="font-size:18px">以后一定要先看完样例 了。。。。</span></p>
<p><span style="font-size:18px">这下就简单了。用三维来表示状态。</span></p>
<p><span style="font-size:18px">dp[i][j][k]。表示长度为i。和为j。最小公倍数为k的方法数。</span></p>
<p><span style="font-size:18px">设a为解的第i+1个数。</span></p>
<p><span style="font-size:18px">那么状态转移就为</span></p>
<p><span style="font-size:18px">dp[i+1][j+a][lcm(a,k)]+=dp[i][j][k]。</span></p>
<p><span style="font-size:18px">lcm为最大公倍数。</span></p>
<p><span style="font-size:18px">由于三维开不下就只能用滚动数组了。</span></p>
<p><span style="font-size:18px">为了节约时间先预处理出1000以内任意两数的最小公倍数。注意一点。一个数学常识。如果这k个数的最小公倍数是</span></p>
<p><span style="font-size:18px">x。那么这k个数肯定都是x的因子。所以先预处理出x的因子。这样就可以有效的减少枚举范围。还有memset要慎用尤其是在这种数量级下。</span></p>
<p><span style="font-size:18px">详细见代码：</span></p>
<p><span style="font-size:18px"></span></p>
<pre class="brush:cpp" name="code">#include &lt;iostream&gt;
#include&lt;stdio.h&gt;
#include&lt;string.h&gt;
#include&lt;math.h&gt;
using namespace std;
const int maxn=1010;
const int mod=1000000007;

int dp[2][maxn][maxn];
int lcm[maxn][maxn];//lcm[a][b]为a,b的最大公约数。
int fac[maxn];//存m的因子
int gcd(int a,int b)
{
    int t;
    while(b)
    {
        t=a%b;
        a=b;
        b=t;
    }
    return a;
}
int main()
{
    int n,m,k,cnt,i,j,p,q,e,f,t,v,mul,tt;

    for(i=1; i&lt;maxn; i++)
        for(j=i; j&lt;maxn; j++)//预处理出任意两数的最大公倍数
            lcm[i][j]=lcm[j][i]=i*j/gcd(i,j);
    while(~scanf("%d%d%d",&amp;n,&amp;m,&amp;k))
    {
        cnt=0;
        for(i=1; i&lt;=m; i++)
        {
            if(m%i==0)
                fac[cnt++]=i;
        }
        v=0;
        memset(dp,0,sizeof dp);//记得要初始化。wa了千百回。里面的初始化只初始化了部分
        for(i=0; i&lt;cnt; i++)
            dp[v][fac[i]][fac[i]]=1;
        for(i=1; i&lt;k; i++) //len
        {
            for(e=i; e&lt;=n; e++)//必须手动初始化。不然超时
                for(f=0; f&lt;cnt; f++)
                    dp[v^1][e][fac[f]]=0;
            for(j=i; j&lt;n; j++) //sum
            {
                for(p=0; p&lt;cnt; p++) //mul
                {
                    mul=fac[p];
                    if(!dp[v][j][mul])
                        continue;
                    for(q=0; q&lt;cnt; q++) //a[i]
                    {
                        tt=j+fac[q];
                        if(tt&gt;n)
                            break;
                        t=lcm[mul][fac[q]];
                        dp[v^1][tt][t]+=dp[v][j][mul];
                        dp[v^1][tt][t]%=mod;
                    }
                }
            }
            v^=1;
        }
        printf("%d\n",dp[v][n][m]);
    }
    return 0;
}
</pre>
<div style="padding-top:20px">
<p style="font-size:12px;">版权声明：本文为博主原创文章，未经博主允许不得转载。</p>
</div>
<div>
</script>
<!-- acm-hf-01 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-9460629317209118" data-ad-slot="5011774182" style="display:inline-block;width:728px;height:90px"></ins>

(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<div class="bdsharebuttonbox"><a class="bds_more" data-cmd="more" href="#"></a><a class="bds_qzone" data-cmd="qzone" href="#" title="分享到QQ空间"></a><a class="bds_tsina" data-cmd="tsina" href="#" title="分享到新浪微博"></a><a class="bds_tqq" data-cmd="tqq" href="#" title="分享到腾讯微博"></a><a class="bds_renren" data-cmd="renren" href="#" title="分享到人人网"></a><a class="bds_weixin" data-cmd="weixin" href="#" title="分享到微信"></a></div>

</div><ol id="commentlist">
<li class="comment even thread-even depth-1" id="li-comment-98016">
<article class="comment" id="comment-98016">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919518115" rel="external nofollow">新用户405603</a></span> on <a href="http://www.acmerblog.com/hdu-4427-math-magic-7440.html#comment-98016" rel="nofollow"><time datetime="2017-04-20T11:47:07+00:00" pubdate="">2017年4月20日 at 上午11:47</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>打扁哦。。长的还是好</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-98015">
<article class="comment" id="comment-98015">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919518115" rel="external nofollow">新用户405603</a></span> on <a href="http://www.acmerblog.com/hdu-4427-math-magic-7440.html#comment-98015" rel="nofollow"><time datetime="2017-04-20T11:47:07+00:00" pubdate="">2017年4月20日 at 上午11:47</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>打扁哦。。长的还是好</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-98014">
<article class="comment" id="comment-98014">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919518115" rel="external nofollow">新用户405603</a></span> on <a href="http://www.acmerblog.com/hdu-4427-math-magic-7440.html#comment-98014" rel="nofollow"><time datetime="2017-04-20T11:47:07+00:00" pubdate="">2017年4月20日 at 上午11:47</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>打扁哦。。长的还是好</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-98013">
<article class="comment" id="comment-98013">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919518115" rel="external nofollow">新用户405603</a></span> on <a href="http://www.acmerblog.com/hdu-4427-math-magic-7440.html#comment-98013" rel="nofollow"><time datetime="2017-04-20T11:47:07+00:00" pubdate="">2017年4月20日 at 上午11:47</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>打扁哦。。长的还是好</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-98012">
<article class="comment" id="comment-98012">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919518115" rel="external nofollow">新用户405603</a></span> on <a href="http://www.acmerblog.com/hdu-4427-math-magic-7440.html#comment-98012" rel="nofollow"><time datetime="2017-04-20T11:47:07+00:00" pubdate="">2017年4月20日 at 上午11:47</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>打扁哦。。长的还是好</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-98011">
<article class="comment" id="comment-98011">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919518115" rel="external nofollow">新用户405603</a></span> on <a href="http://www.acmerblog.com/hdu-4427-math-magic-7440.html#comment-98011" rel="nofollow"><time datetime="2017-04-20T11:47:07+00:00" pubdate="">2017年4月20日 at 上午11:47</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>打扁哦。。长的还是好</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-98010">
<article class="comment" id="comment-98010">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919518115" rel="external nofollow">新用户405603</a></span> on <a href="http://www.acmerblog.com/hdu-4427-math-magic-7440.html#comment-98010" rel="nofollow"><time datetime="2017-04-20T11:47:07+00:00" pubdate="">2017年4月20日 at 上午11:47</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>打扁哦。。长的还是好</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-67936">
<article class="comment" id="comment-67936">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919520811" rel="external nofollow">新用户501571</a></span> on <a href="http://www.acmerblog.com/hdu-4427-math-magic-7440.html#comment-67936" rel="nofollow"><time datetime="2017-04-11T03:57:02+00:00" pubdate="">2017年4月11日 at 上午3:57</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>不是不贵，是很便宜啊。。。。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-67935">
<article class="comment" id="comment-67935">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919520811" rel="external nofollow">新用户501571</a></span> on <a href="http://www.acmerblog.com/hdu-4427-math-magic-7440.html#comment-67935" rel="nofollow"><time datetime="2017-04-11T03:57:02+00:00" pubdate="">2017年4月11日 at 上午3:57</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>不是不贵，是很便宜啊。。。。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-67934">
<article class="comment" id="comment-67934">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919520811" rel="external nofollow">新用户501571</a></span> on <a href="http://www.acmerblog.com/hdu-4427-math-magic-7440.html#comment-67934" rel="nofollow"><time datetime="2017-04-11T03:57:02+00:00" pubdate="">2017年4月11日 at 上午3:57</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>不是不贵，是很便宜啊。。。。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-67933">
<article class="comment" id="comment-67933">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919520811" rel="external nofollow">新用户501571</a></span> on <a href="http://www.acmerblog.com/hdu-4427-math-magic-7440.html#comment-67933" rel="nofollow"><time datetime="2017-04-11T03:57:02+00:00" pubdate="">2017年4月11日 at 上午3:57</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>不是不贵，是很便宜啊。。。。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-67932">
<article class="comment" id="comment-67932">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919520811" rel="external nofollow">新用户501571</a></span> on <a href="http://www.acmerblog.com/hdu-4427-math-magic-7440.html#comment-67932" rel="nofollow"><time datetime="2017-04-11T03:57:02+00:00" pubdate="">2017年4月11日 at 上午3:57</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>不是不贵，是很便宜啊。。。。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-67931">
<article class="comment" id="comment-67931">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919520811" rel="external nofollow">新用户501571</a></span> on <a href="http://www.acmerblog.com/hdu-4427-math-magic-7440.html#comment-67931" rel="nofollow"><time datetime="2017-04-11T03:57:02+00:00" pubdate="">2017年4月11日 at 上午3:57</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>不是不贵，是很便宜啊。。。。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-67930">
<article class="comment" id="comment-67930">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919520811" rel="external nofollow">新用户501571</a></span> on <a href="http://www.acmerblog.com/hdu-4427-math-magic-7440.html#comment-67930" rel="nofollow"><time datetime="2017-04-11T03:57:02+00:00" pubdate="">2017年4月11日 at 上午3:57</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>不是不贵，是很便宜啊。。。。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-67929">
<article class="comment" id="comment-67929">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919520811" rel="external nofollow">新用户501571</a></span> on <a href="http://www.acmerblog.com/hdu-4427-math-magic-7440.html#comment-67929" rel="nofollow"><time datetime="2017-04-11T03:57:02+00:00" pubdate="">2017年4月11日 at 上午3:57</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>不是不贵，是很便宜啊。。。。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-67928">
<article class="comment" id="comment-67928">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919520811" rel="external nofollow">新用户501571</a></span> on <a href="http://www.acmerblog.com/hdu-4427-math-magic-7440.html#comment-67928" rel="nofollow"><time datetime="2017-04-11T03:57:02+00:00" pubdate="">2017年4月11日 at 上午3:57</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>不是不贵，是很便宜啊。。。。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-67927">
<article class="comment" id="comment-67927">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919520811" rel="external nofollow">新用户501571</a></span> on <a href="http://www.acmerblog.com/hdu-4427-math-magic-7440.html#comment-67927" rel="nofollow"><time datetime="2017-04-11T03:57:02+00:00" pubdate="">2017年4月11日 at 上午3:57</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>不是不贵，是很便宜啊。。。。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-67926">
<article class="comment" id="comment-67926">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919520811" rel="external nofollow">新用户501571</a></span> on <a href="http://www.acmerblog.com/hdu-4427-math-magic-7440.html#comment-67926" rel="nofollow"><time datetime="2017-04-11T03:57:02+00:00" pubdate="">2017年4月11日 at 上午3:57</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>不是不贵，是很便宜啊。。。。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
</ol>