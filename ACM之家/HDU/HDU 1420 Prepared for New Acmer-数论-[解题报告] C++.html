<div class="c-top2" id="post-55">
<div class="datetime">2013<br/>12-10</div>
<div class="tit"><h1 class="entry-title">HDU 1420 Prepared for New Acmer-数论-[解题报告] C++</h1>
<div class="entry-meta iititle2">
<span class="i2"><a href="http://www.acmerblog.com/author/admin" rel="author" title="由coder发布">coder</a></span><span class="i1"><a href="http://www.acmerblog.com/category/problemset/hdu" rel="category tag" title="查看HDU-杭电中的全部文章">HDU-杭电</a>, <a href="http://www.acmerblog.com/category/math/number-theory" rel="category tag" title="查看数论应用中的全部文章">数论应用</a></span><span class="i4">围观1082次</span><span class="i3"><a class="ds-thread-count" data-thread-key="1890" href="http://www.acmerblog.com/hdu-1420-Prepared-for-New-Acmer-1890.html#comments" title="《HDU 1420 Prepared for New Acmer-数论-[解题报告] C++》上的评论">14 条评论</a></span>
</div>
</div>
<div class="cls"></div>
</div><div class="entry-content">
<div>
<h1 class="mytitle mybigtile">Prepared for New Acmer</h1>
</div>
<div>
<p class="mytitle"> 问题描述 :</p>
</div>
<div class="mypanel">
集训进行了将近2个礼拜，这段时间以恢复性训练为主，我一直在密切关注大家的训练情况，目前为止，对大家的表现相当满意，首先是绝大部分队员的训练积极性很高，其次，都很遵守集训纪律，最后，老队员也起到了很好的带头作用，这里特别感谢为这次DP专题练习赛提供题目和测试数据的集训队队长xhd同学.
<p>特别高兴的是，跟随集训队训练的一批新队员表现非常好，进步也比较显著，特别是训练态度大大超出我的预期，我敢说，如果各位能如此坚持下去，绝对前途无量！</p>
<p>考虑到新队员还没有经过系统训练，我这里特别添加一道简单题：<br/>给定三个正整数A，B和C（A,B,C&lt;=1000000），求A^B mod C的结果.</p>
<p>希望各位都能体会到比赛中AC的快乐，绝对的量身定制，很高的待遇哟，呵呵… </p></div>
<div>
<p class="mytitle"> 输入:</p>
</div>
<div class="mypanel">
输入数据首先包含一个正整数N,表示测试实例的个数，然后是N行数据，每行包括三个正整数A,B,C。 </div>
<div>
<p class="mytitle"> 输出:</p>
</div>
<div class="mypanel">
对每个测试实例请输出计算后的结果，每个实例的输出占一行。</div>
<div>
<p class="mytitle"> 样例输入:</p>
</div>
<pre class="mypanel iopanel">
3
2 3 4
3 3 5
4 4 6</pre>
<div>
<p class="mytitle"> 样例输出:</p>
</div>
<pre class="mypanel iopanel">
0
2
4</pre>
<p> <!-- problem end --></p>
<h1 style="color:rgb(26,92,200); text-align:center; font-family:'Times New Roman'">
Prepared for New Acmer</h1>
<div><a href="http://acm.hdu.edu.cn/showproblem.php?pid=1420" target="_blank">http://acm.hdu.edu.cn/showproblem.php?pid=1420</a>
</div>
<div>
</div>
<div>蒙哥马利幂模思想：</div>
<div>
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; background-color:rgb(254,254,253); color:rgb(102,102,102); font-family:Arial">
 在幂模运算中，通常是用幂模运算转换为乘模运算。有以下两个公式：</p>
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; background-color:rgb(254,254,253); color:rgb(102,102,102); font-family:Arial">
1）a*b%n=<span style="line-height:21px; font-family:宋体">（</span><span style="line-height:21px; font-family:'Times New Roman'">a%n)*(b%n)%n</span></p>
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; background-color:rgb(254,254,253); color:rgb(102,102,102); font-family:Arial">
2）（<span style="line-height:21px; font-family:'Times New Roman'">a+b</span><span style="line-height:21px; font-family:宋体">）</span><span style="line-height:21px; font-family:'Times New Roman'">%n=</span><span style="line-height:21px; font-family:宋体">（</span><span style="line-height:21px; font-family:'Times New Roman'">a%n+b%n)%n</span></p>
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; background-color:rgb(254,254,253); color:rgb(102,102,102); font-family:Arial">
</p><p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; background-color:rgb(254,254,253); color:rgb(102,102,102); font-family:Arial">
当我们计算<span style="line-height:21px; font-family:'Times New Roman'">D=C^15%N</span><span style="line-height:21px; font-family:宋体">时，有：</span></p>
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; background-color:rgb(254,254,253); color:rgb(102,102,102); font-family:Arial">
C1=C*C%N=C^2%N</p>
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; background-color:rgb(254,254,253); color:rgb(102,102,102); font-family:Arial">
C2=C1*C%N=C^3%N</p>
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; background-color:rgb(254,254,253); color:rgb(102,102,102); font-family:Arial">
C3=C2*C2%N=C^6%N</p>
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; background-color:rgb(254,254,253); color:rgb(102,102,102); font-family:Arial">
C4=C3*C%N=C^7%N</p>
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; background-color:rgb(254,254,253); color:rgb(102,102,102); font-family:Arial">
C5=C4*C4%N=C^14%N</p>
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; background-color:rgb(254,254,253); color:rgb(102,102,102); font-family:Arial">
C6=C5*C%N=C^15%N</p>
<p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; background-color:rgb(254,254,253); color:rgb(102,102,102); font-family:Arial">
</p><p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; background-color:rgb(254,254,253); color:rgb(102,102,102); font-family:Arial">
所以，幂模运算可以转化为乘模运算。继续看，我们会发现，要求<span style="line-height:21px; font-family:'Times New Roman'">D=C^E%N,</span><span style="line-height:21px; font-family:宋体">要知道</span><span style="line-height:21px; font-family:'Times New Roman'">E</span><span style="line-height:21px; font-family:宋体">何时能整除</span><span style="line-height:21px; font-family:'Times New Roman'">2</span><span style="line-height:21px; font-family:宋体">，并不需要反复进行减一或者除二的操作，只需要验证</span><span style="line-height:21px; font-family:'Times New Roman'">E</span><span style="line-height:21px; font-family:宋体">的二进制个位是</span><span style="line-height:21px; font-family:'Times New Roman'">0</span><span style="line-height:21px; font-family:宋体">还是</span><span style="line-height:21px; font-family:'Times New Roman'">1</span><span style="line-height:21px; font-family:宋体">就行了。</span></p>
<p>本题代码：</p></div>
<pre class="brush:cpp ">#include &lt;cstdio&gt;

__int64 fun(__int64 A,__int64 B,__int64 C)
{
	__int64 k = 1;
	 A%=C;
	while(B&gt;=1)
	{
		if((B&amp;1)!=0)
			k = (k*A)%C;
        B&gt;&gt;= 1;
		A = A*A%C;
	}
	return k;
}
int main(int argc, char *argv[])
{
	int n;
	scanf("%d",&amp;n);
	__int64 A,B,C;
	while(n--)
	{
		scanf("%I64d%I64d%I64d",&amp;A,&amp;B,&amp;C);
		printf("%I64d\n",fun(A,B,C));
	}
	return 0;
}</pre>
<div>普通代码：</div>
<pre class="brush:cpp ">#include &lt;iostream&gt;
#include &lt;cstdio&gt;
#include &lt;cstring&gt;
#include &lt;algorithm&gt;
#include &lt;cmath&gt;
#include &lt;string&gt;
#include &lt;iomanip&gt;

using namespace std;
int main(int argc, char *argv[])
{
    int n;
    scanf("%d",&amp;n);
    int A,B,C;
    while(n--)
    {
        scanf("%d%d%d",&amp;A,&amp;B,&amp;C);
        __int64 ans = 1;
        for(int i = 1; i &lt;= B; i++)
        {
            ans*=A;
            ans%=C;   //注意要求余，不然很容易数据溢出；
        }
        printf("%I64d\n",ans);
    }
    return 0;
}</pre>
<p>解题报告转自：http://blog.csdn.net/i_fuqiang/article/details/8701483</p>
<div>
</script>
<!-- acm-hf-01 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-9460629317209118" data-ad-slot="5011774182" style="display:inline-block;width:728px;height:90px"></ins>

(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<div class="bdsharebuttonbox"><a class="bds_more" data-cmd="more" href="#"></a><a class="bds_qzone" data-cmd="qzone" href="#" title="分享到QQ空间"></a><a class="bds_tsina" data-cmd="tsina" href="#" title="分享到新浪微博"></a><a class="bds_tqq" data-cmd="tqq" href="#" title="分享到腾讯微博"></a><a class="bds_renren" data-cmd="renren" href="#" title="分享到人人网"></a><a class="bds_weixin" data-cmd="weixin" href="#" title="分享到微信"></a></div>

</div><ol id="commentlist">
<li class="comment even thread-even depth-1" id="li-comment-13213">
<article class="comment" id="comment-13213">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">xy7850151</a></span> on <a href="http://www.acmerblog.com/hdu-1420-Prepared-for-New-Acmer-1890.html#comment-13213" rel="nofollow"><time datetime="2015-06-07T04:54:00+00:00" pubdate="">2015年6月7日 at 上午4:54</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>问题3中，GetRightPosition()和GetLeftPosition()与STL中的upper_bound()和lower_boune()的代码实现一样吗？</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-13201">
<article class="comment" id="comment-13201">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">everos</a></span> on <a href="http://www.acmerblog.com/hdu-1420-Prepared-for-New-Acmer-1890.html#comment-13201" rel="nofollow"><time datetime="2015-03-20T12:41:34+00:00" pubdate="">2015年3月20日 at 下午12:41</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>不是有公式吗？何不直接计算</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-13208">
<article class="comment" id="comment-13208">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">stamwoo</a></span> on <a href="http://www.acmerblog.com/hdu-1420-Prepared-for-New-Acmer-1890.html#comment-13208" rel="nofollow"><time datetime="2015-03-16T22:57:41+00:00" pubdate="">2015年3月16日 at 下午10:57</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>正有此意，欢迎更多的建议~</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-13204">
<article class="comment" id="comment-13204">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">blogpick</a></span> on <a href="http://www.acmerblog.com/hdu-1420-Prepared-for-New-Acmer-1890.html#comment-13204" rel="nofollow"><time datetime="2015-02-04T19:38:19+00:00" pubdate="">2015年2月4日 at 下午7:38</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>&amp;amp;这是C语言？</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-13207">
<article class="comment" id="comment-13207">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">21435048</a></span> on <a href="http://www.acmerblog.com/hdu-1420-Prepared-for-New-Acmer-1890.html#comment-13207" rel="nofollow"><time datetime="2015-01-13T12:06:33+00:00" pubdate="">2015年1月13日 at 下午12:06</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>可以用公式。主要为了说明动态规划，如果要打表的话，这种方法也是较简单和高效的</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-13209">
<article class="comment" id="comment-13209">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">weijieut</a></span> on <a href="http://www.acmerblog.com/hdu-1420-Prepared-for-New-Acmer-1890.html#comment-13209" rel="nofollow"><time datetime="2014-11-24T02:47:33+00:00" pubdate="">2014年11月24日 at 上午2:47</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>/*<br/>
 * =====================================================================================<br/>
 *<br/>
 *       Filename:  1366.cc<br/>
 *<br/>
 *    Description:<br/>
 *<br/>
 *        Version:  1.0<br/>
 *        Created:  2014年01月06日 14时52分14秒<br/>
 *       Revision:  none<br/>
 *       Compiler:  gcc<br/>
 *<br/>
 *         Author:  Wenxian Ni (Hello World~), <a href="mailto:niwenxianq@qq.com">niwenxianq@qq.com</a><br/>
 *   Organization:  AMS/ICT<br/>
 *<br/>
 * =====================================================================================<br/>
 */</p>
<p>#include<br/>
#include </p>
<p>using namespace std;</p>
<p>int main()<br/>
{<br/>
    stack st;<br/>
    int n,i,j;<br/>
    int test;<br/>
    int a[100001];<br/>
    int b[100001];<br/>
    while(cin&gt;&gt;n)<br/>
    {<br/>
       for(i=1;i&gt;a[i];<br/>
       for(i=1;i&gt;b[i];<br/>
        //st.clear();<br/>
        while(!st.empty())<br/>
            st.pop();<br/>
        i = 1;<br/>
        j = 1;</p>
<p>        while(in)<br/>
                break;<br/>
            }<br/>
            while(!st.empty()&amp;&amp;st.top()==b[j])<br/>
            {<br/>
                st.pop();<br/>
                j++;<br/>
            }<br/>
        }<br/>
        if(st.empty())<br/>
            cout&lt;&lt;"YES"&lt;&lt;endl;<br/>
        else<br/>
            cout&lt;&lt;"NO"&lt;&lt;endl;<br/>
    }<br/>
    return 0;<br/>
}</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-13211">
<article class="comment" id="comment-13211">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">digiworm</a></span> on <a href="http://www.acmerblog.com/hdu-1420-Prepared-for-New-Acmer-1890.html#comment-13211" rel="nofollow"><time datetime="2014-11-19T06:34:07+00:00" pubdate="">2014年11月19日 at 上午6:34</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>第二个方法挺不错。NewHead代表新的头节点，通过递归找到最后一个节点之后，就把这个节点赋给NewHead，然后一直返回返回，中途这个值是没有变化的，一边返回一边把相应的指针方向颠倒，最后结束时返回新的头节点到主函数。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-13210">
<article class="comment" id="comment-13210">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">woweizhineng</a></span> on <a href="http://www.acmerblog.com/hdu-1420-Prepared-for-New-Acmer-1890.html#comment-13210" rel="nofollow"><time datetime="2014-11-14T05:48:11+00:00" pubdate="">2014年11月14日 at 上午5:48</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>第15行代码，/n/n，应该改为\n\n</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-13206">
<article class="comment" id="comment-13206">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">feifei003603</a></span> on <a href="http://www.acmerblog.com/hdu-1420-Prepared-for-New-Acmer-1890.html#comment-13206" rel="nofollow"><time datetime="2014-09-18T02:25:57+00:00" pubdate="">2014年9月18日 at 上午2:25</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>受益匪浅！！</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-13200">
<article class="comment" id="comment-13200">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">modstart</a></span> on <a href="http://www.acmerblog.com/hdu-1420-Prepared-for-New-Acmer-1890.html#comment-13200" rel="nofollow"><time datetime="2014-09-10T11:49:23+00:00" pubdate="">2014年9月10日 at 上午11:49</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>这个问题其实还可以找循环节。参照欧拉定理（也就是费马定理的推广）,a^(phi(m)) mod m = 1</p>
<p><a href="http://zh.wikipedia.org/wiki/%E6%AC%A7%E6%8B%89%E5%AE%9A%E7%90%86_(%E6%95%B0%E8%AE%BA)" rel="nofollow">http://zh.wikipedia.org/wiki/%E6%AC%A7%E6%8B%89%E5%AE%9A%E7%90%86_(%E6%95%B0%E8%AE%BA)</a></p>
<p>所以先算b mod phi(10)，这个部分都是可以约掉的。基本上O(1)的时间就出解了。当然，这也是因为这个问题模数太小的原因。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-13203">
<article class="comment" id="comment-13203">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">JcZ</a></span> on <a href="http://www.acmerblog.com/hdu-1420-Prepared-for-New-Acmer-1890.html#comment-13203" rel="nofollow"><time datetime="2014-06-25T16:08:17+00:00" pubdate="">2014年6月25日 at 下午4:08</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>不错的代码！</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-13212">
<article class="comment" id="comment-13212">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">753951</a></span> on <a href="http://www.acmerblog.com/hdu-1420-Prepared-for-New-Acmer-1890.html#comment-13212" rel="nofollow"><time datetime="2014-05-15T18:02:17+00:00" pubdate="">2014年5月15日 at 下午6:02</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>不是有公式吗？何不直接计算</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-13205">
<article class="comment" id="comment-13205">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">yupeng.bai</a></span> on <a href="http://www.acmerblog.com/hdu-1420-Prepared-for-New-Acmer-1890.html#comment-13205" rel="nofollow"><time datetime="2014-05-10T22:01:06+00:00" pubdate="">2014年5月10日 at 下午10:01</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>m /= i; 是一直在变的。参考这一篇关于质因数的http://www.acmerblog.com/integer-factorization-5124.html</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-13202">
<article class="comment" id="comment-13202">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">HenrryCheng</a></span> on <a href="http://www.acmerblog.com/hdu-1420-Prepared-for-New-Acmer-1890.html#comment-13202" rel="nofollow"><time datetime="2014-02-24T19:52:37+00:00" pubdate="">2014年2月24日 at 下午7:52</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>不错的网站，建议添加些比赛信息</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
</ol>