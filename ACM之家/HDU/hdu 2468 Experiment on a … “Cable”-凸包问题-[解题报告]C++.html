<div class="c-top2" id="post-55">
<div class="datetime">2014<br/>01-26</div>
<div class="tit"><h1 class="entry-title">hdu 2468 Experiment on a … “Cable”-凸包问题-[解题报告]C++</h1>
<div class="entry-meta iititle2">
<span class="i2"><a href="http://www.acmerblog.com/author/spiderman" rel="author" title="由蜘蛛侠发布">蜘蛛侠</a></span><span class="i1"><a href="http://www.acmerblog.com/category/problemset/hdu" rel="category tag" title="查看HDU-杭电中的全部文章">HDU-杭电</a>, <a href="http://www.acmerblog.com/category/geometry/convex" rel="category tag" title="查看凸包问题中的全部文章">凸包问题</a>, <a href="http://www.acmerblog.com/category/geometry/analytic-geometry" rel="category tag" title="查看解析几何中的全部文章">解析几何</a></span><span class="i4">围观610次</span><span class="i3"><a class="ds-thread-count" data-thread-key="3932" href="http://www.acmerblog.com/hdu-2468-experiment-on-a-cable-3932.html#comments" title="《hdu 2468 Experiment on a … “Cable”-凸包问题-[解题报告]C++》上的评论">12 条评论</a></span>
</div>
</div>
<div class="cls"></div>
</div><div class="entry-content">
<div>
<h1 class="mytitle mybigtile">Experiment on a … “Cable”</h1>
</div>
<div>
<p class="mytitle"> 问题描述 :</p>
</div>
<div class="mypanel">
The head technical person, Joey, at ACM (Association for Cyberspace Management)has just received a weird cable-like device � supposedly invented by programmers during a competition � for inspection.
<p>The device may be viewed as a straight bi-directional cable, which can be used for transmitting arbitrary number of data packages simultaneously. The speed with which each package is sent will be pre-determined by the device and furthermore may vary within a certain range; however it will remain constant throughout each package’s entire transmission process. The time it takes for a single data package with speed V to arrive at the opposite end of the cable is thus L/V, where L is the length of the cable.</p>
<p>In addition, the user may sometimes send a fixed-speed “detector” package,<br/>which is capable of reporting the number of data packages alongside itself at any time.</p>
<p>Finding this device highly amusing, Joey decides to perform an experiment on the odd “cable”. He has scheduled N packages to be sent from the left side and another M to be sent from the other side of the cable; also, he has calculated the possible speed range for each data package. With this information in hand, Joey wants to estimate the effectiveness of a detector he will send. For a detector that departs at a certain time, its effectiveness can be represented as a real number in the range [0..1], which is simply the ratio of the time during which the detector has a chance of reporting all N + M packages (explained below) to the total time.</p>
<p>If Joey sends the detector at an arbitrary time in [S, T] with speed V from the left side of the cable, what is the average effectiveness he can achieve?<br/>Note: For a detector to have a chance of reporting all N + M packages at time T<sub>0</sub>, the device must be able to schedule all data packages with such speeds so that all can share the same position with the detector at time T<sub>0</sub>. </p></div>
<div>
<p class="mytitle"> 输入:</p>
</div>
<div class="mypanel">
There are multiple test cases in the input file.<br/>Each test case starts with one integer, L ( 1 ≤ L ≤ 10<sup>6</sup>), the length of the cable.<br/>The next line contains one integer, N, the number of packages Joey will send from the<br/>left side, followed by N lines, the i<sup>th</sup> line with three real numbers, MinV<sub>i</sub>, Max<sub>Vi</sub>, and Leave<sub>i</sub>(1≤MinV<sub>i</sub>≤Max<sub>Vi</sub>), which are the minimum speed, maximum speed, and<br/>departure time for package i , respectively. Another (M + 1) lines follow, describing the<br/>packages departing from the right side. The last line of the input contains three real numbers, S, T and V (T – S ≥ 1), whose meanings are described above.<br/>The total number of packages Joey sent will be in the interval [1,5000]. It is<br/>guaranteed that the speed of any data packet, including that of the detector, will be no less than 0.01; also, all real numbers in the input will be given with at most two digits after the decimal point, and will belong to the interval: [0 , 10<sup>6</sup>].<br/>Two successive test cases are separated by a blank line. A case with L = 0<br/>indicates the end of the input file, and should not be processed by your program. </div>
<div>
<p class="mytitle"> 输出:</p>
</div>
<div class="mypanel">
There are multiple test cases in the input file.<br/>Each test case starts with one integer, L ( 1 ≤ L ≤ 10<sup>6</sup>), the length of the cable.<br/>The next line contains one integer, N, the number of packages Joey will send from the<br/>left side, followed by N lines, the i<sup>th</sup> line with three real numbers, MinV<sub>i</sub>, Max<sub>Vi</sub>, and Leave<sub>i</sub>(1≤MinV<sub>i</sub>≤Max<sub>Vi</sub>), which are the minimum speed, maximum speed, and<br/>departure time for package i , respectively. Another (M + 1) lines follow, describing the<br/>packages departing from the right side. The last line of the input contains three real numbers, S, T and V (T – S ≥ 1), whose meanings are described above.<br/>The total number of packages Joey sent will be in the interval [1,5000]. It is<br/>guaranteed that the speed of any data packet, including that of the detector, will be no less than 0.01; also, all real numbers in the input will be given with at most two digits after the decimal point, and will belong to the interval: [0 , 10<sup>6</sup>].<br/>Two successive test cases are separated by a blank line. A case with L = 0<br/>indicates the end of the input file, and should not be processed by your program.</div>
<div>
<p class="mytitle"> 样例输入:</p>
</div>
<pre class="mypanel iopanel">
5
1
5.00 10.00 2.00
2
10.05 11.50 0.05
1.68 2.00 0.01
3.00 4.00 1000
5
1
1.25 2.50 1.0
0
1.00 5.00 2.50
0</pre>
<div>
<p class="mytitle"> 样例输出:</p>
</div>
<pre class="mypanel iopanel">
Case #1: 0.00000
Case #2: 0.25000</pre>
<p> <!-- problem end --></p>
<p><img alt="" src="http://cdn.acmerblog.com/img/1390951651272.png"/></p>
<p>如图，横坐标为时间轴，纵坐标为相对起点的位移，斜率为速度。</p>
<p>设C为起点发出的包，发出时间为1，速度为1~2。</p>
<p>设D为终点发出的包，发出时间为2，速度为1~2。</p>
<p>A、B为探测器发出时间范围2~5，速度为4。</p>
<p>由图可看出，发包的时间-位移相叠的范围为可能全部抓包的范围，称有效范围。</p>
<p>在探测器的时间-位移范围内的有效范围/探测器时间-位移范围即探测器全部抓包的平均工作效率。</p>
<p>对所有速度区间、探测器时间-位移区间、起点终点区间 做半平面交，得到凸包面积除以探测器时间-位移区间面积可得解。</p>
<p>精度要求挺高的，eps注意一下。</p>
<pre class="brush:cpp ">#include&lt;stdio.h&gt;
 #include&lt;stdlib.h&gt;
 #include&lt;string.h&gt;
 #include&lt;math.h&gt;
 #include&lt;algorithm&gt;
 using namespace std;
 const int maxn = 5111;
 const double eps = 1e-12;
 const double pi = acos(-1.0);
 typedef struct{double x, y;}Point;
 int dcmp(double x) {return (x &gt; eps) - (x &lt; -eps);}
 inline double det(double x1, double y1, double x2, double y2)
 {return x1 * y2 - x2 * y1;}
 double cross(Point a, Point b, Point c)
 {return det(b.x -a.x, b.y - a.y, c.x - a.x, c.y - a.y);}
 bool EqualPoint(Point a, Point b)
 {return dcmp(a.x - b.x) == 0 &amp;&amp; dcmp(a.y - b.y) == 0;}
 typedef struct{Point s, e;double ang, d;}Line;
 Point MakePoint(double xx, double yy)
 {Point res;res.x = xx, res.y = yy;return res;}
 void SetLine(Point a, Point b, Line &amp;l)
 {
     l.s = a;
     l.e = b;
     l.ang = atan2(b.y - a.y, b.x - a.x);
     if(dcmp(a.x - b.x)) l.d = (a.x * b.y - b.x * a.y) / fabs(a.x - b.x);
     else l.d = (a.x * b.y - b.x * a.y) / fabs(a.y - b.y);
 }
 bool Parallel(const Line &amp;la, const Line &amp;lb)
 {
     return !dcmp( (la.e.x - la.s.x) * (lb.e.y - lb.s.y) -
             (la.e.y - la.s.y) * (lb.e.x - lb.s.x) );
 }
 Point CrossPoint(const Line &amp;la, const Line &amp;lb)
 {
     Point res;
     double u = cross(la.s, la.e, lb.s), v = cross(la.e, la.s, lb.e);
     res.x = (lb.s.x * v + lb.e.x * u) / (u + v);
     res.y = (lb.s.y * v + lb.e.y * u) / (u + v);
     return res;
 }
 int CompL(const void *a, const void *b)
 {
     Line la = *(Line*)a, lb = *(Line*)b;
     if(dcmp(la.ang - lb.ang)) return la.ang &gt; lb.ang ? 1 : -1;
     return la.d &gt; lb.d ? 1 : -1;
 }
 
 Line deq[maxn];
 bool HalfPanelCross(Line l[], int n, Point cp[], int &amp;m)
 {
     int i, tn;
     m = 0;
     qsort(l, n, sizeof(Line), CompL);
     for(i = tn = 1; i &lt; n; ++ i)
         if(dcmp(l[i].ang - l[i - 1].ang))
             l[tn ++] = l[i];
     n = tn;
     int front = 0, rear = 1;
     deq[0] = l[0], deq[1] = l[1];
     for(i = 2; i &lt; n; ++ i)
     {
         if(Parallel(deq[rear], deq[rear - 1]) ||
             Parallel(deq[front], deq[front + 1]))
             return false;
         while(front &lt; rear &amp;&amp; dcmp( cross(l[i].s, l[i].e,
             CrossPoint(deq[rear], deq[rear - 1])) ) &lt; 0) -- rear;
         while(front &lt; rear &amp;&amp; dcmp( cross(l[i].s, l[i].e,
             CrossPoint(deq[front], deq[front + 1])) ) &lt; 0) ++ front;
         deq[++ rear] = l[i];
     }
     while(front &lt; rear &amp;&amp; dcmp( cross(deq[front].s, deq[front].e,
         CrossPoint(deq[rear], deq[rear - 1])) ) &lt; 0) -- rear;
     while(front &lt; rear &amp;&amp; dcmp( cross(deq[rear].s, deq[rear].e,
         CrossPoint(deq[front], deq[front + 1])) ) &lt; 0) ++ front;
     if(rear &lt;= front + 1) return false;
     for(i = front; i &lt; rear; ++ i)
         cp[m ++] = CrossPoint(deq[i], deq[i + 1]);
     if(front &lt; rear + 1)
         cp[m ++] = CrossPoint(deq[front], deq[rear]);
     m = unique(cp, cp + m, EqualPoint) - cp;
     for(i = 0; i &lt; m; ++ i)
     {
         if(dcmp(cp[i].x) == 0) cp[i].x = 0;
         if(dcmp(cp[i].y) == 0) cp[i].y = 0;
     }
     return true;
 }
 double PolygonArea(Point p[], int n)
 {
     if(n &lt; 3) return 0.0;
     double s = p[0].y * (p[n - 1].x - p[1].x);
     p[n] = p[0];
     for(int i = 1; i &lt; n; ++ i)
         s += p[i].y * (p[i - 1].x - p[i + 1].x);
     return fabs(s * 0.5);
 }
 Line l[maxn &lt;&lt; 2];
 Point p[maxn &lt;&lt; 2];
 double len;
 int n, m, ltp;
 double maxv, minv, ti;
 double start, end, v;
 int main()
 {
     int ca = 0;
     while(scanf("%lf", &amp;len), dcmp(len))
     {
         ltp = 0;
         scanf("%d", &amp;n);
         while(n --)
         {
             scanf("%lf%lf%lf", &amp;minv, &amp;maxv, &amp;ti);
             SetLine(MakePoint(ti, 0), MakePoint(ti + 1, minv), l[ltp ++]);
             SetLine(MakePoint(ti + 1, maxv), MakePoint(ti, 0), l[ltp ++]);
         }
         scanf("%d", &amp;m);
         while(m --)
         {
             scanf("%lf%lf%lf", &amp;minv, &amp;maxv, &amp;ti);
             SetLine(MakePoint(ti + 1, len - minv), MakePoint(ti, len), l[ltp ++]);
             SetLine(MakePoint(ti, len), MakePoint(ti + 1, len - maxv), l[ltp ++]);
         }
         scanf("%lf%lf%lf", &amp;start, &amp;end, &amp;v);
         printf("Case #%d: ", ++ ca);
         SetLine(MakePoint(0, 0), MakePoint(1, 0), l[ltp ++]);
         SetLine(MakePoint(1, len), MakePoint(0, len), l[ltp ++]);
         SetLine(MakePoint(start + 1, v), MakePoint(start, 0), l[ltp ++]);
         SetLine(MakePoint(end, 0), MakePoint(end + 1, v), l[ltp ++]);
         if(!HalfPanelCross(l, ltp, p, n)){printf("0.00000\n"); continue;}
         printf("%.5f\n", PolygonArea(p, n) / (end - start) / len + eps);
     }
     return 0;
 }</pre>
<p>解题转自：http://www.cnblogs.com/CSGrandeur/archive/2012/09/10/2679452.html</p>
<div>
</script>
<!-- acm-hf-01 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-9460629317209118" data-ad-slot="5011774182" style="display:inline-block;width:728px;height:90px"></ins>

(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<div class="bdsharebuttonbox"><a class="bds_more" data-cmd="more" href="#"></a><a class="bds_qzone" data-cmd="qzone" href="#" title="分享到QQ空间"></a><a class="bds_tsina" data-cmd="tsina" href="#" title="分享到新浪微博"></a><a class="bds_tqq" data-cmd="tqq" href="#" title="分享到腾讯微博"></a><a class="bds_renren" data-cmd="renren" href="#" title="分享到人人网"></a><a class="bds_weixin" data-cmd="weixin" href="#" title="分享到微信"></a></div>

</div><ol id="commentlist">
<li class="comment even thread-even depth-1" id="li-comment-62597">
<article class="comment" id="comment-62597">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">mr-zhang2011</a></span> on <a href="http://www.acmerblog.com/hdu-2468-experiment-on-a-cable-3932.html#comment-62597" rel="nofollow"><time datetime="2015-06-06T12:30:23+00:00" pubdate="">2015年6月6日 at 下午12:30</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>都是一些基础题啊</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-45344">
<article class="comment" id="comment-45344">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">soasipray</a></span> on <a href="http://www.acmerblog.com/hdu-2468-experiment-on-a-cable-3932.html#comment-45344" rel="nofollow"><time datetime="2015-04-09T17:12:07+00:00" pubdate="">2015年4月9日 at 下午5:12</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>分析的很专业！</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-45347">
<article class="comment" id="comment-45347">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">Aifan</a></span> on <a href="http://www.acmerblog.com/hdu-2468-experiment-on-a-cable-3932.html#comment-45347" rel="nofollow"><time datetime="2014-12-19T01:23:25+00:00" pubdate="">2014年12月19日 at 上午1:23</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>刚开始学，非常好</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-45343">
<article class="comment" id="comment-45343">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">woweizhineng</a></span> on <a href="http://www.acmerblog.com/hdu-2468-experiment-on-a-cable-3932.html#comment-45343" rel="nofollow"><time datetime="2014-12-04T03:37:09+00:00" pubdate="">2014年12月4日 at 上午3:37</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>很好，找的就是这一题</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-45339">
<article class="comment" id="comment-45339">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">leowww</a></span> on <a href="http://www.acmerblog.com/hdu-2468-experiment-on-a-cable-3932.html#comment-45339" rel="nofollow"><time datetime="2014-09-28T10:39:41+00:00" pubdate="">2014年9月28日 at 上午10:39</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>什么破题，题意好难懂啊</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-56860">
<article class="comment" id="comment-56860">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">nsoi_onion</a></span> on <a href="http://www.acmerblog.com/hdu-2468-experiment-on-a-cable-3932.html#comment-56860" rel="nofollow"><time datetime="2014-09-01T15:26:39+00:00" pubdate="">2014年9月1日 at 下午3:26</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>有一点问题。。后面动态规划的程序中<br/>
int dp[n+1][W+1];<br/>
会报错  提示表达式必须含有常量值。该怎么修改呢。。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-45341">
<article class="comment" id="comment-45341">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">tangxiansheng</a></span> on <a href="http://www.acmerblog.com/hdu-2468-experiment-on-a-cable-3932.html#comment-45341" rel="nofollow"><time datetime="2014-07-25T17:49:45+00:00" pubdate="">2014年7月25日 at 下午5:49</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>还真是，i7的cpu跑了3秒</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-45346">
<article class="comment" id="comment-45346">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">Rocky</a></span> on <a href="http://www.acmerblog.com/hdu-2468-experiment-on-a-cable-3932.html#comment-45346" rel="nofollow"><time datetime="2014-07-05T20:28:10+00:00" pubdate="">2014年7月5日 at 下午8:28</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>27行 minStack.push(minValue); 去掉就对了</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-22221">
<article class="comment" id="comment-22221">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">chengleisheng</a></span> on <a href="http://www.acmerblog.com/hdu-2468-experiment-on-a-cable-3932.html#comment-22221" rel="nofollow"><time datetime="2014-05-03T09:48:14+00:00" pubdate="">2014年5月3日 at 上午9:48</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>yeah, This is very tricky. If you use Cpp,you need more code</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-45340">
<article class="comment" id="comment-45340">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">ktcer</a></span> on <a href="http://www.acmerblog.com/hdu-2468-experiment-on-a-cable-3932.html#comment-45340" rel="nofollow"><time datetime="2014-04-09T15:58:20+00:00" pubdate="">2014年4月9日 at 下午3:58</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>是O(m+n)，不小心打错了</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-45342">
<article class="comment" id="comment-45342">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">jixiangniao993</a></span> on <a href="http://www.acmerblog.com/hdu-2468-experiment-on-a-cable-3932.html#comment-45342" rel="nofollow"><time datetime="2014-03-16T22:32:30+00:00" pubdate="">2014年3月16日 at 下午10:32</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>先从简单的做起，归并排序，二叉树相关的遍历等</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-45345">
<article class="comment" id="comment-45345">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">TimeFight</a></span> on <a href="http://www.acmerblog.com/hdu-2468-experiment-on-a-cable-3932.html#comment-45345" rel="nofollow"><time datetime="2014-03-02T16:34:39+00:00" pubdate="">2014年3月2日 at 下午4:34</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>Java真是解决大数的利器</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
</ol>