<div class="c-top2" id="post-55">
<div class="datetime">2015<br/>05-23</div>
<div class="tit"><h1 class="entry-title">HDU 4284-Travel-动态规划-[解题报告]HOJ</h1>
<div class="entry-meta iititle2">
<span class="i2"><a href="http://www.acmerblog.com/author/spiderman" rel="author" title="由蜘蛛侠发布">蜘蛛侠</a></span><span class="i1"><a href="http://www.acmerblog.com/category/problemset/hdu" rel="category tag" title="查看HDU-杭电中的全部文章">HDU-杭电</a>, <a href="http://www.acmerblog.com/category/dp2/state-dp" rel="category tag" title="查看状态DP中的全部文章">状态DP</a>, <a href="http://www.acmerblog.com/category/dp2/line-dp" rel="category tag" title="查看线性DP中的全部文章">线性DP</a></span><span class="i4">围观161次</span><span class="i3"><a class="ds-thread-count" data-thread-key="7297" href="http://www.acmerblog.com/hdu-4284-travel-7297.html#comments" title="《HDU 4284-Travel-动态规划-[解题报告]HOJ》上的评论">2 条评论</a></span>
</div>
</div>
<div class="cls"></div>
</div><div class="entry-content">
<div>
<h1 class="mytitle mybigtile">Travel</h1>
</div>
<div>
<p class="mytitle"> 问题描述 :</p>
</div>
<div class="mypanel">
　　PP loves travel. Her dream is to travel around country A which consists of N cities and M roads connecting them. PP has measured the money each road costs. But she still has one more problem: she doesn’t have enough money. So she must work during her travel. She has chosen some cities that she must visit and stay to work. In City_i she can do some work to earn Ci money, but before that she has to pay Di money to get the work license. She can’t work in that city if she doesn’t get the license but she can go through the city without license. In each chosen city, PP can only earn money and get license once. In other cities, she will not earn or pay money so that you can consider Ci=Di=0. Please help her make a plan to visit all chosen cities and get license in all of them under all rules above.<br/>　　PP lives in city 1, and she will start her journey from city 1. and end her journey at city 1 too. </div>
<div>
<p class="mytitle"> 输入:</p>
</div>
<div class="mypanel">
　　The first line of input consists of one integer T which means T cases will follow.<br/>　　Then follows T cases, each of which begins with three integers: the number of cities N (N &lt;= 100) , number of roads M (M &lt;= 5000) and her initiative money Money (Money &lt;= 10^5) .<br/>　　Then follows M lines. Each contains three integers u, v, w, which means there is a road between city u and city v and the cost is w. u and v are between 1 and N (inclusive), w &lt;= 10^5.<br/>　　Then follows a integer H (H &lt;= 15) , which is the number of chosen cities.<br/>　　Then follows H lines. Each contains three integers Num, Ci, Di, which means the i_th chosen city number and Ci, Di described above.(Ci, Di &lt;= 10^5) </div>
<div>
<p class="mytitle"> 输出:</p>
</div>
<div class="mypanel">
　　The first line of input consists of one integer T which means T cases will follow.<br/>　　Then follows T cases, each of which begins with three integers: the number of cities N (N &lt;= 100) , number of roads M (M &lt;= 5000) and her initiative money Money (Money &lt;= 10^5) .<br/>　　Then follows M lines. Each contains three integers u, v, w, which means there is a road between city u and city v and the cost is w. u and v are between 1 and N (inclusive), w &lt;= 10^5.<br/>　　Then follows a integer H (H &lt;= 15) , which is the number of chosen cities.<br/>　　Then follows H lines. Each contains three integers Num, Ci, Di, which means the i_th chosen city number and Ci, Di described above.(Ci, Di &lt;= 10^5)</div>
<div>
<p class="mytitle"> 样例输入:</p>
</div>
<pre class="mypanel iopanel">
2
4 5 10
1 2 1
2 3 2
1 3 2
1 4 1
3 4 2
3
1 8 5
2 5 2
3 10 1
2 1 100
1 2 10000
1
2 100000 1</pre>
<div>
<p class="mytitle"> 样例输出:</p>
</div>
<pre class="mypanel iopanel">
YES
NO</pre>
<p> <!-- problem end --></p>
<p><span style="font-family:Arial; font-size:18px; line-height:26px; text-align:left">转载请注明出处，谢谢</span><a style="color:rgb(202,0,0); text-decoration:none; font-family:Arial; font-size:18px; line-height:26px; text-align:left"></a><a style="color:rgb(202,0,0); text-decoration:none; font-family:Arial; font-size:18px; line-height:26px; text-align:left">http://blog.csdn.net/acm_cxlove/article/details/7854526</a><span style="font-family:Arial; font-size:18px; line-height:26px; text-align:left">      <br/>
 by—cxlove </span></p>
<p><span style="font-family:Arial; font-size:18px; line-height:26px; text-align:left">题目：给出一些城市，从1出发，旅游一圈回到1，由于花费可能不够，所以选择一些城市打工，打工之前需要花费d买一个证，工资为c。选中的城市必须去工作一次，而且只能工作一次，问能不能完成旅行</span></p>
<p><span style="font-family:Arial; font-size:18px; line-height:26px; text-align:left"><a>http://acm.hdu.edu.cn/showproblem.php?pid=4284</a> <br/>
</span></p>
<p><span style="font-family:Arial; font-size:18px; line-height:26px; text-align:left">比赛的时候，卡了很久，当时队友用SPFA+状态DP+堆栈写的，主要是把一点考虑错了</span></p>
<p><span style="font-family:Arial; font-size:18px; line-height:26px; text-align:left">当时把C和D合并了，其实是不对的，因为首先是要购买证，然后才能工作，否则拿不到工资。</span></p>
<p><span style="font-family:Arial; font-size:18px; line-height:26px; text-align:left">也就是先要判断够不够买证的钱D，然后才能拿到工资。</span></p>
<p><span style="font-family:Arial; font-size:18px; line-height:26px; text-align:left">跪舔，先用Floyd预处理最短路n^3，然后状态DP，h*h*2^h，4S+,效率很低的做法</span></p>
<p><span style="font-family:Arial; font-size:18px; line-height:26px; text-align:left">可以用队列，堆栈加速</span></p>
<p><span style="font-family:Arial; font-size:18px; line-height:26px; text-align:left"></span></p>
<pre class="brush:cpp" name="code">#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;map&gt;
#include&lt;cstring&gt;
#define inf 1&lt;&lt;28
#define N 105
#define Min(a,b) ((a)&lt;(b)?(a):(b))
#define Max(a,b) ((a)&gt;(b)?(a):(b))
using namespace std;
int n,m,money,h;
int path[N][N];
int dp[20][1&lt;&lt;16];
int work[20],c[20],d[20];
int main(){
	int t;
	scanf("%d",&amp;t);
	while(t--){
		scanf("%d%d%d",&amp;n,&amp;m,&amp;money);
		for(int i=0;i&lt;n;i++){
			for(int j=0;j&lt;n;j++)
				path[i][j]=inf;
			path[i][i]=0;
		}
		for(int i=0;i&lt;m;i++){
			int u,v,w;
			scanf("%d%d%d",&amp;u,&amp;v,&amp;w);
			u--;v--;
			path[u][v]=Min(path[u][v],w);
			path[v][u]=path[u][v];
		}
		//Floyd预处理
		for(int k=0;k&lt;n;k++)
			for(int i=0;i&lt;n;i++)
				for(int j=0;j&lt;n;j++)
					if(i!=k&amp;&amp;i!=j&amp;&amp;j!=k)
						path[i][j]=Min(path[i][k]+path[k][j],path[i][j]);
		scanf("%d",&amp;h);
		int pos=-1;
		for(int i=0;i&lt;h;i++){
			scanf("%d%d%d",&amp;work[i],&amp;c[i],&amp;d[i]);
			work[i]--;
			if(work[i]==0) pos=i;   //说明必需点中包含了起点1
		}
		//如果不包含，我们加入冗余点，便于后面处理，c和d都为0
		if(pos==-1){
			work[h]=0;c[h]=0;d[h]=0;
			pos=h++;
		}
		memset(dp,-1,sizeof(dp));
		if(money-d[pos]&gt;=0) dp[pos][1&lt;&lt;pos]=money-d[pos]+c[pos];dp[pos][0]=money;
		for(int i=0;i&lt;(1&lt;&lt;h);i++){
			for(int j=0;j&lt;h;j++){
				if(dp[j][i]==-1) continue;
				for(int k=0;k&lt;h;k++){
					if(k==j||((1&lt;&lt;k)&amp;i)) continue;
					//钱够在两个城市之间移动，而且够买证
					if(dp[j][i]&gt;=path[work[j]][work[k]]+d[k])
						dp[k][i|(1&lt;&lt;k)]=Max(dp[k][i|(1&lt;&lt;k)],dp[j][i]-path[work[j]][work[k]]-d[k]+c[k]);
				}
			}
		}
		bool ans=false;
		for(int i=0;i&lt;h;i++)
			//最后判断能不能返回起点
			if(dp[i][(1&lt;&lt;h)-1]&gt;=path[work[i]][0]){
				ans=true;
				break;
			}
		puts(ans?"YES":"NO");
	}
	return 0;
}
			</pre>
<div style="padding-top:20px">
<p style="font-size:12px;">版权声明：本文为博主原创文章，未经博主允许不得转载。</p>
</div>
<p>参考：http://blog.csdn.net/acm_cxlove/article/details/7963286</p>
<div>
</script>
<!-- acm-hf-01 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-9460629317209118" data-ad-slot="5011774182" style="display:inline-block;width:728px;height:90px"></ins>

(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<div class="bdsharebuttonbox"><a class="bds_more" data-cmd="more" href="#"></a><a class="bds_qzone" data-cmd="qzone" href="#" title="分享到QQ空间"></a><a class="bds_tsina" data-cmd="tsina" href="#" title="分享到新浪微博"></a><a class="bds_tqq" data-cmd="tqq" href="#" title="分享到腾讯微博"></a><a class="bds_renren" data-cmd="renren" href="#" title="分享到人人网"></a><a class="bds_weixin" data-cmd="weixin" href="#" title="分享到微信"></a></div>

</div><ol id="commentlist">
<li class="comment even thread-even depth-1" id="li-comment-98926">
<article class="comment" id="comment-98926">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919466781" rel="external nofollow">新用户060502</a></span> on <a href="http://www.acmerblog.com/hdu-4284-travel-7297.html#comment-98926" rel="nofollow"><time datetime="2017-04-20T14:27:52+00:00" pubdate="">2017年4月20日 at 下午2:27</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>我看到了老谋子</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-68630">
<article class="comment" id="comment-68630">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919463869" rel="external nofollow">新用户778453</a></span> on <a href="http://www.acmerblog.com/hdu-4284-travel-7297.html#comment-68630" rel="nofollow"><time datetime="2017-04-11T07:10:17+00:00" pubdate="">2017年4月11日 at 上午7:10</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>民风淳朴，社会和谐。看的黄瓜一紧</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
</ol>