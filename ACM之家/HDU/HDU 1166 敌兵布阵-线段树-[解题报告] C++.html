<div class="c-top2" id="post-55">
<div class="datetime">2013<br/>12-03</div>
<div class="tit"><h1 class="entry-title">HDU 1166 敌兵布阵-线段树-[解题报告] C++</h1>
<div class="entry-meta iititle2">
<span class="i2"><a href="http://www.acmerblog.com/author/admin" rel="author" title="由coder发布">coder</a></span><span class="i1"><a href="http://www.acmerblog.com/category/problemset/hdu" rel="category tag" title="查看HDU-杭电中的全部文章">HDU-杭电</a>, <a href="http://www.acmerblog.com/category/data-struct/trees" rel="category tag" title="查看树形结构中的全部文章">树形结构</a>, <a href="http://www.acmerblog.com/category/data-struct/linear" rel="category tag" title="查看线性结构中的全部文章">线性结构</a></span><span class="i4">围观1024次</span><span class="i3"><a class="ds-thread-count" data-thread-key="1506" href="http://www.acmerblog.com/hdu-1166-%E6%95%8C%E5%85%B5%E5%B8%83%E9%98%B5-1506.html#comments" title="《HDU 1166 敌兵布阵-线段树-[解题报告] C++》上的评论">11 条评论</a></span>
</div>
</div>
<div class="cls"></div>
</div><div class="entry-content">
<div>
<h1 class="mytitle mybigtile">敌兵布阵</h1>
</div>
<div>
<p class="mytitle"> 问题描述 :</p>
</div>
<div class="mypanel">
C国的死对头A国这段时间正在进行军事演习，所以C国间谍头子Derek和他手下Tidy又开始忙乎了。A国在海岸线沿直线布置了N个工兵营地,Derek和Tidy的任务就是要监视这些工兵营地的活动情况。由于采取了某种先进的监测手段，所以每个工兵营地的人数C国都掌握的一清二楚,每个工兵营地的人数都有可能发生变动，可能增加或减少若干人手,但这些都逃不过C国的监视。<br/>中央情报局要研究敌人究竟演习什么战术,所以Tidy要随时向Derek汇报某一段连续的工兵营地一共有多少人,例如Derek问:“Tidy,马上汇报第3个营地到第10个营地共有多少人!”Tidy就要马上开始计算这一段的总人数并汇报。但敌兵营地的人数经常变动，而Derek每次询问的段都不一样，所以Tidy不得不每次都一个一个营地的去数，很快就精疲力尽了，Derek对Tidy的计算速度越来越不满:"你个死肥仔，算得这么慢，我炒你鱿鱼!”Tidy想：“你自己来算算看，这可真是一项累人的工作!我恨不得你炒我鱿鱼呢!”无奈之下，Tidy只好打电话向计算机专家Windbreaker求救,Windbreaker说：“死肥仔，叫你平时做多点acm题和看多点算法书，现在尝到苦果了吧!”Tidy说："我知错了。。。"但Windbreaker已经挂掉电话了。Tidy很苦恼，这么算他真的会崩溃的，聪明的读者，你能写个程序帮他完成这项工作吗？不过如果你的程序效率不够高的话，Tidy还是会受到Derek的责骂的. </div>
<div>
<p class="mytitle"> 输入:</p>
</div>
<div class="mypanel">
第一行一个整数T，表示有T组数据。<br/>每组数据第一行一个正整数N（N&lt;=50000）,表示敌人有N个工兵营地，接下来有N个正整数,第i个正整数ai代表第i个工兵营地里开始时有ai个人（1&lt;=ai&lt;=50）。<br/>接下来每行有一条命令，命令有4种形式：<br/>(1) Add  i j,i和j为正整数,表示第i个营地增加j个人（j不超过30）<br/>(2)Sub i j  ,i和j为正整数,表示第i个营地减少j个人（j不超过30）;<br/>(3)Query i j ,i和j为正整数,i&lt;=j，表示询问第i到第j个营地的总人数;<br/>(4)End  表示结束，这条命令在每组数据最后出现;<br/>  每组数据最多有40000条命令 </div>
<div>
<p class="mytitle"> 输出:</p>
</div>
<div class="mypanel">
对第i组数据,首先输出“Case i:”和回车,<br/>对于每个Query询问，输出一个整数并回车,表示询问的段中的总人数,这个数保持在int以内。</div>
<div>
<p class="mytitle"> 样例输入:</p>
</div>
<pre class="mypanel iopanel">
1
10
1 2 3 4 5 6 7 8 9 10
Query 1 3
Add 3 6
Query 2 7
Sub 10 2
Add 6 3
Query 3 10
End </pre>
<div>
<p class="mytitle"> 样例输出:</p>
</div>
<pre class="mypanel iopanel">
Case 1:
6
33
59</pre>
<p><!-- problem end --></p>
<p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=1166">http://acm.hdu.edu.cn/showproblem.php?pid=1166</a></p>
<p>换了一种线段树风格风格,测模板</p>
<pre class="brush:cpp ">/********************* Template ************************/
#include &lt;set&gt;
#include &lt;map&gt;
#include &lt;list&gt;
#include &lt;cmath&gt;
#include &lt;ctime&gt;
#include &lt;deque&gt;
#include &lt;queue&gt;
#include &lt;stack&gt;
#include &lt;bitset&gt;
#include &lt;cstdio&gt;
#include &lt;string&gt;
#include &lt;vector&gt;
#include &lt;cassert&gt;
#include &lt;cstdlib&gt;
#include &lt;cstring&gt;
#include &lt;sstream&gt;
#include &lt;fstream&gt;
#include &lt;numeric&gt;
#include &lt;iomanip&gt;
#include &lt;iostream&gt;
#include &lt;algorithm&gt;
#include &lt;functional&gt;
using namespace std;
#define BUG         cout&lt;&lt;" BUG! "&lt;&lt;endl;
#define LINE        cout&lt;&lt;" ------------------ "&lt;&lt;endl;
#define FIN         freopen("in.txt","r",stdin);
#define lson l,m,rt&lt;&lt;1
#define rson m+1,r,rt&lt;&lt;1|1
#pragma comment     (linker,"/STACK:102400000,102400000")
template&lt;class T&gt; inline T L(T a)       {return (a &lt;&lt; 1);}
template&lt;class T&gt; inline T R(T a)       {return (a &lt;&lt; 1 | 1);}
template&lt;class T&gt; inline T lowbit(T a)  {return (a &amp; -a);}
template&lt;class T&gt; inline T Mid(T a,T b) {return ((a + b) &gt;&gt; 1);}
template&lt;class T&gt; inline T gcd(T a,T b) {return b ? gcd(b,a%b) : a;}
template&lt;class T&gt; inline T lcm(T a,T b) {return a / gcd(a,b) * b;}
template&lt;class T&gt; inline T Min(T a,T b) {return a &lt; b ? a : b;}
template&lt;class T&gt; inline T Max(T a,T b) {return a &gt; b ? a : b;}
template&lt;class T&gt; inline T Min(T a,T b,T c)     {return min(min(a,b),c);}
template&lt;class T&gt; inline T Max(T a,T b,T c)     {return max(max(a,b),c);}
template&lt;class T&gt; inline T Min(T a,T b,T c,T d) {return min(min(a,b),min(c,d));}
template&lt;class T&gt; inline T Max(T a,T b,T c,T d) {return max(max(a,b),max(c,d));}
template&lt;class T&gt; inline void mem(T &amp;a,int b)   {memset(a,b,sizeof(a));}
template&lt;class T&gt; inline T exGCD(T a, T b, T &amp;x, T &amp;y){ //
    if(!b) return x = 1,y = 0,a;
    T res = exGCD(b,a%b,x,y),tmp = x;
    x = y,y = tmp - (a / b) * y;
    return res;
}
typedef long long LL;    typedef unsigned long long ULL;
//typedef __int64 LL;      typedef unsigned __int64 ULL;
const LL LINF   = 1LL &lt;&lt; 60;
const int MOD   = 1000000007;
const int INF   = 0x7fffffff;
const int MAXN  = (int)1e5+50;
const double EPS    = 1e-8;
const double DINF   = 1e15;
const double PI     = acos(-1.0);

/*********************   By  F   *********************/
int sum[MAXN&lt;&lt;2];
int ret;
void pushup(int rt){
    sum[rt] = sum[L(rt)] + sum[R(rt)];
}
void build(int l,int r,int rt){
    if(l == r) {
        scanf("%d",&amp;sum[rt]);
        return;
    }
    int m = Mid(l,r);
    build(lson);
    build(rson);
    pushup(rt);
}
void update(int a,int val,int l,int r,int rt){
    if(l == r){
        sum[rt] += val;
        return ;
    }
    int m = Mid(l,r);
    if(a &lt;= m) update(a,val,lson);
    else update(a,val,rson);
    pushup(rt);
}
int query(int L,int R,int l,int r,int rt){
    if(L &lt;= l &amp;&amp; r &lt;= R) return sum[rt];
    int m = Mid(l,r);
    int ret = 0;
    if(L &lt;= m) ret+=query(L,R,lson);
    if(R &gt; m) ret+=query(L,R,rson);
    return ret;
}
int main(){
    //FIN;
    int T,n,i,j;
    char a[20];
    scanf("%d",&amp;T);
    for(int ca = 1 ; ca &lt;= T; ca++){
        scanf("%d",&amp;n);
        printf("Case %d:\n",ca);
        build(1,n,1);
        while(~scanf("%s",a) &amp;&amp; a[0] != 'E'){
            scanf("%d%d",&amp;i,&amp;j);
            if(a[0] == 'Q') printf("%d\n",query(i,j,1,n,1));
            if(a[0] == 'A') update(i,j,1,n,1);
            if(a[0] == 'S') update(i,-j,1,n,1);
        }
    }
    return 0;
}</pre>
<p> </p>
<div>
</script>
<!-- acm-hf-01 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-9460629317209118" data-ad-slot="5011774182" style="display:inline-block;width:728px;height:90px"></ins>

(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<div class="bdsharebuttonbox"><a class="bds_more" data-cmd="more" href="#"></a><a class="bds_qzone" data-cmd="qzone" href="#" title="分享到QQ空间"></a><a class="bds_tsina" data-cmd="tsina" href="#" title="分享到新浪微博"></a><a class="bds_tqq" data-cmd="tqq" href="#" title="分享到腾讯微博"></a><a class="bds_renren" data-cmd="renren" href="#" title="分享到人人网"></a><a class="bds_weixin" data-cmd="weixin" href="#" title="分享到微信"></a></div>

</div><ol id="commentlist">
<li class="comment even thread-even depth-1" id="li-comment-40113">
<article class="comment" id="comment-40113">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">kate19930802</a></span> on <a href="http://www.acmerblog.com/hdu-1166-%E6%95%8C%E5%85%B5%E5%B8%83%E9%98%B5-1506.html#comment-40113" rel="nofollow"><time datetime="2015-07-07T11:48:03+00:00" pubdate="">2015年7月7日 at 上午11:48</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>分析的很专业！</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-11387">
<article class="comment" id="comment-11387">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">wuzirui</a></span> on <a href="http://www.acmerblog.com/hdu-1166-%E6%95%8C%E5%85%B5%E5%B8%83%E9%98%B5-1506.html#comment-11387" rel="nofollow"><time datetime="2015-06-18T04:00:11+00:00" pubdate="">2015年6月18日 at 上午4:00</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>不错</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-11386">
<article class="comment" id="comment-11386">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">lsdtc1225</a></span> on <a href="http://www.acmerblog.com/hdu-1166-%E6%95%8C%E5%85%B5%E5%B8%83%E9%98%B5-1506.html#comment-11386" rel="nofollow"><time datetime="2015-04-24T12:16:54+00:00" pubdate="">2015年4月24日 at 下午12:16</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>顺利测试通过了，多谢</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-3217">
<article class="comment" id="comment-3217">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn">花香淡了</span> on <a href="http://www.acmerblog.com/hdu-1166-%E6%95%8C%E5%85%B5%E5%B8%83%E9%98%B5-1506.html#comment-3217" rel="nofollow"><time datetime="2015-04-14T18:49:25+00:00" pubdate="">2015年4月14日 at 下午6:49</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>这是什么鬼，怎么多头文件</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-54348">
<article class="comment" id="comment-54348">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">Ding Qiangyuan</a></span> on <a href="http://www.acmerblog.com/hdu-1166-%E6%95%8C%E5%85%B5%E5%B8%83%E9%98%B5-1506.html#comment-54348" rel="nofollow"><time datetime="2014-11-20T01:31:40+00:00" pubdate="">2014年11月20日 at 上午1:31</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>我又来学习了</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-40112">
<article class="comment" id="comment-40112">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">zhenghao</a></span> on <a href="http://www.acmerblog.com/hdu-1166-%E6%95%8C%E5%85%B5%E5%B8%83%E9%98%B5-1506.html#comment-40112" rel="nofollow"><time datetime="2014-10-16T12:58:08+00:00" pubdate="">2014年10月16日 at 下午12:58</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>因为是要把从字符串s的start位到当前位在hash中重置，修改提交后能accept，但是不修改居然也能accept</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-40111">
<article class="comment" id="comment-40111">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">admin</a></span> on <a href="http://www.acmerblog.com/hdu-1166-%E6%95%8C%E5%85%B5%E5%B8%83%E9%98%B5-1506.html#comment-40111" rel="nofollow"><time datetime="2014-08-31T17:01:29+00:00" pubdate="">2014年8月31日 at 下午5:01</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>很好，解决了</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-40114">
<article class="comment" id="comment-40114">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">dreams</a></span> on <a href="http://www.acmerblog.com/hdu-1166-%E6%95%8C%E5%85%B5%E5%B8%83%E9%98%B5-1506.html#comment-40114" rel="nofollow"><time datetime="2014-08-04T02:54:09+00:00" pubdate="">2014年8月4日 at 上午2:54</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>第一种方法怎么会是O(log(m+n))呢？没有二分的话直接遍历应该就是O(m+n)吧？</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-54347">
<article class="comment" id="comment-54347">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">jamoeba</a></span> on <a href="http://www.acmerblog.com/hdu-1166-%E6%95%8C%E5%85%B5%E5%B8%83%E9%98%B5-1506.html#comment-54347" rel="nofollow"><time datetime="2014-06-26T20:46:21+00:00" pubdate="">2014年6月26日 at 下午8:46</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>程序是错的吧，明显没有判断不和该节点相邻的其他节点是否相互相邻</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-40115">
<article class="comment" id="comment-40115">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">jandk</a></span> on <a href="http://www.acmerblog.com/hdu-1166-%E6%95%8C%E5%85%B5%E5%B8%83%E9%98%B5-1506.html#comment-40115" rel="nofollow"><time datetime="2014-03-03T22:41:58+00:00" pubdate="">2014年3月3日 at 下午10:41</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>為甚麼fln*20+0.5f</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-40110">
<article class="comment" id="comment-40110">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">admin</a></span> on <a href="http://www.acmerblog.com/hdu-1166-%E6%95%8C%E5%85%B5%E5%B8%83%E9%98%B5-1506.html#comment-40110" rel="nofollow"><time datetime="2014-01-26T02:27:34+00:00" pubdate="">2014年1月26日 at 上午2:27</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>因为是要把从字符串s的start位到当前位在hash中重置，修改提交后能accept，但是不修改居然也能accept</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
</ol>