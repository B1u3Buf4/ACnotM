<div class="c-top2" id="post-55">
<div class="datetime">2015<br/>07-16</div>
<div class="tit"><h1 class="entry-title">HDU 4428-Polaris of Pandora-线段树-[解题报告]HOJ</h1>
<div class="entry-meta iititle2">
<span class="i2"><a href="http://www.acmerblog.com/author/spiderman" rel="author" title="由蜘蛛侠发布">蜘蛛侠</a></span><span class="i1"><a href="http://www.acmerblog.com/category/problemset/hdu" rel="category tag" title="查看HDU-杭电中的全部文章">HDU-杭电</a>, <a href="http://www.acmerblog.com/category/data-struct/trees" rel="category tag" title="查看树形结构中的全部文章">树形结构</a></span><span class="i4">围观121次</span><span class="i3"><a class="ds-thread-count" data-thread-key="7441" href="http://www.acmerblog.com/hdu-4428-polaris-of-pandora-7441.html#comments" title="《HDU 4428-Polaris of Pandora-线段树-[解题报告]HOJ》上的评论">7 条评论</a></span>
</div>
</div>
<div class="cls"></div>
</div><div class="entry-content">
<div>
<h1 class="mytitle mybigtile">Polaris of Pandora</h1>
</div>
<div>
<p class="mytitle"> 问题描述 :</p>
</div>
<div class="mypanel">
Polaris is a star. It is the most magnificent scene in the sky, and the most important navigation star of planet Pandora<sup>[1]</sup>. People live in Pandora call themselves as "Na’vi"<sup>[2]</sup>, and they all love to fly in the sky with their ikran<sup>[3]</sup>. When they are flying in the sky, they use Polaris to navigate. Polaris could be used to navigate because that it is always staying in the straight line linking the North Pole and the South Pole of Pandora. That straight line could also be called as "axis of Pandora", and Polaris stays on the North Pole side.<br/>         Polaris is too far away from Pandora, so in every place near Pandora, light from Polaris could be regarded as parallel to axis of Pandora. Now several Na’vi ikran riders are flying in the sky of Pandora, they want to know the percentage of their whole flying distance that Polaris is visible. Polaris’s light is quite bright, so Polaris is visible even when it is just on the skyline.<br/>         To simplify the problem, Na’vi riders assume that Pandora is a perfect sphere, which have an R radius. A rider starts flying from a point on the Pandora’s surface and lands at another point, the flying height is given as H. Ikran is so powerful that flying time between the surface of Pandora and the flying height could be ignored, and ikran will always fly straight up and down between surface and flying height. Both the starting point and the landing point could be described using latitude and longitude <sup>[4]</sup> of Pandora. And riders will always choose the shortest path to fly. </div>
<div>
<p class="mytitle"> 输入:</p>
</div>
<div class="mypanel">
There are several test cases. Process to the end of file.<br/>          The only line of each test case contains 6 real numbers R (1000 ≤ R ≤ 10000), H (1 ≤ H ≤ R), lat0 (-π/2 &lt; lat0 &lt; π/2), lng0 (-π &lt; lng0 &lt; π), lat1 (-π/2 &lt; lat1 &lt; π/2), lng1 (-π &lt; lng1 &lt; π). R is radius of planet Pandora, H is Na’vi ikran rider’s flying height, lat0 and lng0 are latitude and longitude of starting point, lat1 and lng1 are latitude and longitude of landing point.<br/>           We guarantee that starting point and landing point will not be the same, and they also will not be "opposite" (Starting point, landing point and Pandora’s center will not be in the same line.) </div>
<div>
<p class="mytitle"> 输出:</p>
</div>
<div class="mypanel">
There are several test cases. Process to the end of file.<br/>          The only line of each test case contains 6 real numbers R (1000 ≤ R ≤ 10000), H (1 ≤ H ≤ R), lat0 (-π/2 &lt; lat0 &lt; π/2), lng0 (-π &lt; lng0 &lt; π), lat1 (-π/2 &lt; lat1 &lt; π/2), lng1 (-π &lt; lng1 &lt; π). R is radius of planet Pandora, H is Na’vi ikran rider’s flying height, lat0 and lng0 are latitude and longitude of starting point, lat1 and lng1 are latitude and longitude of landing point.<br/>           We guarantee that starting point and landing point will not be the same, and they also will not be "opposite" (Starting point, landing point and Pandora’s center will not be in the same line.)</div>
<div>
<p class="mytitle"> 样例输入:</p>
</div>
<pre class="mypanel iopanel">
1000 10 0 0 0 0.5
4000 1000 0 0.618 1.0 0.618</pre>
<div>
<p class="mytitle"> 样例输出:</p>
</div>
<pre class="mypanel iopanel">
100.000
64.350
<div style="font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px"><div style="font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed"><i>Hint</i></div>
Reference
[1] Pandora is the fifth moon of the gas giant Polyphemus (both are figures in Greek mythology), which orbits the closest star to the sun, Alpha 
Centauri A.
[2] The Na'vi (English: The People) are a race of sentient extraterrestrial humanoids who inhabit the lush jungle moon of Pandora.
[3] Ikran (English: Mountain banshees) are large, bird-like aerial predators that are native to Pandora. They are used by the Na'vi for hunting from the 
air and traveling larger distances.
[4] To define latitude and longitude of Pandora, we need to know equator of the planet. The equator is the intersection of Pandora's surface with the 
plane perpendicular to axis of Pandora and containing the planet's center. Latitude is a geographic coordinate that specifies the north-south position of a point on the 
Pandora's surface, it is the angle between the equator and the line connected point on the surface with the planet's center. Latitude is an angle which ranges from -π/2 
at the North pole to π/2 at the South pole. Longitude is a geographic coordinate that specifies the east-west position of a point on the Earth's surface. Points with the 
same longitude lie in lines running from the North Pole to the South Pole. The longitude of a point on the surface is measured as an angle east or west from the 
Hometree [5], ranging from 0 at the Hometree to π eastward and -π westward. Specifically, it is the angle between a plane 
containing the Hometree and a plane containing the North Pole, South Pole and the point on the surface.
[5] Hometrees (Na'vi name: Kelutral) are massive trees that can be found throughout Pandora. Many Na'vi clans make these enormous plants their 
home.
</div><i style="font-size:1px"> </i></pre>
<p> <!-- problem end --></p>
<h1 style="color: #1a5cc8;"><a>Coder</a></h1>
<p><span><strong><span style="font-family: Arial; font-size: 12px; font-weight: bold; color: green;">Time Limit: 20000/10000 MS (Java/Others)    Memory Limit: 32768/32768 K (Java/Others)<br/>Total Submission(s): 2547    Accepted Submission(s): 1013<br/></span></strong></span></p>
<div align="left">Problem Description</div>
<div>　<br/>
　In mathematics and computer science, an algorithm describes a set of<br/>
procedures or instructions that define a procedure. The term has become<br/>
increasing popular since the advent of cheap and reliable computers.<br/>
Many companies now employ a single coder to write an algorithm that will<br/>
 replace many other employees. An added benefit to the employer is that<br/>
the coder will also become redundant once their work is done.  <sup>1</sup><br/>　<br/>
　You are now the signle coder, and have been assigned a new task writing<br/>
 code, since your boss would like to replace many other employees (and<br/>
you when you become redundant once your task is complete).<br/>Your code should be able to complete a task to replace these employees who do nothing all day but eating: make the digest sum.<br/>　<br/>
　By saying “digest sum” we study some properties of data. For the sake<br/>
of simplicity, our data is a set of integers. Your code should give<br/>
response to following operations:<br/>　　1. add x – add the element x to the set;<br/>　　2. del x – remove the element x from the set;<br/>　　3. sum – find the digest sum of the set.  The digest sum should be understood by<br/><center><img alt="Polaris of Pandora" src="http://cdn.acmerblog.com/img/1445683543952.jpg"/></center><br/>　　where the set S is written as {a<sub>1</sub>, a<sub>2</sub>, … , a<sub>k</sub>} satisfying a<sub>1</sub> &lt; a<sub>2</sub> &lt; a<sub>3</sub> &lt; … &lt; a<sub>k</sub> <br/>　　Can you complete this task (and be then fired)?<br/>——————————————————————————<br/><sup>1</sup> See http://uncyclopedia.wikia.com/wiki/Algorithm</div>
<div> </div>
<p> </p>
<div align="left">Input</div>
<div>　　There’re several test cases.<br/>　　In each test case, the first line contains one integer N ( 1 &lt;= N &lt;= 10<sup>5</sup> ), the number of operations to process.<br/>　　Then following is n lines, each one containing one of three operations: “add x” or “del x” or “sum”.<br/>　　You may assume that 1 &lt;= x &lt;= 10<sup>9</sup>.<br/>　　Please see the sample for detailed format.<br/>　　For any “add x” it is guaranteed that x is not currently in the set just before this operation.<br/>　　For any “del x” it is guaranteed that x must currently be in the set just before this operation.<br/>　　Please process until EOF (End Of File).</div>
<div> </div>
<p> </p>
<div align="left">Output</div>
<div>　<br/>
　For each operation “sum” please print one line containing exactly one<br/>
integer denoting the digest sum of the current set. Print 0 if the set<br/>
is empty.</div>
<div> </div>
<p> </p>
<div align="left">Sample Input</div>
<div>
<div style="font-family: Courier New,Courier,monospace;">9<br/>
add 1<br/>
add 2<br/>
add 3<br/>
add 4<br/>
add 5<br/>
sum<br/>
add 6<br/>
del 3<br/>
sum<br/>
6<br/>
add 1<br/>
add 3<br/>
add 5<br/>
add 7<br/>
add 9<br/>
sum</div>
</div>
<div> </div>
<p> </p>
<div align="left">Sample Output</div>
<div style="font-family: Courier New,Courier,monospace;">3<br/>
4<br/>
5</div>
<div style="font-family: Courier New,Courier,monospace;">线段树：</div>
<div style="font-family: Courier New,Courier,monospace;">区间一个维护该集合的个数，一个维护模5之后该集合对应1,2,3,4,0即sum[0,1,2,3,4](一一对应记录)的和。当添加一个数时，对应区间更新之后再向上更新。更新父区间时，等于左区间的Lsum[0,1,2,3,4]+右区间的Rsum[0,1,2,3,4]加上左区间个数来说。比如左区间有num个数，假设num%5 = 3,则sum[0] = Lsum[0] + Rsum[2]因为右区间的第三个数相当于整个左右区间模5余1。</div>
<div style="font-family: Courier New,Courier,monospace;">sum[1] = Lsum[1] + Rsum[3],</div>
<div style="font-family: Courier New,Courier,monospace;">sum[2] = Lsum[2] + Rsum[4],</div>
<div style="font-family: Courier New,Courier,monospace;">sum[3] = Lsum[3] + Rsum[0],</div>
<div style="font-family: Courier New,Courier,monospace;">sum[4] = Lsum[4] + Rsum[1];</div>
<div style="font-family: Courier New,Courier,monospace;">即：sum[i] = Lsum[i] + Rsum[(((i - (num%5)) % 5 + 5) % 5]</div>
<div style="font-family: Courier New,Courier,monospace;">
<pre class="brush:cpp"> #include &lt;stdio.h&gt;
 #include &lt;string.h&gt;
 #include &lt;algorithm&gt;
 #include &lt;iomanip&gt;
 #include &lt;set&gt;
 #include &lt;map&gt;
 #include &lt;vector&gt;
 #include &lt;queue&gt;
 #define N 100005
 #define llt long long int
 using namespace std;
 
 int num[N &lt;&lt; 2];//记录区间的个数 
 llt segtree[N &lt;&lt; 2][5];// 
 struct node
 {
     int x;
     char s[4];
 }a[N];
 int b[N];
 map&lt;int, int&gt; mp;//使用map离散化 
 void build(int l, int r, int p)
 {
     memset(segtree[p], 0, sizeof(segtree[p]));
     num[p] = 0;
     if (l &lt; r)
     {
         int mid = (l + r) &gt;&gt; 1, pp = p &lt;&lt; 1;
         build(l, mid, pp);
         build(mid + 1, r, pp + 1);
     }
 }
 void update(int l, int r, int p, int pos, int v)
 {
     if (pos == l &amp;&amp; pos == r)
     {
         segtree[p][0] += 1ll * v;
         num[p] = v &gt; 0 ? 1 : 0;
         return;
     }
     int mid = (l + r) &gt;&gt; 1, pp = p &lt;&lt; 1;
     if (mid &gt;= pos)
         update(l, mid, pp, pos, v);
     else
         update(mid + 1, r, pp + 1, pos, v); 
     for (int i = 0; i &lt; 5; i++)
         segtree[p][i] = segtree[pp][i] + segtree[pp + 1][((i - num[pp]) % 5 + 5) % 5];
     num[p] = num[pp] + num[pp + 1];
 }
 int main()
 {
     int n, i, k;
     while (~scanf("%d", &amp;n))
     {
         k = 1;
         mp.clear();
         for (i = 1; i &lt;= n; i++)
         {
             scanf("%s", a[i].s);
             if (a[i].s[0] == 'a')
             {
                 scanf("%d", &amp;a[i].x);
                 b[k++] = a[i].x;
             }
             else
                 if (a[i].s[0] == 'd')
                 {
                     scanf("%d", &amp;a[i].x);
                     a[i].x = -a[i].x;
                 }    
         }
         build(1, k - 1, 1);
         sort(b + 1, b + k); 
         for (i = 1; i &lt; k; i++)
             mp[b[i]] = i;//重新编号 
         for (i = 1; i &lt;= n; i++)
         {
             if (a[i].s[0] == 's')
                 printf("%I64d\n", segtree[1][2]);
             else
                 update(1, k - 1, 1, mp[abs(a[i].x)], a[i].x);            
         }
     }
     return 0;
 }
</pre>
<p> </p>
</div>
<p>参考：http://www.cnblogs.com/jecyhw/archive/2013/12/01/3452473.html</p>
<div>
</script>
<!-- acm-hf-01 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-9460629317209118" data-ad-slot="5011774182" style="display:inline-block;width:728px;height:90px"></ins>

(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<div class="bdsharebuttonbox"><a class="bds_more" data-cmd="more" href="#"></a><a class="bds_qzone" data-cmd="qzone" href="#" title="分享到QQ空间"></a><a class="bds_tsina" data-cmd="tsina" href="#" title="分享到新浪微博"></a><a class="bds_tqq" data-cmd="tqq" href="#" title="分享到腾讯微博"></a><a class="bds_renren" data-cmd="renren" href="#" title="分享到人人网"></a><a class="bds_weixin" data-cmd="weixin" href="#" title="分享到微信"></a></div>

</div><ol id="commentlist">
<li class="comment even thread-even depth-1" id="li-comment-98083">
<article class="comment" id="comment-98083">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919463291" rel="external nofollow">新用户853656</a></span> on <a href="http://www.acmerblog.com/hdu-4428-polaris-of-pandora-7441.html#comment-98083" rel="nofollow"><time datetime="2017-04-20T11:47:08+00:00" pubdate="">2017年4月20日 at 上午11:47</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>我希望安洁拉和龙迪在一起</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-98082">
<article class="comment" id="comment-98082">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919463291" rel="external nofollow">新用户853656</a></span> on <a href="http://www.acmerblog.com/hdu-4428-polaris-of-pandora-7441.html#comment-98082" rel="nofollow"><time datetime="2017-04-20T11:47:08+00:00" pubdate="">2017年4月20日 at 上午11:47</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>我希望安洁拉和龙迪在一起</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-98081">
<article class="comment" id="comment-98081">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919463291" rel="external nofollow">新用户853656</a></span> on <a href="http://www.acmerblog.com/hdu-4428-polaris-of-pandora-7441.html#comment-98081" rel="nofollow"><time datetime="2017-04-20T11:47:08+00:00" pubdate="">2017年4月20日 at 上午11:47</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>我希望安洁拉和龙迪在一起</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-98080">
<article class="comment" id="comment-98080">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919463291" rel="external nofollow">新用户853656</a></span> on <a href="http://www.acmerblog.com/hdu-4428-polaris-of-pandora-7441.html#comment-98080" rel="nofollow"><time datetime="2017-04-20T11:47:08+00:00" pubdate="">2017年4月20日 at 上午11:47</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>我希望安洁拉和龙迪在一起</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-98079">
<article class="comment" id="comment-98079">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919463291" rel="external nofollow">新用户853656</a></span> on <a href="http://www.acmerblog.com/hdu-4428-polaris-of-pandora-7441.html#comment-98079" rel="nofollow"><time datetime="2017-04-20T11:47:08+00:00" pubdate="">2017年4月20日 at 上午11:47</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>我希望安洁拉和龙迪在一起</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-68084">
<article class="comment" id="comment-68084">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919526669" rel="external nofollow">新用户514211</a></span> on <a href="http://www.acmerblog.com/hdu-4428-polaris-of-pandora-7441.html#comment-68084" rel="nofollow"><time datetime="2017-04-11T03:57:03+00:00" pubdate="">2017年4月11日 at 上午3:57</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>你SJB，凉夕跟王爷勾三搭四？你哪只眼睛看见的？明明是那个王爷像口香糖一样缠着凉夕，好吗？</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-68083">
<article class="comment" id="comment-68083">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919526669" rel="external nofollow">新用户514211</a></span> on <a href="http://www.acmerblog.com/hdu-4428-polaris-of-pandora-7441.html#comment-68083" rel="nofollow"><time datetime="2017-04-11T03:57:03+00:00" pubdate="">2017年4月11日 at 上午3:57</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>你SJB，凉夕跟王爷勾三搭四？你哪只眼睛看见的？明明是那个王爷像口香糖一样缠着凉夕，好吗？</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
</ol>