<div class="c-top2" id="post-55">
<div class="datetime">2014<br/>11-27</div>
<div class="tit"><h1 class="entry-title">HDU 3589-Jacobi symbol-最小生成树-[解题报告]HOJ</h1>
<div class="entry-meta iititle2">
<span class="i2"><a href="http://www.acmerblog.com/author/spiderman" rel="author" title="由蜘蛛侠发布">蜘蛛侠</a></span><span class="i1"><a href="http://www.acmerblog.com/category/problemset/hdu" rel="category tag" title="查看HDU-杭电中的全部文章">HDU-杭电</a>, <a href="http://www.acmerblog.com/category/graph/mst" rel="category tag" title="查看最小生成树中的全部文章">最小生成树</a></span><span class="i4">围观488次</span><span class="i3"><a class="ds-thread-count" data-thread-key="6553" href="http://www.acmerblog.com/hdu-3589-jacobi-symbol-6553.html#comments" title="《HDU 3589-Jacobi symbol-最小生成树-[解题报告]HOJ》上的评论">13 条评论</a></span>
</div>
</div>
<div class="cls"></div>
</div><div class="entry-content">
<div>
<h1 class="mytitle mybigtile">Jacobi symbol</h1>
</div>
<div>
<p class="mytitle"> 问题描述 :</p>
</div>
<div class="mypanel">
Consider a prime number p and an integer a !≡ 0 (mod p). Then a is called a quadratic residue mod p if there is an integer x such that x<sup>2</sup> ≡ a (mod p), and a quadratic non residue otherwise. Lagrange introduced the following notation, called the Legendre symbol, L (a,p): 
<p></p><center><img alt="Pair" src="http://www.acmerblog.com/img/1419795644425.jpg"/></center>
<p>For the calculation of these symbol there are the following rules, valid only for distinct odd prime numbers p, q and integers a, b not divisible by p: </p>
<p></p><center><img alt="Pair" src="http://www.acmerblog.com/img/1419795644554.jpg"/></center>
<p>The Jacobi symbol, J (a, n) ,is a generalization of the Legendre symbol ,L (a, p).It defines as :<br/>1.  J (a, n) is only defined when n is an odd.<br/>2.  J (0, n) = 0.<br/>3.  If n is a prime number, J (a, n) = L(a, n).<br/>4.  If n is not a prime number, J (a, n) = J (a, p1) *J (a, p2)…* J (a, pm), p1…pm is the prime factor of n. </p></div>
<div>
<p class="mytitle"> 输入:</p>
</div>
<div class="mypanel">
Two integer a and n, 2 &lt; a&lt; =10<sup>6</sup>，2 &lt; n &lt; =10<sup>6</sup>，n is an odd number. </div>
<div>
<p class="mytitle"> 输出:</p>
</div>
<div class="mypanel">
Two integer a and n, 2 &lt; a&lt; =10<sup>6</sup>，2 &lt; n &lt; =10<sup>6</sup>，n is an odd number.</div>
<div>
<p class="mytitle"> 样例输入:</p>
</div>
<pre class="mypanel iopanel">
3 5
3 9
3 13</pre>
<div>
<p class="mytitle"> 样例输出:</p>
</div>
<pre class="mypanel iopanel">
-1
0
1</pre>
<p> <!-- problem end --></p>
<p>概念原理看置顶文</p>
<pre class="brush:cpp" name="code">#include&lt;stdio.h&gt;
#include&lt;string.h&gt;
#include&lt;math.h&gt;
#define ll __int64
#define maxn 1000010
ll prime[maxn];
bool isprime[maxn];
ll exp(ll a,ll b,ll p)
{
    ll res=1;
    for(;b;b&gt;&gt;=1)
    {
        if(b&amp;1)
        res=(res*a)%p;
        a=(a*a)%p;
    }
    return res;
}

int cal(int a,int n)
{
    if(a%n==0)
    return 0;
    else
    return exp(a,(n-1)/2,n)==1?1:-1;
}
int main()
{
    freopen("in.txt","r",stdin);
    memset(isprime,true,sizeof(isprime));
    for(int i=2;i&lt;maxn;i++)
    {
        for(int j=2;i*j&lt;maxn;j++)
        isprime[i*j]=0;
    }
    int k=0;
    for(int i=2;i&lt;maxn;i++)
    {
        if(isprime[i])
        prime[k++]=i;
    }
    int a,n;
   while(scanf("%d%d",&amp;a,&amp;n)==2)
   {
        int ans;
        if(isprime[n]==0)
        {
        ans=1;
        for(int i=0;n!=1&amp;&amp;i&lt;k;i++)
        {
            if(n%prime[i]==0)
            {
                int total=0;
                while(n%prime[i]==0)
                {
                    total++;
                    n/=prime[i];
                }
                int tmp=cal(a,prime[i]);
                if(total%2==0&amp;&amp;tmp==-1)
                tmp=1;
                ans*=tmp;
            }
        }
        }
        else
        ans=cal(a,n);
        printf("%d\n",ans);
   }
    return 0;
}
</pre>
<p>参考：http://blog.csdn.net/lentty1452/article/details/8570335</p>
<div>
</script>
<!-- acm-hf-01 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-9460629317209118" data-ad-slot="5011774182" style="display:inline-block;width:728px;height:90px"></ins>

(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<div class="bdsharebuttonbox"><a class="bds_more" data-cmd="more" href="#"></a><a class="bds_qzone" data-cmd="qzone" href="#" title="分享到QQ空间"></a><a class="bds_tsina" data-cmd="tsina" href="#" title="分享到新浪微博"></a><a class="bds_tqq" data-cmd="tqq" href="#" title="分享到腾讯微博"></a><a class="bds_renren" data-cmd="renren" href="#" title="分享到人人网"></a><a class="bds_weixin" data-cmd="weixin" href="#" title="分享到微信"></a></div>

</div><ol id="commentlist">
<li class="comment even thread-even depth-1" id="li-comment-73625">
<article class="comment" id="comment-73625">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919513489" rel="external nofollow">新用户705534</a></span> on <a href="http://www.acmerblog.com/hdu-3589-jacobi-symbol-6553.html#comment-73625" rel="nofollow"><time datetime="2017-04-12T00:07:35+00:00" pubdate="">2017年4月12日 at 上午12:07</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>刚刚反应到是在拔牙。。。光注意小女孩和狗了</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-32387">
<article class="comment" id="comment-32387">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">Tree</a></span> on <a href="http://www.acmerblog.com/hdu-3589-jacobi-symbol-6553.html#comment-32387" rel="nofollow"><time datetime="2015-07-15T12:27:41+00:00" pubdate="">2015年7月15日 at 下午12:27</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>Good task for the group. Hold it up for every yeara??s winner. This is a excellent oppotunity for a lot more enhancement. Indeed, obtaining far better and much better is constantly the crucial. Just like my pal suggests on the truth about ab muscles, he just keeps obtaining much better.</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-32385">
<article class="comment" id="comment-32385">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">calvert1991</a></span> on <a href="http://www.acmerblog.com/hdu-3589-jacobi-symbol-6553.html#comment-32385" rel="nofollow"><time datetime="2015-06-10T06:22:42+00:00" pubdate="">2015年6月10日 at 上午6:22</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>不错，赞一个！</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-59305">
<article class="comment" id="comment-59305">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">la0bei</a></span> on <a href="http://www.acmerblog.com/hdu-3589-jacobi-symbol-6553.html#comment-59305" rel="nofollow"><time datetime="2015-06-09T00:57:23+00:00" pubdate="">2015年6月9日 at 上午12:57</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>Thank you very much</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-32389">
<article class="comment" id="comment-32389">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">Sacomplex</a></span> on <a href="http://www.acmerblog.com/hdu-3589-jacobi-symbol-6553.html#comment-32389" rel="nofollow"><time datetime="2015-05-24T06:31:32+00:00" pubdate="">2015年5月24日 at 上午6:31</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>样例输出和程序输出不吻合，修改一下样例输出吧。我用的是VC编译器，会提示我的i和j变量重复定义</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-32386">
<article class="comment" id="comment-32386">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">stamwoo</a></span> on <a href="http://www.acmerblog.com/hdu-3589-jacobi-symbol-6553.html#comment-32386" rel="nofollow"><time datetime="2015-05-13T03:32:28+00:00" pubdate="">2015年5月13日 at 上午3:32</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>使用代码高亮的插件，再修改下css</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-32380">
<article class="comment" id="comment-32380">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">everos</a></span> on <a href="http://www.acmerblog.com/hdu-3589-jacobi-symbol-6553.html#comment-32380" rel="nofollow"><time datetime="2015-04-21T01:43:39+00:00" pubdate="">2015年4月21日 at 上午1:43</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>写的很好~~</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-32384">
<article class="comment" id="comment-32384">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">jamoeba</a></span> on <a href="http://www.acmerblog.com/hdu-3589-jacobi-symbol-6553.html#comment-32384" rel="nofollow"><time datetime="2015-04-17T09:27:11+00:00" pubdate="">2015年4月17日 at 上午9:27</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>整理的很好，学习了</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-32383">
<article class="comment" id="comment-32383">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">20134055016</a></span> on <a href="http://www.acmerblog.com/hdu-3589-jacobi-symbol-6553.html#comment-32383" rel="nofollow"><time datetime="2015-02-15T02:06:00+00:00" pubdate="">2015年2月15日 at 上午2:06</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>#include &lt;stdio.h&gt;<br/>
int main(void)<br/>
{<br/>
int arr[] = {10,20,30,40,50,60};<br/>
int *p=arr;<br/>
printf("%d,%d,",*p++,*++p);<br/>
printf("%d,%d,%d",*p,*p++,*++p);<br/>
return 0;<br/>
}</p>
<p>为什么是 20,20,50,40,50. 我觉得的应该是 20,20,40,40,50 . 谁能解释下？</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-32381">
<article class="comment" id="comment-32381">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">21435048</a></span> on <a href="http://www.acmerblog.com/hdu-3589-jacobi-symbol-6553.html#comment-32381" rel="nofollow"><time datetime="2015-01-25T01:14:05+00:00" pubdate="">2015年1月25日 at 上午1:14</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>这配图…..</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-32388">
<article class="comment" id="comment-32388">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">Ailing</a></span> on <a href="http://www.acmerblog.com/hdu-3589-jacobi-symbol-6553.html#comment-32388" rel="nofollow"><time datetime="2015-01-23T10:47:57+00:00" pubdate="">2015年1月23日 at 上午10:47</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>非常好，初学者就应该先理解递归</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-63901">
<article class="comment" id="comment-63901">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">yipwinghong</a></span> on <a href="http://www.acmerblog.com/hdu-3589-jacobi-symbol-6553.html#comment-63901" rel="nofollow"><time datetime="2014-12-12T17:41:06+00:00" pubdate="">2014年12月12日 at 下午5:41</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>很棒的网站，加油！⛽️</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-32382">
<article class="comment" id="comment-32382">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">missliuxin</a></span> on <a href="http://www.acmerblog.com/hdu-3589-jacobi-symbol-6553.html#comment-32382" rel="nofollow"><time datetime="2014-12-10T07:35:16+00:00" pubdate="">2014年12月10日 at 上午7:35</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>很有意思，可惜我很菜啊</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
</ol>