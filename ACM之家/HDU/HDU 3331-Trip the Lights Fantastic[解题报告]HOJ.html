<div class="c-top2" id="post-55">
<div class="datetime">2014<br/>03-16</div>
<div class="tit"><h1 class="entry-title">HDU 3331-Trip the Lights Fantastic[解题报告]HOJ</h1>
<div class="entry-meta iititle2">
<span class="i2"><a href="http://www.acmerblog.com/author/spiderman" rel="author" title="由蜘蛛侠发布">蜘蛛侠</a></span><span class="i1"><a href="http://www.acmerblog.com/category/problemset/hdu" rel="category tag" title="查看HDU-杭电中的全部文章">HDU-杭电</a></span><span class="i4">围观417次</span><span class="i3"><a class="ds-thread-count" data-thread-key="5263" href="http://www.acmerblog.com/hdu-3331-trip-the-lights-fantastic-5263.html#comments" title="《HDU 3331-Trip the Lights Fantastic[解题报告]HOJ》上的评论">14 条评论</a></span>
</div>
</div>
<div class="cls"></div>
</div><div class="entry-content">
<div>
<h1 class="mytitle mybigtile">Trip the Lights Fantastic</h1>
</div>
<div>
<p class="mytitle"> 问题描述 :</p>
</div>
<div class="mypanel">
Bob Roberts (father of Little Bobby of problem D) works at the Traffic Commission for a medium size town. Bob is in charge of monitoring the traffic lights in the city and dispatching repair crews when necessary. Needless to say, Bob has a lot of free time, so to while away the hours he tries to figure out the quickest way to take short trips between various points in the city. Bob has at his disposal a lot of information: the layout of streets in the city and the location and cycle times for all of the traffic lights. To simplify the solution process, he makes the following assumptions:
<p>1. All cars travel at the same top speed, and, if sitting at a red light, take 5 seconds to react and get up to speed. (That is, Bob assumes the car is essentially standing still for 5 seconds, then proceeds at top speed. Bob also assumes the light will not have turned back to red in the 5 seconds it takes to get going.)</p>
<p>2. Each car approaches a light at full speed and either passes through the light if it is green or yellow, or comes to an immediate stop if it is red. Cars are allowed to pass through a light if they hit it just as it is turning to green. Cars must stop if they reach the light just as it is turning to red.</p>
<p>3. The time to make turns through a light is ignored. It is possible to travel between any two lights, although perhaps not directly.</p>
<p>Furthermore, no u-turns are allowed nor will routes revisit an intersection. Even given these assumptions, Bob has difficulty coming up with minimum time paths. Let’s see if you can help him. </p></div>
<div>
<p class="mytitle"> 输入:</p>
</div>
<div class="mypanel">
The first line of each test case will contain four positive integers <i>n</i>, <i>m</i>, <i>s</i>, and <i>e</i>, where <i>n</i> (2 ≤ <i>n</i> ≤ 100) is the number of traffic lights (numbered 0 through <i>n</i> – 1), <i>m</i> is the number of roads between the traffic lights, and <i>s</i> and <i>e</i> (<i>s</i> ≠ <i>e</i>) are the starting and ending lights for the desired trip. There will then follow <i>n</i> lines of the form <i>g y r</i> indicating the number of seconds that each light is green, then yellow, then red. (1 ≤ <i>g, y, r</i> ≤ 100.) The first of these lines refers to light 0, the second to light 1, and so on. Following these <i>n</i> lines will be <i>m</i> lines, each describing one road. These lines will have the form <i>l1 l2 t</i>, where <i>l1</i> and <i>l2</i> are the two lights being connected by the road and <i>t</i> is the time (in seconds, <i>t</i> ≤ 500) to travel the length of the road at full speed ― you should add 5 to this value to obtain the travel time when driving the road beginning at a standstill. All roads are two way. At time 0, all lights are just starting their green period and your car is considered to be at a standstill at traffic light <i>s</i>. Since it takes 5 seconds to get going, you may assume that <i>g</i> + <i>y</i> is never less than or equal to 5. The last test case is followed by a line containing 0 0 0 0 indicating end-of-input. </div>
<div>
<p class="mytitle"> 输出:</p>
</div>
<div class="mypanel">
The first line of each test case will contain four positive integers <i>n</i>, <i>m</i>, <i>s</i>, and <i>e</i>, where <i>n</i> (2 ≤ <i>n</i> ≤ 100) is the number of traffic lights (numbered 0 through <i>n</i> – 1), <i>m</i> is the number of roads between the traffic lights, and <i>s</i> and <i>e</i> (<i>s</i> ≠ <i>e</i>) are the starting and ending lights for the desired trip. There will then follow <i>n</i> lines of the form <i>g y r</i> indicating the number of seconds that each light is green, then yellow, then red. (1 ≤ <i>g, y, r</i> ≤ 100.) The first of these lines refers to light 0, the second to light 1, and so on. Following these <i>n</i> lines will be <i>m</i> lines, each describing one road. These lines will have the form <i>l1 l2 t</i>, where <i>l1</i> and <i>l2</i> are the two lights being connected by the road and <i>t</i> is the time (in seconds, <i>t</i> ≤ 500) to travel the length of the road at full speed ― you should add 5 to this value to obtain the travel time when driving the road beginning at a standstill. All roads are two way. At time 0, all lights are just starting their green period and your car is considered to be at a standstill at traffic light <i>s</i>. Since it takes 5 seconds to get going, you may assume that <i>g</i> + <i>y</i> is never less than or equal to 5. The last test case is followed by a line containing 0 0 0 0 indicating end-of-input.</div>
<div>
<p class="mytitle"> 样例输入:</p>
</div>
<pre class="mypanel iopanel">
3 3 0 2
3 4 5
3 3 3
2 4 4
0 1 1
1 2 2
0 2 12
3 3 0 2
3 4 5
3 4 3
2 4 4
0 1 1
1 2 2
0 2 12
0 0 0 0</pre>
<div>
<p class="mytitle"> 样例输出:</p>
</div>
<pre class="mypanel iopanel">
0:16
0:08</pre>
<p> <!-- problem end --></p>
<pre class="brush:cpp ">#include&lt;iostream&gt;
#include&lt;cstring&gt;
#include&lt;cstdio&gt;
#include&lt;set&gt;
#define MAXN 150
using namespace std;
int n,m,ids,ide,ans;
int br[MAXN][MAXN],dist[MAXN];
struct Node{
    int g,y,r;
}node[MAXN];
struct L{
    int  x,t;
    bool operator &lt;(L othr)const{
        if(x==othr.x)return t&lt;othr.t;
        else return x&lt;othr.x;
    }
}now;
void SPFA(){
    set&lt;L&gt;Q;
    Q.clear();
    memset(dist,-1,sizeof(dist));
    Q.insert((L){ids,5});
    dist[ids]=5;
    set&lt;L&gt;::iterator  it;
    while(!Q.empty()){
        it=Q.begin();
        now=*it;
        Q.erase(it); 
        for(int i=0;i&lt;n;i++){
            if(br[now.x][i]==-1)continue;
            int add=0,nowtime,tot,res;
            nowtime=br[now.x][i]+dist[now.x];
            tot=node[i].g+node[i].r+node[i].y;
            res=nowtime%tot;
            if(res&gt;=node[i].g+node[i].y)add=5+tot-res;       
            if(i==ide&amp;&amp;(ans==-1||ans&gt;nowtime))ans=nowtime; 
            if(add+nowtime&lt;dist[i]||dist[i]==-1){
                dist[i]=nowtime+add;
                Q.insert((L){i,dist[i]});   
            }
        }
    }
}
int main(){
    while(scanf("%d%d%d%d",&amp;n,&amp;m,&amp;ids,&amp;ide)!=EOF&amp;&amp;(n||m||ids||ide)){
        if(ids==ide){
            printf("0:00\n");
            continue;
        }
        for(int i=0;i&lt;n;i++){
            scanf("%d%d%d",&amp;node[i].g,&amp;node[i].y,&amp;node[i].r);
        }
        memset(br,-1,sizeof(br));
        for(int i=0;i&lt;m;i++){
            int  xx,yy,zz;
            scanf("%d%d%d",&amp;xx,&amp;yy,&amp;zz);
            if(br[xx][yy]==-1||br[xx][yy]&gt;zz)
            br[xx][yy]=br[yy][xx]=zz;
        }
        ans=-1;
        SPFA();
        int second=ans;
        int minute=second/60;
        second=second%60;
        printf("%d:%02d\n",minute,second);
        }
}</pre>
<div>
</script>
<!-- acm-hf-01 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-9460629317209118" data-ad-slot="5011774182" style="display:inline-block;width:728px;height:90px"></ins>

(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<div class="bdsharebuttonbox"><a class="bds_more" data-cmd="more" href="#"></a><a class="bds_qzone" data-cmd="qzone" href="#" title="分享到QQ空间"></a><a class="bds_tsina" data-cmd="tsina" href="#" title="分享到新浪微博"></a><a class="bds_tqq" data-cmd="tqq" href="#" title="分享到腾讯微博"></a><a class="bds_renren" data-cmd="renren" href="#" title="分享到人人网"></a><a class="bds_weixin" data-cmd="weixin" href="#" title="分享到微信"></a></div>

</div><ol id="commentlist">
<li class="comment even thread-even depth-1" id="li-comment-77623">
<article class="comment" id="comment-77623">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919456768" rel="external nofollow">新用户719594</a></span> on <a href="http://www.acmerblog.com/hdu-3331-trip-the-lights-fantastic-5263.html#comment-77623" rel="nofollow"><time datetime="2017-04-12T09:15:02+00:00" pubdate="">2017年4月12日 at 上午9:15</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>赶快加紧研发吧。中国至少有30000000的潜在用户呢</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-28864">
<article class="comment" id="comment-28864">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">0xc0de</a></span> on <a href="http://www.acmerblog.com/hdu-3331-trip-the-lights-fantastic-5263.html#comment-28864" rel="nofollow"><time datetime="2015-07-02T09:42:17+00:00" pubdate="">2015年7月2日 at 上午9:42</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>你的理解应该是：即使主持人拿走一个箱子对结果没有影响。这样想，主持人拿走的箱子只是没有影响到你初始选择的那个箱子中有奖品的概率，但是改变了其余两个箱子的概率分布。由 1/3,1/3 变成了 0, 2/3</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-48474">
<article class="comment" id="comment-48474">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">211206421</a></span> on <a href="http://www.acmerblog.com/hdu-3331-trip-the-lights-fantastic-5263.html#comment-48474" rel="nofollow"><time datetime="2015-06-16T14:59:49+00:00" pubdate="">2015年6月16日 at 下午2:59</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>mark, 很巧妙的实现！</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-28866">
<article class="comment" id="comment-28866">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">PriceKiller</a></span> on <a href="http://www.acmerblog.com/hdu-3331-trip-the-lights-fantastic-5263.html#comment-28866" rel="nofollow"><time datetime="2015-05-20T23:22:55+00:00" pubdate="">2015年5月20日 at 下午11:22</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>隐藏最深的bug是(start+end)/2有可能上溢</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-48477">
<article class="comment" id="comment-48477">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">gaoriqiang</a></span> on <a href="http://www.acmerblog.com/hdu-3331-trip-the-lights-fantastic-5263.html#comment-48477" rel="nofollow"><time datetime="2015-03-07T10:53:37+00:00" pubdate="">2015年3月7日 at 上午10:53</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>您没有考虑 树的根节点是负数的情况， 若树的根节点是个很大的负数，那么就要考虑过不过另外一边子树了</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-48475">
<article class="comment" id="comment-48475">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">jue</a></span> on <a href="http://www.acmerblog.com/hdu-3331-trip-the-lights-fantastic-5263.html#comment-48475" rel="nofollow"><time datetime="2015-01-21T20:10:38+00:00" pubdate="">2015年1月21日 at 下午8:10</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>学习了。找到这题</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-28862">
<article class="comment" id="comment-28862">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">anshansh</a></span> on <a href="http://www.acmerblog.com/hdu-3331-trip-the-lights-fantastic-5263.html#comment-28862" rel="nofollow"><time datetime="2015-01-04T22:22:22+00:00" pubdate="">2015年1月4日 at 下午10:22</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>可以用公式。主要为了说明动态规划，如果要打表的话，这种方法也是较简单和高效的</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-58343">
<article class="comment" id="comment-58343">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">mclown</a></span> on <a href="http://www.acmerblog.com/hdu-3331-trip-the-lights-fantastic-5263.html#comment-58343" rel="nofollow"><time datetime="2014-12-04T04:00:05+00:00" pubdate="">2014年12月4日 at 上午4:00</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>纠正一个错误，二分查找树的中序遍历获得元素的升序排列。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-48479">
<article class="comment" id="comment-48479">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">linyanjin</a></span> on <a href="http://www.acmerblog.com/hdu-3331-trip-the-lights-fantastic-5263.html#comment-48479" rel="nofollow"><time datetime="2014-11-22T10:36:43+00:00" pubdate="">2014年11月22日 at 上午10:36</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>程序员会算法，等于一个古惑仔带了zhi抢啊</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-28863">
<article class="comment" id="comment-28863">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">jhxxszy</a></span> on <a href="http://www.acmerblog.com/hdu-3331-trip-the-lights-fantastic-5263.html#comment-28863" rel="nofollow"><time datetime="2014-11-04T23:31:59+00:00" pubdate="">2014年11月4日 at 下午11:31</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>great work！</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-28865">
<article class="comment" id="comment-28865">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">bobo</a></span> on <a href="http://www.acmerblog.com/hdu-3331-trip-the-lights-fantastic-5263.html#comment-28865" rel="nofollow"><time datetime="2014-10-10T02:29:52+00:00" pubdate="">2014年10月10日 at 上午2:29</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>代码不错，赞一个！</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-48476">
<article class="comment" id="comment-48476">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">Mitrenick</a></span> on <a href="http://www.acmerblog.com/hdu-3331-trip-the-lights-fantastic-5263.html#comment-48476" rel="nofollow"><time datetime="2014-09-04T03:08:55+00:00" pubdate="">2014年9月4日 at 上午3:08</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>涨姿势了</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-48478">
<article class="comment" id="comment-48478">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">ForgetVay</a></span> on <a href="http://www.acmerblog.com/hdu-3331-trip-the-lights-fantastic-5263.html#comment-48478" rel="nofollow"><time datetime="2014-08-22T10:22:36+00:00" pubdate="">2014年8月22日 at 上午10:22</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>已修改。一些字符在编辑的时候转义了</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-58342">
<article class="comment" id="comment-58342">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">we</a></span> on <a href="http://www.acmerblog.com/hdu-3331-trip-the-lights-fantastic-5263.html#comment-58342" rel="nofollow"><time datetime="2014-07-18T22:32:30+00:00" pubdate="">2014年7月18日 at 下午10:32</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>此题的样例描述不正确</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
</ol>