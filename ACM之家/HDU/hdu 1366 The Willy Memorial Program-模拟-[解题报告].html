<div class="c-top2" id="post-55">
<div class="datetime">2013<br/>12-09</div>
<div class="tit"><h1 class="entry-title">hdu 1366 The Willy Memorial Program-模拟-[解题报告]</h1>
<div class="entry-meta iititle2">
<span class="i2"><a href="http://www.acmerblog.com/author/admin" rel="author" title="由coder发布">coder</a></span><span class="i1"><a href="http://www.acmerblog.com/category/basis/simulate" rel="category tag" title="查看模拟法中的全部文章">模拟法</a></span><span class="i4">围观648次</span><span class="i3"><a class="ds-thread-count" data-thread-key="1796" href="http://www.acmerblog.com/hdu-1366-The-Willy-Memorial-Program-1796.html#comments" title="《hdu 1366 The Willy Memorial Program-模拟-[解题报告]》上的评论">12 条评论</a></span>
</div>
</div>
<div class="cls"></div>
</div><div class="entry-content">
<div>
<h1 class="mytitle mybigtile">The Willy Memorial Program</h1>
</div>
<div>
<p class="mytitle"> 问题描述 :</p>
</div>
<div class="mypanel">
Willy the spider used to live in the chemistry laboratory of Dr. Petro. He used to wander about the lab pipes and sometimes inside empty ones. One night while he was in a pipe, he fell asleep. The next morning, Dr. Petro came to the lab. He didn’t notice Willy while opening the valve to fill the pipes with hot water. Meanwhile, Stanley the gray mouse got what was going to happen. No time to lose! Stan ran hard to reach the valve before Willy gets drawn, but… Alas! He couldn’t make it! 
<p>Poor Willy was boiled in hot water, but his memory is still in our hearts. Though Stan tried his best, we want to write a program, in the memory of Willy, to compute the time Stan had, to rescue Willy, assuming he started to run just when the doctor opened the valve.</p>
<p>To simplify the problem, assume the pipes are all vertical cylinders with diameter 1 cm. Every pipe is open from the top and closed at the bottom. Some of the pipes are connected through special horizontal pipes named links. The links have very high flow capacity, but are so tiny that at any given time, the volume of water inside them is negligible. The water enters from top of one of the pipes with a constant rate of 0.25πcm3/sec and begins to fill the pipe from the bottom until the water reaches a link through which it flows horizontally and begins to fill the connected pipe. From elementary physics we know if two pipes are connected and the surface of the water is above the connecting link, the level of water in both pipes remains the same when we try to fill one of them. In this case the water fills each pipe with a rate equal to half of the rate of incoming water. As an example, consider the following configuration:</p>
<p></p><center><img src="http://acm.hdu.edu.cn/data/images/1366-1.gif"/></center>
<p>First, the lower 2 centimeters of the left pipe is filled with water at full rate, then, the lower 3 centimeters of the right pipe is filled, and after that, the upper part of the two pipes are filled in parallel at half rate. The input to your program is a configuration of pipes and links, and a target level in one of the pipes (the heavy dotted line in the above figure). The program should report how long it takes for the level of water to reach the target level. For the above configuration, the output is 9 seconds.</p>
<p>It is assumed that the water falls very rapidly, such that the time required for the water to fall can be neglected. The target level is always assumed to be a bit higher than the specified level for it. As an example, if we set the target point to level 4 in the left pipe in the figure above, the elapsed time for water to reach that target is assumed to be 5 (not 2), Also note that if the water reaches to the top of a pipe (say in level x), it won’t pour out outside the pipe until empty spaces in connected pipes below level x are filled (if can be filled, i.e. the level of water reaches the connecting links). (Note that there may be some links at level x, to which water is entered). After all such spaces are filled; the water level would not go up further. </p></div>
<div>
<p class="mytitle"> 输入:</p>
</div>
<div class="mypanel">
To describe positions, we assume the coordinates are expressed as (x, y) and the origin lies in the top-left of all pipes and links. (Note that y coordinates are increased downwards). All coordinates are integer numbers between 0 and 100, inclusive.<br/>The first line of the input file contains a single integer t (1 &lt;= t &lt;= 10), the number of test cases, followed by the input data for each test case. The first line of each test case is p (1 &lt;= p &lt;= 20), the number of pipes, followed by p lines, each describing a pipe. Each pipe description line consists of three numbers. The first two are (x, y) coordinates of the upper-left corner of the pipe and the third number is the height of the pipe (at least 1 cm and at most 20 cm). Note that diameter of each pipe is 1 cm.
<p>After input data describing the pipes, there is a line containing a single integer l, which is the number of links (0  l  50). After it, there are l lines describing links. Each link description contains 3 integers. The first two are (x, y) coordinates of the left end-point of the link and the third is the length of the link (at least 1 cm and at most 20 cm). It is assumed that the width of the link is zero.</p>
<p>The last line for each test case contains two numbers. The first is the number of target pipe (starting from one, with the order appeared in test data). The second line is the desired y for the level of water in the target pipe (note that the specified level may be out of the pipe at all).</p>
<p>You can assume the following about the input:</p>
<p>The water enters into the first pipe.<br/>No link crosses a pipe.<br/>No two links have the same y coordinates.<br/>No two pipes have the same upper-left x coordinates.<br/>Both endpoints of each link are connected to pipes. </p></div>
<div>
<p class="mytitle"> 输出:</p>
</div>
<div class="mypanel">
The output file should contain exactly t lines with no blank lines in between, each corresponding to one test case. Each output line should contain the time required for the water to reach the target level in the target pipe (an integer number). If in a specific test case, the water never reaches the target level, the line should contain No Solution string in it.</div>
<div>
<p class="mytitle"> 样例输入:</p>
</div>
<pre class="mypanel iopanel">
1
2
2 0 6
5 1 6
1
3 4 2
2 2</pre>
<div>
<p class="mytitle"> 样例输出:</p>
</div>
<pre class="mypanel iopanel">
9</pre>
<p> <!-- problem end --></p>
<p>数据好小，然后乱搞。。。每次都从最下面开始一格一格灌水，然后判断有该格有没有管子相连，有的话就把连的那个管子和当前的管子合并，然后又重新从下面开始灌水，</p>
<p>直到达到或者溢出。。。</p>
<p>PS:好恶心的模拟题啊。。。WA了好久，发现循环变量名写错了一个。。。然后还是WA。。。最后才知道模拟的时候有一个判断的细节没有处理好，这个一定要注意，模拟题什么的要最仔细了，一定得想清楚。。- -#</p>
<p>写的很挫很挫的代码。。在zoj上用G++交会CE，然后把库函数改了，用C交AC。。。    - -|||||||，话说POJ的C++可以过。。。</p>
<pre class="brush:cpp ">#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;cstdlib&gt;
#include&lt;cstring&gt;
#include&lt;string&gt;

#define N 1000000

using namespace std;

struct ty
{
    int x,y,len,bj;
    int linkx[75];
    int linky[75];
}pipe[50];
struct ty2
{
    int v,bj,link;
}f[120];
int ans;

int ok()
{
    int i,j,ii,flag[50],k;
    ans=0;
    memset(flag,0,sizeof(flag));
    flag[1]=1;
    for(i=0;i&lt;=110;i++)f[i].link=-1;
    for(i=0;i&lt;=110;i++)
    {
        if((pipe[1].y&lt;=i)&amp;&amp;(i&lt;pipe[1].y+pipe[1].len))f[i].v+=1;
        if(i&lt;pipe[1].y)f[i].v+=10000000;
    }
    for(j=1;j&lt;=pipe[1].linky[0];j++)
        f[pipe[1].linky[j]].link=pipe[1].linkx[j];
    if(pipe[1].bj!=-1)f[pipe[1].bj].bj=1;
    while(1)
    {
        for(i=110;i&gt;=0;i--)
        {
            //printf("%d        %d\n",i,f[i].bj);
            if(f[i].v&gt;=10000000)return f[i+2].bj;
            //printf("%d\n",f[i].bj);
            if(f[i+1].bj==1)return 1;
            //printf("%d   %d       %d         %d         %d\n",i,f[i].v,f[i].bj,f[i].link,ans);
            ans+=f[i].v;
            f[i].v=0;
            if((f[i].link&gt;=0)&amp;&amp;(flag[f[i].link]==0))
            {
                k=f[i].link;
                f[i].link=-1;
                flag[k]=1;
                for(j=0;j&lt;=110;j++)
                {
                    if((pipe[k].y&lt;=j)&amp;&amp;(j&lt;pipe[k].y+pipe[k].len))f[j].v+=1;
                    if(j&lt;pipe[k].y)f[j].v+=1000000000;
                }
                for(j=1;j&lt;=pipe[k].linky[0];j++)
                      f[pipe[k].linky[j]].link=pipe[k].linkx[j];
                //printf("        %d\n",pipe[k].bj);
                if(pipe[k].bj!=-1)f[pipe[k].bj].bj=1;
                break;
            }
            //if(f[i].bj==1)return 1;
        }
        if(i==-1)return 0;
    }
}

int main()
{
    int t,p,l,x,y,len,t1,t2;
    scanf("%d",&amp;t);
    while(t--)
    {
        memset(pipe,0,sizeof(pipe));
        memset(f,0,sizeof(f));
        scanf("%d",&amp;p);
        for(int i=1;i&lt;=p;i++)
        {
            scanf("%d%d%d",&amp;pipe[i].x,&amp;pipe[i].y,&amp;pipe[i].len);
            pipe[i].bj=-1;
        }
        scanf("%d",&amp;l);
        for(int i=1;i&lt;=l;i++)
        {
            scanf("%d%d%d",&amp;x,&amp;y,&amp;len);
            for(int j=1;j&lt;=p;j++)
            {
                if(pipe[j].x+1==x)t1=j;
                if(pipe[j].x==x+len)t2=j;
            }
            pipe[t1].linkx[++pipe[t1].linkx[0]]=t2;
            pipe[t1].linky[++pipe[t1].linky[0]]=y;
            pipe[t2].linkx[++pipe[t2].linkx[0]]=t1;
            pipe[t2].linky[++pipe[t2].linky[0]]=y;
        }
        scanf("%d%d",&amp;x,&amp;y);
        pipe[x].bj=y;
        if(y&lt;pipe[x].y||y&gt;pipe[x].y+pipe[x].len){printf("No Solution\n");continue;}
        if(ok())printf("%d\n",ans);
        else    printf("No Solution\n");
    }
    return 0;
}</pre>
<p>解题转自：http://blog.csdn.net/wilsonlym/article/details/7578287</p>
<div>
</script>
<!-- acm-hf-01 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-9460629317209118" data-ad-slot="5011774182" style="display:inline-block;width:728px;height:90px"></ins>

(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<div class="bdsharebuttonbox"><a class="bds_more" data-cmd="more" href="#"></a><a class="bds_qzone" data-cmd="qzone" href="#" title="分享到QQ空间"></a><a class="bds_tsina" data-cmd="tsina" href="#" title="分享到新浪微博"></a><a class="bds_tqq" data-cmd="tqq" href="#" title="分享到腾讯微博"></a><a class="bds_renren" data-cmd="renren" href="#" title="分享到人人网"></a><a class="bds_weixin" data-cmd="weixin" href="#" title="分享到微信"></a></div>

</div><ol id="commentlist">
<li class="comment even thread-even depth-1" id="li-comment-12811">
<article class="comment" id="comment-12811">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">bcys</a></span> on <a href="http://www.acmerblog.com/hdu-1366-The-Willy-Memorial-Program-1796.html#comment-12811" rel="nofollow"><time datetime="2015-07-07T15:42:36+00:00" pubdate="">2015年7月7日 at 下午3:42</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>涨姿势了</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-40767">
<article class="comment" id="comment-40767">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">actlea</a></span> on <a href="http://www.acmerblog.com/hdu-1366-The-Willy-Memorial-Program-1796.html#comment-40767" rel="nofollow"><time datetime="2015-05-01T14:28:14+00:00" pubdate="">2015年5月1日 at 下午2:28</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>#include &lt;stdio.h&gt;<br/>
int main()<br/>
{<br/>
    int n,p,t[100]={1};<br/>
    for(int i=1;i&lt;100;i++)<br/>
        t <img src="http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/e6/weiboi_org.gif"/> =i;<br/>
    while(scanf("%d",&amp;n)&amp;&amp;n!=0){<br/>
        if(n==1)<br/>
        printf("Printing order for 1 pages:nSheet 1, front: Blank, 1n");<br/>
        else {<br/>
        if(n%4) p=n/4+1;<br/>
        else p=n/4;<br/>
        int q=4*p;<br/>
        printf("Printing order for %d pages:n",n);<br/>
        for(int i=0;i&lt;p;i++){<br/>
            printf("Sheet %d, front: ",i+1);<br/>
            if(q&gt;n) {printf("Blank, %dn",t[2*i+1]);}<br/>
            else {printf("%d, %dn",q,t[2*i+1]);}<br/>
            q–;//打印表前<br/>
            printf("Sheet %d, back : ",i+1);<br/>
            if(q&gt;n) {printf("%d, Blankn",t[2*i+2]);}<br/>
            else {printf("%d, %dn",t[2*i+2],q);}<br/>
            q–;//打印表后<br/>
           }<br/>
        }<br/>
    }<br/>
    return 0;<br/>
}</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-12805">
<article class="comment" id="comment-12805">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">bai</a></span> on <a href="http://www.acmerblog.com/hdu-1366-The-Willy-Memorial-Program-1796.html#comment-12805" rel="nofollow"><time datetime="2015-02-10T11:43:40+00:00" pubdate="">2015年2月10日 at 上午11:43</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>这个也是算法导论的习题</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-12807">
<article class="comment" id="comment-12807">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">tkdzyl2013</a></span> on <a href="http://www.acmerblog.com/hdu-1366-The-Willy-Memorial-Program-1796.html#comment-12807" rel="nofollow"><time datetime="2014-12-22T08:49:23+00:00" pubdate="">2014年12月22日 at 上午8:49</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>这个也是算法导论的习题</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-40766">
<article class="comment" id="comment-40766">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">sharp</a></span> on <a href="http://www.acmerblog.com/hdu-1366-The-Willy-Memorial-Program-1796.html#comment-40766" rel="nofollow"><time datetime="2014-11-01T05:50:48+00:00" pubdate="">2014年11月1日 at 上午5:50</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>在方法1里面：</p>
<p>    //遍历所有的边，计算入度<br/>
    for(int i=0; i&lt;V; i++)<br/>
  {<br/>
        degree <img src="http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/e6/weiboi_org.gif"/>  = 0;<br/>
        for (j = adj <img src="http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/e6/weiboi_org.gif"/> .begin(); j != adj <img src="http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/e6/weiboi_org.gif"/> .end(); ++j)<br/>
       {<br/>
            degree[*j]++;<br/>
        }<br/>
    }</p>
<p>为什么每遍历一条链表，要首先将每个链表头的顶点的入度置为0呢？<br/>
比如顶点5，若在顶点1、2、3、4的链表中出现过顶点5，那么要增加顶点5的入度，但是在遍历顶点5的链表时，又将顶点5的入度置为0了，那之前的从顶点1234到顶点5的边不是都没了吗？</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-12806">
<article class="comment" id="comment-12806">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">tonight</a></span> on <a href="http://www.acmerblog.com/hdu-1366-The-Willy-Memorial-Program-1796.html#comment-12806" rel="nofollow"><time datetime="2014-10-30T04:33:28+00:00" pubdate="">2014年10月30日 at 上午4:33</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>第一题还有个解释：没说桌子有多大，可以假设桌子和硬币一样大，肯定是先手胜</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-61505">
<article class="comment" id="comment-61505">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">lintong</a></span> on <a href="http://www.acmerblog.com/hdu-1366-The-Willy-Memorial-Program-1796.html#comment-61505" rel="nofollow"><time datetime="2014-10-04T21:36:43+00:00" pubdate="">2014年10月4日 at 下午9:36</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>学习了</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-12810">
<article class="comment" id="comment-12810">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">wangzhenvs123</a></span> on <a href="http://www.acmerblog.com/hdu-1366-The-Willy-Memorial-Program-1796.html#comment-12810" rel="nofollow"><time datetime="2014-08-10T18:48:23+00:00" pubdate="">2014年8月10日 at 下午6:48</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>helpful！！ mark</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-12812">
<article class="comment" id="comment-12812">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">Amber</a></span> on <a href="http://www.acmerblog.com/hdu-1366-The-Willy-Memorial-Program-1796.html#comment-12812" rel="nofollow"><time datetime="2014-07-06T19:30:48+00:00" pubdate="">2014年7月6日 at 下午7:30</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>华为这题目略显简单啊</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-12809">
<article class="comment" id="comment-12809">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">verycourage</a></span> on <a href="http://www.acmerblog.com/hdu-1366-The-Willy-Memorial-Program-1796.html#comment-12809" rel="nofollow"><time datetime="2014-05-09T20:14:07+00:00" pubdate="">2014年5月9日 at 下午8:14</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>换句话说，A[k/2-1]不可能大于两数组合并之后的第k小值，所以我们可以将其抛弃。<br/>
应该是，不可能小于合并后的第K小值吧</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-12804">
<article class="comment" id="comment-12804">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">Riddick</a></span> on <a href="http://www.acmerblog.com/hdu-1366-The-Willy-Memorial-Program-1796.html#comment-12804" rel="nofollow"><time datetime="2014-02-20T04:05:07+00:00" pubdate="">2014年2月20日 at 上午4:05</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>是O(m+n)，不小心打错了</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-12808">
<article class="comment" id="comment-12808">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">super157</a></span> on <a href="http://www.acmerblog.com/hdu-1366-The-Willy-Memorial-Program-1796.html#comment-12808" rel="nofollow"><time datetime="2014-01-08T13:19:11+00:00" pubdate="">2014年1月8日 at 下午1:19</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>这个差别应该不会太大，或许编辑器就自动优化成内联函数了</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
</ol>