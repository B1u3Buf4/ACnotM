<div class="c-top2" id="post-55">
<div class="datetime">2015<br/>05-23</div>
<div class="tit"><h1 class="entry-title">HDU 4269-Defend Jian Ge-模拟-[解题报告]HOJ</h1>
<div class="entry-meta iititle2">
<span class="i2"><a href="http://www.acmerblog.com/author/spiderman" rel="author" title="由蜘蛛侠发布">蜘蛛侠</a></span><span class="i1"><a href="http://www.acmerblog.com/category/search/dfs" rel="category tag" title="查看DFS搜索中的全部文章">DFS搜索</a>, <a href="http://www.acmerblog.com/category/problemset/hdu" rel="category tag" title="查看HDU-杭电中的全部文章">HDU-杭电</a>, <a href="http://www.acmerblog.com/category/basis/simulate" rel="category tag" title="查看模拟法中的全部文章">模拟法</a></span><span class="i4">围观149次</span><span class="i3"><a class="ds-thread-count" data-thread-key="7282" href="http://www.acmerblog.com/hdu-4269-defend-jian-ge-7282.html#comments" title="《HDU 4269-Defend Jian Ge-模拟-[解题报告]HOJ》上的评论">2 条评论</a></span>
</div>
</div>
<div class="cls"></div>
</div><div class="entry-content">
<div>
<h1 class="mytitle mybigtile">Defend Jian Ge</h1>
</div>
<div>
<p class="mytitle"> 问题描述 :</p>
</div>
<div class="mypanel">
Defend Jian Ge, an interesting RPG map in WAR3, has a very complete equipment system as a mini RPG game.<br/>In the game, each player has a backpack which has 6 grids and some gold reserves. There are three kinds of equipments in the game.<br/>1. Normal equipment: Each equipment occupies one grid in the backpack and the player can buy it directly. The value of the normal equipment is equal to its price.<br/>2. Mixture equipment: Each equipment occupies one grid in the backpack and the player can only get it through the synthesis of the corresponding recipe. If you have enough equipment of recipes in your backpack and gold to pay synthesis cost, you can get it. The value of the mixture equipment is equal to the sum of all equipments’ value in the recipe plus the synthesis cost. A mixture equipment can be made from several normal equipments and mixture equipments.<br/>3. Consume equipment: A kind of equipment must occupy one grid and the player can buy it directly. That is to say, if you have a number of consume equipments, they must be in one grid. The value of each consume equipment is equal to its price, and when you want to sell this kind of equipment, you must sell the whole grid’s equipments at the same time.
<p></p><center><img alt="Alice and Bob" src="http://www.acmerblog.com/img/1441022377344.jpg"/></center>
<p>You should pay attention:<br/>1. When the backpack is full, you cannot buy anything.<br/>2. When a mixture equipment is get, the mixture equipment of recipe in you backpack will disappear.<br/>3. If one operation is illegal, there is nothing happened in your backpack and gold.<br/>4. Initially, there is nothing in your backpack and you have 0 gold.<br/>5. The gold you have cannot be a negative number.</p>
<p>As a DS programmer, you want to simulate the dynamic states in your backpack by program. Now you have initial state and several operations, you wonder the final state. </p></div>
<div>
<p class="mytitle"> 输入:</p>
</div>
<div class="mypanel">
There are multiple test cases.<br/>The first line contains an integer N1 (0 &lt;= N1 &lt;= 20) indicating the kind of normal equipment.<br/>The next N1 lines each line contains a string and an integer indicating the name of this normal equipment and its price respectively.<br/>**Format: str num<br/>The following line contains an integer N2 (0 &lt;= N2 &lt;= 20) indicating the kind of mixture equipment.<br/>Each of the next N2 lines begins with a string and an integer indicating the name of this mixture equipment and its synthesis cost. Following, the synthesis recipe of this kind of equipment: some pairs of string and integer indicating which kind of equipment and the number you need to synthesis.<br/>**Format: str num: str1 num1, str2 num2, … , strn numn (num1 + num2 + … +numn&lt;=6 and numi &gt;= 0 (1 &lt;= i &lt;= n))<br/>The next line contains an integer N3 (0 &lt;= N3 &lt;= 20) indicating the kind of consume equipment.<br/>Each of the next N3 lines contains a string and an integer indicating the name of this consume equipment and it’s price.<br/>**Format: str num<br/>The next line contains an integer M (0 &lt;= M &lt;= 100) indicating the number of operation.<br/>Each of the next M lines contains an operation.<br/>There are three kinds of operation:<br/>1. +num indicating you get num gold (0 &lt;= num &lt;= 1000).<br/>2. +str indicating you want to get an equipment whose name is str.<br/>3. -str indicating you want to sell the equipment whose name is str. If you sell the equipment, you can get gold that is the same to its value.
<p>There is a blank line after each case.<br/>All strings of name only contain lowercase character and its length is no more than 15. The price of the equipment is a non-negative integer which is no more than 1000. </p></div>
<div>
<p class="mytitle"> 输出:</p>
</div>
<div class="mypanel">
There are multiple test cases.<br/>The first line contains an integer N1 (0 &lt;= N1 &lt;= 20) indicating the kind of normal equipment.<br/>The next N1 lines each line contains a string and an integer indicating the name of this normal equipment and its price respectively.<br/>**Format: str num<br/>The following line contains an integer N2 (0 &lt;= N2 &lt;= 20) indicating the kind of mixture equipment.<br/>Each of the next N2 lines begins with a string and an integer indicating the name of this mixture equipment and its synthesis cost. Following, the synthesis recipe of this kind of equipment: some pairs of string and integer indicating which kind of equipment and the number you need to synthesis.<br/>**Format: str num: str1 num1, str2 num2, … , strn numn (num1 + num2 + … +numn&lt;=6 and numi &gt;= 0 (1 &lt;= i &lt;= n))<br/>The next line contains an integer N3 (0 &lt;= N3 &lt;= 20) indicating the kind of consume equipment.<br/>Each of the next N3 lines contains a string and an integer indicating the name of this consume equipment and it’s price.<br/>**Format: str num<br/>The next line contains an integer M (0 &lt;= M &lt;= 100) indicating the number of operation.<br/>Each of the next M lines contains an operation.<br/>There are three kinds of operation:<br/>1. +num indicating you get num gold (0 &lt;= num &lt;= 1000).<br/>2. +str indicating you want to get an equipment whose name is str.<br/>3. -str indicating you want to sell the equipment whose name is str. If you sell the equipment, you can get gold that is the same to its value.
<p>There is a blank line after each case.<br/>All strings of name only contain lowercase character and its length is no more than 15. The price of the equipment is a non-negative integer which is no more than 1000.</p></div>
<div>
<p class="mytitle"> 样例输入:</p>
</div>
<pre class="mypanel iopanel">
[pre]2
ring 1
sword 2
1
knife 3: ring 1, sword 1
1
medicine 1
4
+100
+ring
+sword
+knife

1
shoe 0
1
wing 1: 
1
medicine 1
3
+10
+shoe
+wing

1
shoe 0
1
wing 1: 
1
medicine 1
4
+10
+shoe
+wing
-wing

1
shoe 1
1
wing 1: shoe 1
1
medicine 1
8
+100
+shoe
+shoe
+shoe
+shoe
+shoe
+medicine
+medicine

[/pre]</pre>
<div>
<p class="mytitle"> 样例输出:</p>
</div>
<pre class="mypanel iopanel">
[pre]Case 1:
94
1
knife: 1

Case 2:
9
2
shoe: 1
wing: 1

Case 3:
10
1
shoe: 1

Case 4:
94
6
medicine: 1
shoe: 1
shoe: 1
shoe: 1
shoe: 1
shoe: 1

[/pre]</pre>
<p> <!-- problem end --></p>
<p><span style="font-family:'Microsoft YaHei'; font-size:12px">题意：模拟RPG，表示没玩过魔兽的很伤~~<br/>
题解：需要注意的是，</span><span style="line-height:26px; text-align:left"><span style="font-family:'Microsoft YaHei'; font-size:12px">格子只有6个，如果格子满了能得到东西，即使有足够的钱，即使格子里有consume物品也不能买相同的consume物品，但是可以合成需要物品总数<br/>
         不为0的物品。开始想把所有合成的物品的价格处理出来，但是由于给定的顺序不定，合成物品的物品还可能是合成的，这样需要给物品标定等级，dfs太麻烦，想想<br/>
         由于是模拟，合成物品是按照给定的指令来的，在格子中的物品是有价格的，所以没必要处理合成物品的价格了。</span></span></p>
<p><span style="line-height:26px; text-align:left">Sure原创，转载请注明出处。<br/>
</span></p>
<pre class="brush:cpp" name="code">#include &lt;iostream&gt;
#include &lt;cstdio&gt;
#include &lt;memory.h&gt;
#include &lt;string.h&gt;
#include &lt;algorithm&gt;
#define MAX(a , b) ((a) &gt; (b) ? (a) : (b))
using namespace std;
const int maxn = 22;
const int maxm = 8;
struct node
{
    char name[maxn];
    int price;
}th[maxn],consume[maxn];
struct thing
{
    char name[maxn];
    int need,cnt;
    char dic[maxm][maxn];
    int num[maxm];
}com[maxn];
struct SS
{
    char name[maxn];
    int num,price;
    bool valid;
    bool operator &lt; (const SS &amp;other) const
    {
        return strcmp(name , other.name) &lt;= 0;
    }
}bag[maxm];
char str[1000];
int m,n1,n2,n3,top,cas = 0;

int change(char *s)
{
    int res = 0;
    for(int i=0;s[i] != '\0';i++)
    {
        res *= 10;
        res += s[i] - '0';
    }
    return res;
}

void read()
{
    printf("Case %d:\n",++cas);
    for(int i=0;i&lt;n1;i++)
    {
        getchar();
        scanf("%s %d",th[i].name,&amp;th[i].price);
    }
    scanf("%d",&amp;n2);
    getchar();
    for(int i=0;i&lt;n2;i++)
    {
        gets(str);
        char *g = NULL;
        g = strtok(str , ",: \t");
        strcpy(com[i].name , g);
        g = strtok(NULL , ",: \t");
        com[i].need = change(g);
        com[i].cnt = 0;
        g = strtok(NULL , ",: \t");
        while(g != NULL)
        {
            strcpy(com[i].dic[com[i].cnt] , g);
            g = strtok(NULL , ",: \t");
            com[i].num[com[i].cnt++] = change(g);
            g = strtok(NULL , ",: \t");
        }
    }
    scanf("%d",&amp;n3);
    for(int i=0;i&lt;n3;i++)
    {
        getchar();
        scanf("%s %d",consume[i].name,&amp;consume[i].price);
    }
    return;
}

void update()
{
    int j = 0;
    for(int i=0;i&lt;6;i++)
    {
        while(j &lt; 6 &amp;&amp; bag[j].valid)
        {
            j++;
        }
        if(bag[i].valid == false) continue;
        if(i &gt; j)
        {
            bag[j] = bag[i];
            bag[i].valid = false;
            bag[j++].valid = true;
        }
    }
    top = j;
    return;
}

void solve()
{
    scanf("%d",&amp;m);
    getchar();
    int money = 0;
    top = 0;
    for(int i=0;i&lt;6;i++)
    {
        bag[i].valid = bag[i].num = 0;
    }
    while(m--)
    {
        char c = getchar();
        gets(str);
        if(str[0] &gt;= '0' &amp;&amp; str[0] &lt;= '9')
        {
            money += change(str);
        }
        else
        {
            if(c == '+')
            {
                bool flag = false;
                for(int i=0;i&lt;n1;i++)
                {
                    if(strcmp(th[i].name , str) == 0)
                    {
                        flag = true;
                        if(money &gt;= th[i].price)
                        {
                            if(top == 6) break;
                            strcpy(bag[top].name , str);
                            bag[top].num = 1;
                            bag[top].price = th[i].price;
                            bag[top].valid = true;
                            top++;
                            money -= th[i].price;
                        }
                        break;
                    }
                }
                if(flag) continue;
                for(int i=0;i&lt;n2;i++)
                {
                    if(strcmp(com[i].name , str) == 0)
                    {
                        flag = true;
                        if(com[i].need &gt; money) break;
                        bool have = true;
                        int c = 0;
                        for(int j=0;j&lt;com[i].cnt;j++)
                        {
                            c += com[i].num[j];
                            int t = 0;
                            for(int k=0;k&lt;top;k++)
                            {
                                if(strcmp(bag[k].name , com[i].dic[j]) == 0)
                                {
                                    t++;
                                }
                            }
                            if(t &lt; com[i].num[j])
                            {
                                have = false;
                                break;
                            }
                        }
                        if(have &amp;&amp; (top &lt; 6 || c &gt; 0))
                        {
                            money -= com[i].need;
                            int tot = com[i].need;
                            for(int j=0;j&lt;com[i].cnt;j++)
                            {
                                int t = 0;
                                for(int k=0;k&lt;top;k++)
                                {
                                    if(strcmp(bag[k].name , com[i].dic[j]) == 0 &amp;&amp; bag[k].valid)
                                    {
                                        bag[k].valid = false;
                                        tot += bag[k].price;
                                        if(++t == com[i].num[j])
                                        {
                                            break;
                                        }
                                    }
                                }
                            }
                            for(int j=0;j&lt;=top;j++)
                            {
                                if(bag[j].valid == false)
                                {
                                    bag[j].valid = true;
                                    bag[j].num = 1;
                                    strcpy(bag[j].name , com[i].name);
                                    bag[j].price = tot;
                                    if(j == top) top++;
                                    break;
                                }
                            }
                            update();
                        }
                        break;
                    }
                }
                if(flag) continue;
                for(int i=0;i&lt;n3;i++)
                {
                    if(strcmp(consume[i].name , str) == 0)
                    {
                        flag = true;
                        if(money &gt;= consume[i].price)
                        {
                            if(top == 6) break;
                            money -= consume[i].price;
                            bool have = false;
                            for(int j=0;j&lt;top;j++)
                            {
                                if(strcmp(bag[j].name , str) == 0)
                                {
                                    have = true;
                                    bag[j].num++;
                                    bag[j].price += consume[i].price;
                                    break;
                                }
                            }
                            if(have == false)
                            {
                                strcpy(bag[top].name , str);
                                bag[top].num = 1;
                                bag[top].price = consume[i].price;
                                bag[top++].valid = true;
                            }
                        }
                        break;
                    }
                }
            }
            else
            {
                for(int i=0;i&lt;top;i++)
                {
                    if(strcmp(bag[i].name , str) == 0)
                    {
                        bag[i].valid = false;
                        money += bag[i].price;
                        update();
                        break;
                    }
                }
            }
        }
    }
    sort(bag , bag + top);
    printf("%d\n%d\n",money,top);
    for(int i=0;i&lt;top;i++)
    {
        printf("%s: %d\n",bag[i].name,bag[i].num);
    }
    puts("");
    return;
}

int main()
{
    while(~scanf("%d",&amp;n1))
    {
        read();
        solve();
    }
    return 0;
}
</pre>
<p></p>
<div style="padding-top:20px">
<p style="font-size:12px;">版权声明：本文为博主原创文章，未经博主允许不得转载。</p>
</div>
<p>参考：http://blog.csdn.net/flying_stones_sure/article/details/7969446</p>
<div>
</script>
<!-- acm-hf-01 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-9460629317209118" data-ad-slot="5011774182" style="display:inline-block;width:728px;height:90px"></ins>

(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<div class="bdsharebuttonbox"><a class="bds_more" data-cmd="more" href="#"></a><a class="bds_qzone" data-cmd="qzone" href="#" title="分享到QQ空间"></a><a class="bds_tsina" data-cmd="tsina" href="#" title="分享到新浪微博"></a><a class="bds_tqq" data-cmd="tqq" href="#" title="分享到腾讯微博"></a><a class="bds_renren" data-cmd="renren" href="#" title="分享到人人网"></a><a class="bds_weixin" data-cmd="weixin" href="#" title="分享到微信"></a></div>

</div><ol id="commentlist">
<li class="comment even thread-even depth-1" id="li-comment-98940">
<article class="comment" id="comment-98940">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919522947" rel="external nofollow">新用户701128</a></span> on <a href="http://www.acmerblog.com/hdu-4269-defend-jian-ge-7282.html#comment-98940" rel="nofollow"><time datetime="2017-04-20T14:27:53+00:00" pubdate="">2017年4月20日 at 下午2:27</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>报道这新闻都不值得我化妆</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-68646">
<article class="comment" id="comment-68646">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919516862" rel="external nofollow">新用户114991</a></span> on <a href="http://www.acmerblog.com/hdu-4269-defend-jian-ge-7282.html#comment-68646" rel="nofollow"><time datetime="2017-04-11T07:10:17+00:00" pubdate="">2017年4月11日 at 上午7:10</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>菠萝哥顶顶顶</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
</ol>