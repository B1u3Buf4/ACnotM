<div class="c-top2" id="post-55">
<div class="datetime">2015<br/>09-17</div>
<div class="tit"><h1 class="entry-title">HDU 4658-Integer Partition-数论-[解题报告]HOJ</h1>
<div class="entry-meta iititle2">
<span class="i2"><a href="http://www.acmerblog.com/author/spiderman" rel="author" title="由蜘蛛侠发布">蜘蛛侠</a></span><span class="i1"><a href="http://www.acmerblog.com/category/problemset/hdu" rel="category tag" title="查看HDU-杭电中的全部文章">HDU-杭电</a>, <a href="http://www.acmerblog.com/category/math" rel="category tag" title="查看数学相关中的全部文章">数学相关</a>, <a href="http://www.acmerblog.com/category/math/number-theory" rel="category tag" title="查看数论应用中的全部文章">数论应用</a></span><span class="i4">围观89次</span><span class="i3"><a class="ds-thread-count" data-thread-key="7703" href="http://www.acmerblog.com/hdu-4658-integer-partition-7703.html#comments" title="《HDU 4658-Integer Partition-数论-[解题报告]HOJ》上的评论">5 条评论</a></span>
</div>
</div>
<div class="cls"></div>
</div><div class="entry-content">
<div>
<h1 class="mytitle mybigtile">Integer Partition</h1>
</div>
<div>
<p class="mytitle"> 问题描述 :</p>
</div>
<div class="mypanel">
Given n, k, calculate the number of different (unordered) partitions of n such that no part is repeated k or more times.  </div>
<div>
<p class="mytitle"> 输入:</p>
</div>
<div class="mypanel">
First line, number of test cases, T. <br/>Following are T lines. Each line contains two numbers, n and k. 
<p>1&lt;=n,k,T&lt;=10<sup>5</sup> </p></div>
<div>
<p class="mytitle"> 输出:</p>
</div>
<div class="mypanel">
First line, number of test cases, T. <br/>Following are T lines. Each line contains two numbers, n and k. 
<p>1&lt;=n,k,T&lt;=10<sup>5</sup></p></div>
<div>
<p class="mytitle"> 样例输入:</p>
</div>
<pre class="mypanel iopanel">
4
4 2
4 3
4 4
4 5</pre>
<div>
<p class="mytitle"> 样例输出:</p>
</div>
<pre class="mypanel iopanel">
2
4
4
5</pre>
<p> <!-- problem end --></p>
<p>首先要知道五边形定理是什么东西</p>
<p>它揭示了整数划分的母函数是欧拉函数的倒数，欧拉函数可以通过级数表示</p>
<p>P(x)*phi(x)=1  -&gt; p(n)-p(n-1)-p(n-2)+p(n-5)+p(n-7)……=0</p>
<p>
</p>
<pre class="brush:cpp" name="code">#include &lt;iostream&gt;
#include &lt;cstdio&gt;
#include &lt;cstring&gt;
using namespace std;
#define N 100000
#define mod 1000000007
#define ll long long
ll p[N+10];

void init()
{
    p[0]=p[1]=1;
    for(int i=2;i&lt;=N;++i)
    {
        p[i]=0;int x=1;
        for(int k=1,j=1;x&gt;=0;++k,j*=-1)
        {
            x=i-(3*k*k+k)/2;
            if(x&gt;=0) p[i]+=p[x]*j;
            x=i-(3*k*k-k)/2;
            if(x&gt;=0) p[i]+=p[x]*j;
            if(p[i]&gt;=mod||p[i]&lt;0)
                p[i]=(p[i]%mod+mod)%mod;
        }
    }
}

int main ()
{
    init();
    int T;scanf("%d",&amp;T);
    while(T--)
    {
        int n,K;
        scanf("%d%d",&amp;n,&amp;K);
        ll ans=p[n];
        int x=1;
        for(int k=1,j=-1;x&gt;=0;++k,j*=-1)
        {
            x=n-(3*k*k+k)/2*K;
            if(x&gt;=0) ans+=p[x]*j;
            x=n-(3*k*k-k)/2*K;
            if(x&gt;=0) ans+=p[x]*j;
            if(ans&gt;=mod||ans&lt;0)
                ans=(ans%mod+mod)%mod;
        }
        printf("%I64d\n",ans);
    }
    return 0;
}

</pre>
<div style="padding-top:20px">
<p style="font-size:12px;">版权声明：本文为博主原创文章，未经博主允许不得转载。</p>
</div>
<p>参考：http://blog.csdn.net/jackyguo1992/article/details/9870155</p>
<div>
</script>
<!-- acm-hf-01 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-9460629317209118" data-ad-slot="5011774182" style="display:inline-block;width:728px;height:90px"></ins>

(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<div class="bdsharebuttonbox"><a class="bds_more" data-cmd="more" href="#"></a><a class="bds_qzone" data-cmd="qzone" href="#" title="分享到QQ空间"></a><a class="bds_tsina" data-cmd="tsina" href="#" title="分享到新浪微博"></a><a class="bds_tqq" data-cmd="tqq" href="#" title="分享到腾讯微博"></a><a class="bds_renren" data-cmd="renren" href="#" title="分享到人人网"></a><a class="bds_weixin" data-cmd="weixin" href="#" title="分享到微信"></a></div>

</div><ol id="commentlist">
<li class="comment even thread-even depth-1" id="li-comment-97190">
<article class="comment" id="comment-97190">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919521951" rel="external nofollow">新用户064731</a></span> on <a href="http://www.acmerblog.com/hdu-4658-integer-partition-7703.html#comment-97190" rel="nofollow"><time datetime="2017-04-20T00:52:33+00:00" pubdate="">2017年4月20日 at 上午12:52</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>不吃，因为前面有一群刚撸完的圣人在吃枣药丸。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-65319">
<article class="comment" id="comment-65319">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn">美腿高跟</span> on <a href="http://www.acmerblog.com/hdu-4658-integer-partition-7703.html#comment-65319" rel="nofollow"><time datetime="2017-03-28T06:22:29+00:00" pubdate="">2017年3月28日 at 上午6:22</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>ᓁᓁᓁᓁᓁᓁᓁᓁ丝袜女人ᓁᓁᓁᓁᓁᓁᓁᓁᓁᓁᓁᓁᓁᓁᓁᓁ黑色透明丝袜ᓁᓁᓁᓁᓁᓁᓁᓁᓁᓁᓁᓁᓁᓁᓁᓁ古力娜扎t台展美腿ᓁᓁᓁᓁᓁᓁᓁᓁhTtP://6637.meizi1.com</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-65315">
<article class="comment" id="comment-65315">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn">美腿吧</span> on <a href="http://www.acmerblog.com/hdu-4658-integer-partition-7703.html#comment-65315" rel="nofollow"><time datetime="2017-03-27T11:30:31+00:00" pubdate="">2017年3月27日 at 上午11:30</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p> <img src="http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/d7/daxiongjiayouxiong_org.gif"/> <img src="http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/d7/daxiongjiayouxiong_org.gif"/> 双色丝袜 <img src="http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/d7/daxiongjiayouxiong_org.gif"/> <img src="http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/d7/daxiongjiayouxiong_org.gif"/> <img src="http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/d7/daxiongjiayouxiong_org.gif"/> <img src="http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/d7/daxiongjiayouxiong_org.gif"/> 中国丝袜高跟 <img src="http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/d7/daxiongjiayouxiong_org.gif"/> <img src="http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/d7/daxiongjiayouxiong_org.gif"/> <img src="http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/d7/daxiongjiayouxiong_org.gif"/> <img src="http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/d7/daxiongjiayouxiong_org.gif"/> 丝袜会所 <img src="http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/d7/daxiongjiayouxiong_org.gif"/> <img src="http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/d7/daxiongjiayouxiong_org.gif"/> <img src="http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/d7/daxiongjiayouxiong_org.gif"/> <img src="http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/d7/daxiongjiayouxiong_org.gif"/> 张雨绮丝袜 <img src="http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/d7/daxiongjiayouxiong_org.gif"/> <img src="http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/d7/daxiongjiayouxiong_org.gif"/> <a href="http://T.cN/R6ir6dS" rel="nofollow">http://T.cN/R6ir6dS</a></p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-65280">
<article class="comment" id="comment-65280">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://IQOZ.rmb88.cf/" rel="external nofollow">注册立送58元</a></span> on <a href="http://www.acmerblog.com/hdu-4658-integer-partition-7703.html#comment-65280" rel="nofollow"><time datetime="2017-03-25T17:01:27+00:00" pubdate="">2017年3月25日 at 下午5:01</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>领彩金༶新东泰娱乐QQ：3559782115</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-65254">
<article class="comment" id="comment-65254">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://360meimei.com/" rel="external nofollow">胸器</a></span> on <a href="http://www.acmerblog.com/hdu-4658-integer-partition-7703.html#comment-65254" rel="nofollow"><time datetime="2017-03-24T04:37:35+00:00" pubdate="">2017年3月24日 at 上午4:37</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>ꚯ艳门照 徐璐水中精灵写真曝光性感美胸mm520.gq</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
</ol>