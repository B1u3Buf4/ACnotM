<div class="c-top2" id="post-55">
<div class="datetime">2015<br/>09-17</div>
<div class="tit"><h1 class="entry-title">HDU 4732-Round Table-计算几何-[解题报告]HOJ</h1>
<div class="entry-meta iititle2">
<span class="i2"><a href="http://www.acmerblog.com/author/spiderman" rel="author" title="由蜘蛛侠发布">蜘蛛侠</a></span><span class="i1"><a href="http://www.acmerblog.com/category/problemset/hdu" rel="category tag" title="查看HDU-杭电中的全部文章">HDU-杭电</a>, <a href="http://www.acmerblog.com/category/math/combination" rel="category tag" title="查看组合数学中的全部文章">组合数学</a>, <a href="http://www.acmerblog.com/category/geometry/analytic-geometry" rel="category tag" title="查看解析几何中的全部文章">解析几何</a></span><span class="i4">围观84次</span><span class="i3"><a class="ds-thread-count" data-thread-key="7777" href="http://www.acmerblog.com/hdu-4732-round-table-7777.html#comments" title="《HDU 4732-Round Table-计算几何-[解题报告]HOJ》上的评论">10 条评论</a></span>
</div>
</div>
<div class="cls"></div>
</div><div class="entry-content">
<div>
<h1 class="mytitle mybigtile">Round Table</h1>
</div>
<div>
<p class="mytitle"> 问题描述 :</p>
</div>
<div class="mypanel">
I have m little buddies, and tonight we will have a fancy dinner in my room.<br/>Fortunately, I have a round table which is large enough for all my little buddies. (As for me, I will not sit in the round table for some reasons) And the round table is so large that I will not let my little buddies sit shoulder to shoulder.<br/>That means I will select m seats from n seats, and there maximal length of consecutive seats in the original round table won’t be larger than or equal to k. I want know how many different ways I can choose.<br/>Here is one more thing, two ways are considered the same if and only if one can be obtained by rotation.<br/><center><img alt="Minimum palindrome" src="http://www.acmerblog.com/img/1447920214381.jpg" style="max-width:100%;"/></center> <br/>The answer may be very large so the answer should modulo 10<sup>9</sup> + 7. </div>
<div>
<p class="mytitle"> 输入:</p>
</div>
<div class="mypanel">
The first line has a number T (T &lt;= 200) , indicating the number of test cases.<br/>Next each line contain three integer n, m, k (1 &lt;= n &lt;= 10<sup>5</sup>, 1 &lt;= m &lt;= 10<sup>5</sup>, 2 &lt;= k &lt;= 10<sup>5</sup>, m &lt;= n). </div>
<div>
<p class="mytitle"> 输出:</p>
</div>
<div class="mypanel">
The first line has a number T (T &lt;= 200) , indicating the number of test cases.<br/>Next each line contain three integer n, m, k (1 &lt;= n &lt;= 10<sup>5</sup>, 1 &lt;= m &lt;= 10<sup>5</sup>, 2 &lt;= k &lt;= 10<sup>5</sup>, m &lt;= n).</div>
<div>
<p class="mytitle"> 样例输入:</p>
</div>
<pre class="mypanel iopanel">
3
3 1 2
5 2 2
8 3 2</pre>
<div>
<p class="mytitle"> 样例输出:</p>
</div>
<pre class="mypanel iopanel">
Case #1: 1
Case #2: 1
Case #3: 2</pre>
<p> <!-- problem end --></p>
<p><span style="font-family:SimSun; font-size:18px">题目链接::<span style="color:#555555"><span style="line-height:35px"> <a target="_blank">http://acm.hdu.edu.cn/showproblem.php?pid=4732</a></span></span><br/>
代码链接:: <a href="https://github.com/Ronnoc/Training/blob/master/Hdu/4732.cpp" target="_blank">https://github.com/Ronnoc/Training/blob/master/Hdu/4732.cpp</a><br/>
Round Table<br/>
N个点成环,选择M个点,最长连续选取长度要小于K.</span></p>
<p><span style="font-family:SimSun; font-size:18px">(1&lt;=M&lt;=N&lt;=10^5,2&lt;=K&lt;=10^5)<br/>
在旋转同构的意义下种数有多少<br/>
</span></p>
<p><span style="font-family:SimSun; font-size:18px">解:</span></p>
<p><span style="font-family:SimSun; font-size:18px">选取的点称为黑点</span></p>
<p><span style="font-family:SimSun; font-size:18px">不选取的点称为白点</span></p>
<p><span style="font-family:SimSun; font-size:18px">对白点无约束</span></p>
<p><span style="font-family:SimSun; font-size:18px">黑点有M个,白点就有N-M个,特判掉N==M的情况</span></p>
<p><span style="font-family:SimSun; font-size:18px">记n=N-M</span></p>
<p><span style="font-family:SimSun; font-size:18px">对每个白点,以它为起点展开,记第i个起点后黑点的个数为x[i]</span></p>
<p><span style="font-family:SimSun; font-size:18px">则可以转化为x[1]+…+x[n]=M且0&lt;=x[i]&lt;K在旋转同构下的种数</span></p>
<p><span style="font-family:SimSun; font-size:18px">先不考虑旋转同构</span></p>
<p><span style="font-family:SimSun; font-size:18px">我们可以采用容斥原理的办法得到不考虑同构时的结果为Z=∑Comb(n,i)*(-1)^i*z[i]</span></p>
<p><span style="font-family:SimSun; font-size:18px">其中z[j]表示x[1]+…+x[n]=M,x[i]非负且有j个数&gt;=K的种数</span></p>
<p><span style="font-family:SimSun; font-size:18px">以n=8,M=4,K很大为例</span></p>
<p><span style="font-family:SimSun; font-size:18px">在Z中和40000000同构的出现了8次</span></p>
<p><span style="font-family:SimSun; font-size:18px">和11001100同构的出现了4次</span></p>
<p><span style="font-family:SimSun; font-size:18px">和10101010同构的只出现了2次</span></p>
<p><span style="font-family:SimSun; font-size:18px">我们接下来要做的事情就是去重</span></p>
<p><span style="font-family:SimSun; font-size:18px">记g(u)表示以长度u为循环节的种数</span></p>
<p><span style="font-family:SimSun; font-size:18px">记f(u)表示以长度u为最小循环节的种数</span></p>
<p><span style="font-family:SimSun; font-size:18px">有g(u)=∑_{d|u}f(d)</span></p>
<p><span style="font-family:SimSun; font-size:18px">由mobius反演公式可得f(u)=∑_{d|u}\miu[d]*g(u/d)</span></p>
<p><span style="font-family:SimSun; font-size:18px">真正要求的答案是Ans=∑f(i)/i</span></p>
<p><span style="font-family:SimSun; font-size:18px">我们带入并采用一些手段化简公式可以得到</span></p>
<p><span style="font-family:SimSun; font-size:18px">Ans=∑_{u|gcd(n,M)}∑_{d|n/u}\miu[n/(ud)]*g(d)*u/n</span></p>
<p><span style="font-family:SimSun; font-size:18px">这部分可以做的很快了,但是具体的复杂度我也没有花时间去算…</span></p>
<p><span style="font-family:SimSun; font-size:18px"><br/>
</span></p>
<p><span style="font-family:SimSun; font-size:18px">//感谢叉姐告诉,b的我循环节的事情…</span></p>
<div style="padding-top:20px">
<p style="font-size:12px;">版权声明：本文为博主原创文章，未经博主允许不得转载。</p>
</div>
<p>参考：http://blog.csdn.net/ronnoc/article/details/41664303</p>
<div>
</script>
<!-- acm-hf-01 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-9460629317209118" data-ad-slot="5011774182" style="display:inline-block;width:728px;height:90px"></ins>

(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<div class="bdsharebuttonbox"><a class="bds_more" data-cmd="more" href="#"></a><a class="bds_qzone" data-cmd="qzone" href="#" title="分享到QQ空间"></a><a class="bds_tsina" data-cmd="tsina" href="#" title="分享到新浪微博"></a><a class="bds_tqq" data-cmd="tqq" href="#" title="分享到腾讯微博"></a><a class="bds_renren" data-cmd="renren" href="#" title="分享到人人网"></a><a class="bds_weixin" data-cmd="weixin" href="#" title="分享到微信"></a></div>

</div><ol id="commentlist">
<li class="comment even thread-even depth-1" id="li-comment-96960">
<article class="comment" id="comment-96960">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919464326" rel="external nofollow">新用户031296</a></span> on <a href="http://www.acmerblog.com/hdu-4732-round-table-7777.html#comment-96960" rel="nofollow"><time datetime="2017-04-20T00:52:29+00:00" pubdate="">2017年4月20日 at 上午12:52</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>两个都是傻逼 装什么jb</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-96959">
<article class="comment" id="comment-96959">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919464326" rel="external nofollow">新用户031296</a></span> on <a href="http://www.acmerblog.com/hdu-4732-round-table-7777.html#comment-96959" rel="nofollow"><time datetime="2017-04-20T00:52:29+00:00" pubdate="">2017年4月20日 at 上午12:52</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>两个都是傻逼 装什么jb</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-96958">
<article class="comment" id="comment-96958">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919464326" rel="external nofollow">新用户031296</a></span> on <a href="http://www.acmerblog.com/hdu-4732-round-table-7777.html#comment-96958" rel="nofollow"><time datetime="2017-04-20T00:52:29+00:00" pubdate="">2017年4月20日 at 上午12:52</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>两个都是傻逼 装什么jb</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-96957">
<article class="comment" id="comment-96957">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919464326" rel="external nofollow">新用户031296</a></span> on <a href="http://www.acmerblog.com/hdu-4732-round-table-7777.html#comment-96957" rel="nofollow"><time datetime="2017-04-20T00:52:29+00:00" pubdate="">2017年4月20日 at 上午12:52</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>两个都是傻逼 装什么jb</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-96956">
<article class="comment" id="comment-96956">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919464326" rel="external nofollow">新用户031296</a></span> on <a href="http://www.acmerblog.com/hdu-4732-round-table-7777.html#comment-96956" rel="nofollow"><time datetime="2017-04-20T00:52:29+00:00" pubdate="">2017年4月20日 at 上午12:52</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>两个都是傻逼 装什么jb</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-96955">
<article class="comment" id="comment-96955">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919464326" rel="external nofollow">新用户031296</a></span> on <a href="http://www.acmerblog.com/hdu-4732-round-table-7777.html#comment-96955" rel="nofollow"><time datetime="2017-04-20T00:52:29+00:00" pubdate="">2017年4月20日 at 上午12:52</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>两个都是傻逼 装什么jb</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-96954">
<article class="comment" id="comment-96954">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919464326" rel="external nofollow">新用户031296</a></span> on <a href="http://www.acmerblog.com/hdu-4732-round-table-7777.html#comment-96954" rel="nofollow"><time datetime="2017-04-20T00:52:29+00:00" pubdate="">2017年4月20日 at 上午12:52</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>两个都是傻逼 装什么jb</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-96953">
<article class="comment" id="comment-96953">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919464326" rel="external nofollow">新用户031296</a></span> on <a href="http://www.acmerblog.com/hdu-4732-round-table-7777.html#comment-96953" rel="nofollow"><time datetime="2017-04-20T00:52:29+00:00" pubdate="">2017年4月20日 at 上午12:52</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>两个都是傻逼 装什么jb</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-96952">
<article class="comment" id="comment-96952">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919464326" rel="external nofollow">新用户031296</a></span> on <a href="http://www.acmerblog.com/hdu-4732-round-table-7777.html#comment-96952" rel="nofollow"><time datetime="2017-04-20T00:52:29+00:00" pubdate="">2017年4月20日 at 上午12:52</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>两个都是傻逼 装什么jb</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-96951">
<article class="comment" id="comment-96951">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919464326" rel="external nofollow">新用户031296</a></span> on <a href="http://www.acmerblog.com/hdu-4732-round-table-7777.html#comment-96951" rel="nofollow"><time datetime="2017-04-20T00:52:29+00:00" pubdate="">2017年4月20日 at 上午12:52</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>两个都是傻逼 装什么jb</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
</ol>