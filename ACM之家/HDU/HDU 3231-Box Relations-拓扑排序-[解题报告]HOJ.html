<div class="c-top2" id="post-55">
<div class="datetime">2014<br/>03-09</div>
<div class="tit"><h1 class="entry-title">HDU 3231-Box Relations-拓扑排序-[解题报告]HOJ</h1>
<div class="entry-meta iititle2">
<span class="i2"><a href="http://www.acmerblog.com/author/spiderman" rel="author" title="由蜘蛛侠发布">蜘蛛侠</a></span><span class="i1"><a href="http://www.acmerblog.com/category/problemset/hdu" rel="category tag" title="查看HDU-杭电中的全部文章">HDU-杭电</a>, <a href="http://www.acmerblog.com/category/graph/graph-visit" rel="category tag" title="查看图的遍历中的全部文章">图的遍历</a></span><span class="i4">围观903次</span><span class="i3"><a class="ds-thread-count" data-thread-key="5099" href="http://www.acmerblog.com/hdu-3231-box-relations-5099.html#comments" title="《HDU 3231-Box Relations-拓扑排序-[解题报告]HOJ》上的评论">14 条评论</a></span>
</div>
</div>
<div class="cls"></div>
</div><div class="entry-content">
<div>
<h1 class="mytitle mybigtile">Box Relations</h1>
</div>
<div>
<p class="mytitle"> 问题描述 :</p>
</div>
<div class="mypanel">
There are <i>n</i> boxes <i>C<sub>1</sub>, C<sub>2</sub>, …, C<sub>n</sub></i> in 3D space. The edges of the boxes are parallel to the <i>x, y</i> or <i>z</i>-axis. We provide some relations of the boxes, and your task is to construct a set of boxes satisfying all these relations.
<p>There are four kinds of relations (1 &lt;= <i>i,j</i> &lt;= <i>n</i>, <i>i</i> is different from <i>j</i>):
</p><ul>
<li>I i j: The intersection volume of <i>C<sub>i</sub></i> and <i>C<sub>j</sub></i> is positive.</li>
<p>
</p><li>X i j: The intersection volume is zero, and any point inside <i>C<sub>i</sub></i> has smaller <i>x</i>-coordinate than any point inside <i>C<sub>j</sub></i>.</li>
<p>
</p><li>Y i j: The intersection volume is zero, and any point inside <i>C<sub>i</sub></i> has smaller <i>y</i>-coordinate than any point inside <i>C<sub>j</sub></i>.</li>
<p>
</p><li>Z i j: The intersection volume is zero, and any point inside <i>C<sub>i</sub></i> has smaller <i>z</i>-coordinate than any point inside <i>C<sub>j</sub></i>.</li>
</ul>
<p>. </p></div>
<div>
<p class="mytitle"> 输入:</p>
</div>
<div class="mypanel">
There will be at most 30 test cases. Each case begins with a line containing two integers <i>n</i> (1 &lt;= <i>n</i> &lt;= 1,000) and <i>R</i> (0 &lt;= <i>R</i> &lt;= 100,000), the number of boxes and the number of relations. Each of the following <i>R</i> lines describes a relation, written in the format above. The last test case is followed by <i>n</i>=<i>R</i>=0, which should not be processed. </div>
<div>
<p class="mytitle"> 输出:</p>
</div>
<div class="mypanel">
There will be at most 30 test cases. Each case begins with a line containing two integers <i>n</i> (1 &lt;= <i>n</i> &lt;= 1,000) and <i>R</i> (0 &lt;= <i>R</i> &lt;= 100,000), the number of boxes and the number of relations. Each of the following <i>R</i> lines describes a relation, written in the format above. The last test case is followed by <i>n</i>=<i>R</i>=0, which should not be processed.</div>
<div>
<p class="mytitle"> 样例输入:</p>
</div>
<pre class="mypanel iopanel">
3 2
I 1 2
X 2 3
3 3
Z 1 2
Z 2 3
Z 3 1
1 0
0 0</pre>
<div>
<p class="mytitle"> 样例输出:</p>
</div>
<pre class="mypanel iopanel">
Case 1: POSSIBLE
0 0 0 2 2 2
1 1 1 3 3 3
8 8 8 9 9 9

Case 2: IMPOSSIBLE

Case 3: POSSIBLE
0 0 0 1 1 1</pre>
<p> <!-- problem end --></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px">
<strong>题目链接：</strong><a href="http://acm.hdu.edu.cn/showproblem.php?pid=3231" style="color:rgb(202,0,0); text-decoration:none" target="_blank"><span style="color:rgb(51,0,153)">Click here~~</span></a>
</p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px">
<span style="font-weight:bold">题意：</span></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px">
在三维空间内，有n个长方体，棱都与坐标轴平行。给出一些关系，问是否可能，若可能，输出其中的一种。</p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px">
关系有两种：</p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px">
1、某两个长方体相交。</p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px">
2、某个长方体的所有点的某一维的坐标完全小于另一个长方体的任意一点。</p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px">
<strong>解题思路：</strong></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px">
首先，对于棱与坐标轴平行的长方体，在某一维中，它里面的点可以看做包含在长方体的两个平面内，且点的坐标正好在两个平面的坐标的区间内。</p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px">
而题目让我们所求的，正是坐标区间，于是我们可以求平面的坐标来得到。</p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px">
然后，考虑相交的情况，我们可以得出：若某两个长方体相交，当且仅当每一维中，其中的一个长方体的面插进了另一个长方体的内部。</p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px">
<img alt="Box Relations" src="/img/1394721716668.png"/>
</p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px">
我们以 y 轴为例，画出上图，题中的信息只给出了A和B相交，但是我们不知道谁是A，谁是B，</p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px">
所以我们只能得到一些与A、B无关的关系：A1&lt;B2、B1&lt;A2，即一个长方体的左面一定小于另一个长方体的右面。</p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px">
于是我们可以根据这些偏序关系，把长方体的6个面抽象成6个点，对三维分别作拓扑排序，其中每一维只与2个面有关。</p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px">
</p><pre class="brush:cpp ">#include &lt;queue&gt;
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
using namespace std;
#define N 2005

struct T
{
    int v,next;
}E[3][N*100];

struct TT
{
    int head,rd,dep;
}V[3][N];

int top[3],ans,n,m;

void Add_Edge(int k,int u,int v)
{
    E[k][top[k]].v = v;
    E[k][top[k]].next = V[k][u].head;
    V[k][u].head = top[k]++;
    ++V[k][v].rd;
}

bool Top_Sort(int k)
{
    queue&lt;int&gt; Q;
    for(int i=1;i&lt;=n;i++)
        if(V[k][i].rd == 0)
            Q.push(i);
    int cnt = 0;
    while(!Q.empty())
    {
        ++cnt;
        int p = Q.front();
        for(int i=V[k][p].head;i!=NULL;i=E[k][i].next)
        {
            int q = E[k][i].v;
            --V[k][q].rd;
            if(V[k][q].rd == 0)
            {
                Q.push(q);
                V[k][q].dep = V[k][p].dep + 1;
            }
        }
        Q.pop();
    }
    return cnt == n;
}
int main()
{
    int u,v,nn,ncase=0;
    char cmd;
    while(~scanf("%d%d%*c",&amp;nn,&amp;m),nn)
    {
        memset(V,0,sizeof(V));
        top[0] = top[1] = top[2] = 1;
        n = 2*nn;
        for(int k=0;k&lt;3;k++)
            for(int i=1;i&lt;=nn;i++)
                Add_Edge(k,i,i+nn);
        while(m--)
        {
            scanf("%c%d%d%*c",&amp;cmd,&amp;u,&amp;v);
            if(cmd == 'I')
            {
                for(int k=0;k&lt;3;k++)
                {
                    Add_Edge(k,u,v+nn);
                    Add_Edge(k,v,u+nn);
                }
            }
            else
                Add_Edge(cmd-'X',u+nn,v);
        }
        printf("Case %d: ",++ncase);
        if(!Top_Sort(0) || !Top_Sort(1) || !Top_Sort(2))
            puts("IMPOSSIBLE\n");
        else
        {
            puts("POSSIBLE");
            for(int i=1;i&lt;=nn;i++)
                printf("%d %d %d %d %d %d\n",V[0][i].dep,V[1][i].dep,V[2][i].dep,V[0][i+nn].dep,V[1][i+nn].dep,V[2][i+nn].dep);
            puts("");
        }
    }
    return 0;
}</pre>
<p>参考：http://blog.csdn.net/dgq8211/article/details/8038993</p>
<div>
</script>
<!-- acm-hf-01 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-9460629317209118" data-ad-slot="5011774182" style="display:inline-block;width:728px;height:90px"></ins>

(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<div class="bdsharebuttonbox"><a class="bds_more" data-cmd="more" href="#"></a><a class="bds_qzone" data-cmd="qzone" href="#" title="分享到QQ空间"></a><a class="bds_tsina" data-cmd="tsina" href="#" title="分享到新浪微博"></a><a class="bds_tqq" data-cmd="tqq" href="#" title="分享到腾讯微博"></a><a class="bds_renren" data-cmd="renren" href="#" title="分享到人人网"></a><a class="bds_weixin" data-cmd="weixin" href="#" title="分享到微信"></a></div>

</div><ol id="commentlist">
<li class="comment even thread-even depth-1" id="li-comment-78322">
<article class="comment" id="comment-78322">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919460503" rel="external nofollow">新用户962296</a></span> on <a href="http://www.acmerblog.com/hdu-3231-box-relations-5099.html#comment-78322" rel="nofollow"><time datetime="2017-04-12T10:53:30+00:00" pubdate="">2017年4月12日 at 上午10:53</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>感觉楼房养狗应该有用</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-28123">
<article class="comment" id="comment-28123">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">BGPY</a></span> on <a href="http://www.acmerblog.com/hdu-3231-box-relations-5099.html#comment-28123" rel="nofollow"><time datetime="2015-05-28T03:11:03+00:00" pubdate="">2015年5月28日 at 上午3:11</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>能不能说一下tmp数组和solve都是干嘛的？</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-58159">
<article class="comment" id="comment-58159">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">wynk0804</a></span> on <a href="http://www.acmerblog.com/hdu-3231-box-relations-5099.html#comment-58159" rel="nofollow"><time datetime="2015-05-01T13:03:53+00:00" pubdate="">2015年5月1日 at 下午1:03</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>约瑟夫也用说这么长……很成熟的一个问题了，分治的方法解起来o(n)就可以了，有兴趣可以看看具体数学的第一章，关于约瑟夫问题推导出了一系列的结论，很漂亮</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-58153">
<article class="comment" id="comment-58153">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">xiaobei</a></span> on <a href="http://www.acmerblog.com/hdu-3231-box-relations-5099.html#comment-58153" rel="nofollow"><time datetime="2015-04-18T03:09:50+00:00" pubdate="">2015年4月18日 at 上午3:09</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>算法是程序的灵魂，算法分简单和复杂，如果不搞大数据类，程序员了解一下简单点的算法也是可以的，但是会算法的一定要会编程才行，程序员不一定要会算法，利于自己项目需要的可以简单了解。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-58154">
<article class="comment" id="comment-58154">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">ygxqqx</a></span> on <a href="http://www.acmerblog.com/hdu-3231-box-relations-5099.html#comment-58154" rel="nofollow"><time datetime="2015-03-29T23:36:15+00:00" pubdate="">2015年3月29日 at 下午11:36</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>我又来学习了</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-48115">
<article class="comment" id="comment-48115">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">WalkCoder</a></span> on <a href="http://www.acmerblog.com/hdu-3231-box-relations-5099.html#comment-48115" rel="nofollow"><time datetime="2015-03-19T00:21:07+00:00" pubdate="">2015年3月19日 at 上午12:21</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>第23行：<br/>
hash <img src="http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/af/newj_org.gif"/>  = -1是否应该改成hash[s <img src="http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/af/newj_org.gif"/> ] = -1</p>
<p>因为是要把从字符串s的start位到当前位在hash中重置</p>
<p>修改提交后能accept，但是不修改居然也能accept</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-48114">
<article class="comment" id="comment-48114">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">hunangangli</a></span> on <a href="http://www.acmerblog.com/hdu-3231-box-relations-5099.html#comment-48114" rel="nofollow"><time datetime="2015-03-05T00:20:07+00:00" pubdate="">2015年3月5日 at 上午12:20</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>非常好，初学者就应该先理解递归</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-58158">
<article class="comment" id="comment-58158">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">silianbo</a></span> on <a href="http://www.acmerblog.com/hdu-3231-box-relations-5099.html#comment-58158" rel="nofollow"><time datetime="2015-02-06T19:22:22+00:00" pubdate="">2015年2月6日 at 下午7:22</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>给力的文章，例子也非常好</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-48118">
<article class="comment" id="comment-48118">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">qq1005873807</a></span> on <a href="http://www.acmerblog.com/hdu-3231-box-relations-5099.html#comment-48118" rel="nofollow"><time datetime="2014-12-19T01:46:47+00:00" pubdate="">2014年12月19日 at 上午1:46</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>very good solutions.</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-48116">
<article class="comment" id="comment-48116">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">Sacomplex</a></span> on <a href="http://www.acmerblog.com/hdu-3231-box-relations-5099.html#comment-48116" rel="nofollow"><time datetime="2014-11-18T13:47:05+00:00" pubdate="">2014年11月18日 at 下午1:47</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>原来欧几里德定理应用这么多</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-58156">
<article class="comment" id="comment-58156">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">gy910210</a></span> on <a href="http://www.acmerblog.com/hdu-3231-box-relations-5099.html#comment-58156" rel="nofollow"><time datetime="2014-11-05T19:17:30+00:00" pubdate="">2014年11月5日 at 下午7:17</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>很强大啊，佩服</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-58157">
<article class="comment" id="comment-58157">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">xrjervis</a></span> on <a href="http://www.acmerblog.com/hdu-3231-box-relations-5099.html#comment-58157" rel="nofollow"><time datetime="2014-09-27T06:54:45+00:00" pubdate="">2014年9月27日 at 上午6:54</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>代码是给出了，但是解析的也太不清晰了吧！如 13 abejkcfghid jkebfghicda<br/>
第一步拆分为 三部分 (bejk, cfghi, d) * C(13,3)，为什么要这样拆分，原则是什么？</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-58155">
<article class="comment" id="comment-58155">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">Baifern</a></span> on <a href="http://www.acmerblog.com/hdu-3231-box-relations-5099.html#comment-58155" rel="nofollow"><time datetime="2014-07-11T09:06:59+00:00" pubdate="">2014年7月11日 at 上午9:06</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>第一个真的要比较两次吗，换成else if 不可以吗</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-48117">
<article class="comment" id="comment-48117">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">0xc0de</a></span> on <a href="http://www.acmerblog.com/hdu-3231-box-relations-5099.html#comment-48117" rel="nofollow"><time datetime="2014-03-14T11:52:54+00:00" pubdate="">2014年3月14日 at 上午11:52</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>嗯   分析得很到位，确实用模板编程能让面试官对你的印象更好。在设置辅助栈的时候可以这样：push时，比较要push的elem和辅助栈的栈顶，elem&lt;=min.top()，则min.push(elem).否则只要push（elem）就好。在pop的时候，比较stack.top()与min.top(),if(stack.top()&lt;=min.top()),则{stack.pop();min.pop();}，否则{stack.pop();}.</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
</ol>