<div class="c-top2" id="post-55">
<div class="datetime">2015<br/>09-17</div>
<div class="tit"><h1 class="entry-title">HDU 4675-GCD of Sequence-组合数学-[解题报告]HOJ</h1>
<div class="entry-meta iititle2">
<span class="i2"><a href="http://www.acmerblog.com/author/spiderman" rel="author" title="由蜘蛛侠发布">蜘蛛侠</a></span><span class="i1"><a href="http://www.acmerblog.com/category/problemset/hdu" rel="category tag" title="查看HDU-杭电中的全部文章">HDU-杭电</a>, <a href="http://www.acmerblog.com/category/math" rel="category tag" title="查看数学相关中的全部文章">数学相关</a>, <a href="http://www.acmerblog.com/category/math/combination" rel="category tag" title="查看组合数学中的全部文章">组合数学</a></span><span class="i4">围观72次</span><span class="i3"><a class="ds-thread-count" data-thread-key="7720" href="http://www.acmerblog.com/hdu-4675-gcd-of-sequence-7720.html#comments" title="《HDU 4675-GCD of Sequence-组合数学-[解题报告]HOJ》上的评论">一条评论</a></span>
</div>
</div>
<div class="cls"></div>
</div><div class="entry-content">
<h1 style="color:rgb(26,92,200); text-align:center; font-family:'Times New Roman'">
GCD of Sequence</h1>
<p><span style="font-family:'Times New Roman'; font-size:14px"><strong><span style="font-family:Arial; font-size:12px; color:green">Time Limit: 6000/3000 MS (Java/Others)    Memory Limit: 65535/65535 K (Java/Others)<br/>
Total Submission(s): 209    Accepted Submission(s): 65<br/>
</span></strong></span><br style="font-family:'Times New Roman'; font-size:14px"/><br/>
<br style="font-family:'Times New Roman'; font-size:14px"/></p>
<div align="left" class="panel_title" style="height:38px; background-color:transparent; padding:0px 14px; color:rgb(124,169,237); font-size:18px; font-family:Arial; font-weight:bold">
Problem Description</div>
<div class="panel_content" style="height:auto; margin:0px; padding:0px 20px; font-size:14px; font-family:'Times New Roman'">
Alice is playing a game with Bob.<br/>
Alice shows N integers a<sub>1</sub>, a<sub>2</sub>, …, a<sub>N</sub>, and M, K. She says each integers 1 ≤ a<sub>i</sub> ≤ M.<br/>
And now Alice wants to ask for each d = 1 to M, how many different sequences b<sub>1</sub>, b<sub>2</sub>, …, b<sub>N</sub>. which satisfies :<br/>
1. For each i = 1…N, 1 ≤ b[i] ≤ M<br/>
2. gcd(b<sub>1</sub>, b<sub>2</sub>, …, b<sub>N</sub>) = d<br/>
3. There will be exactly K position i that ai != bi (1 ≤ i ≤ n)
<p>Alice thinks that the answer will be too large. In order not to annoy Bob, she only wants to know the answer modulo 1000000007.Bob can not solve the problem. Now he asks you for HELP!<br/>
<strong>Notes</strong>: gcd(x<sub>1</sub>, x<sub>2</sub>, …, x<sub>n</sub>) is the greatest common divisor of x<sub>1</sub>, x<sub>2</sub>, …, x<sub>n</sub></p></div>
<div class="panel_bottom" style="height:auto; margin:0px; font-family:'Times New Roman'; font-size:14px">
 </div>
<p><br style="font-family:'Times New Roman'; font-size:14px"/></p>
<div align="left" class="panel_title" style="height:38px; background-color:transparent; padding:0px 14px; color:rgb(124,169,237); font-size:18px; font-family:Arial; font-weight:bold">
Input</div>
<div class="panel_content" style="height:auto; margin:0px; padding:0px 20px; font-size:14px; font-family:'Times New Roman'">
The input contains several test cases, terminated by EOF.<br/>
The first line of each test contains three integers N, M, K. (1 ≤ N, M ≤ 300000, 1 ≤ K ≤ N)<br/>
The second line contains N integers: a<sub>1</sub>, a<sub>2</sub>, …, a<sub>n</sub> (1 ≤ a<sub>i</sub> ≤ M) which is original sequence.
</div>
<div class="panel_bottom" style="height:auto; margin:0px; font-family:'Times New Roman'; font-size:14px">
 </div>
<p><br style="font-family:'Times New Roman'; font-size:14px"/></p>
<div align="left" class="panel_title" style="height:38px; background-color:transparent; padding:0px 14px; color:rgb(124,169,237); font-size:18px; font-family:Arial; font-weight:bold">
Output</div>
<div class="panel_content" style="height:auto; margin:0px; padding:0px 20px; font-size:14px; font-family:'Times New Roman'">
For each test contains 1 lines :<br/>
The line contains M integer, the i-th integer is the answer shows above when d is the i-th number.</div>
<div class="panel_bottom" style="height:auto; margin:0px; font-family:'Times New Roman'; font-size:14px">
 </div>
<p><br style="font-family:'Times New Roman'; font-size:14px"/></p>
<div align="left" class="panel_title" style="height:38px; background-color:transparent; padding:0px 14px; color:rgb(124,169,237); font-size:18px; font-family:Arial; font-weight:bold">
Sample Input</div>
<div class="panel_content" style="height:auto; margin:0px; padding:0px 20px; font-size:14px; font-family:'Times New Roman'">
<pre style="margin-top:0px; margin-bottom:0px"><div style="font-family:'Courier New',Courier,monospace">3 3 3
3 3 3
3 5 3
1 2 3</div></pre>
</div>
<div class="panel_bottom" style="height:auto; margin:0px; font-family:'Times New Roman'; font-size:14px">
 </div>
<p><br style="font-family:'Times New Roman'; font-size:14px"/></p>
<div align="left" class="panel_title" style="height:38px; background-color:transparent; padding:0px 14px; color:rgb(124,169,237); font-size:18px; font-family:Arial; font-weight:bold">
Sample Output</div>
<div class="panel_content" style="height:auto; margin:0px; padding:0px 20px; font-size:14px; font-family:'Times New Roman'">
<pre style="margin-top:0px; margin-bottom:0px"><div style="font-family:'Courier New',Courier,monospace">7 1 0
59 3 0 1 1
<div style="font-family:'Times New Roman'; background-color:rgb(244,251,255); border:1px dashed rgb(183,203,255); padding:6px"><div style="font-family:Arial; font-weight:bold; color:rgb(124,169,237); border-bottom-color:rgb(183,203,255); border-bottom-width:1px; border-bottom-style:dashed"><em>Hint</em></div>
In the first test case :
when d = 1, {b} can be :
(1, 1, 1)
(1, 1, 2)
(1, 2, 1)
(1, 2, 2)
(2, 1, 1)
(2, 1, 2)
(2, 2, 1)
when d = 2, {b} can be :
(2, 2, 2)
And because {b} must have exactly K number(s) different from {a}, so {b} can't be (3, 3, 3), so Answer = 0
</div><span style="font-size:1px"> </span></div></pre>
</div>
<div class="panel_bottom" style="height:auto; margin:0px; font-family:'Times New Roman'; font-size:14px">
 </div>
<p><br style="font-family:'Times New Roman'; font-size:14px"/></p>
<div align="left" class="panel_title" style="height:38px; background-color:transparent; padding:0px 14px; color:rgb(124,169,237); font-size:18px; font-family:Arial; font-weight:bold">
Source</div>
<div class="panel_content" style="height:auto; margin:0px; padding:0px 20px; font-size:14px; font-family:'Times New Roman'">
<a href="http://acm.hdu.edu.cn/search.php?field=problem&amp;key=2013%20Multi-University%20Training%20Contest%207&amp;source=1&amp;searchmode=source" style="color:rgb(26,92,200); text-decoration:none" target="_blank">2013 Multi-University Training Contest<br/>
 7</a></div>
<div class="panel_bottom" style="height:auto; margin:0px; font-family:'Times New Roman'; font-size:14px">
 </div>
<p><br style="font-family:'Times New Roman'; font-size:14px"/></p>
<div align="left" class="panel_title" style="height:38px; background-color:transparent; padding:0px 14px; color:rgb(124,169,237); font-size:18px; font-family:Arial; font-weight:bold">
Recommend</div>
<div class="panel_content" style="height:auto; margin:0px; padding:0px 20px; font-size:14px; font-family:'Times New Roman'">
zhuyuanchen520</div>
<div class="panel_bottom" style="height:auto; margin:0px; font-family:'Times New Roman'; font-size:14px">
 </div>
<div>题意： 有三个数N, M, K， 然后N个特定序列。  从这特定的序列里改变K个数字， 取值范围为 [1，M]。 然后求出各序列的最大公约数为1~m分别多少个。</div>
<div>
</div>
<div>思路： 组合数学</div>
<div>公式：  <img alt="GCD of Sequence" src="http://cdn.acmerblog.com/img/1447883070331.jpg"/></div>
<div>只是总的。 但是ans(i) 包括了 ans(2 * i)  ans(3 * i) ……</div>
<div>所以要一一减去。</div>
<div>公式推到过程</div>
<div>前提： 每次一定要刚好改变k个数字。</div>
<div>特定序列中有N – sumb个不是i的倍数。 那么要使整个序列的最大公约数是i， 那只能是将 N – sumb都变为是 i的公倍数。  </div>
<div>如果 N – sumb &gt; K 就无法实现。 ans(i) = 0;</div>
<div>否则将所有不是 i 的公倍数的变为i的公倍数。  对于每一个数字， 都有 m / i 种可能。  所以 就有  (m / i) ^ (n – sumb);</div>
<div>然后还需要改变 k – (N – sumb) 次。</div>
<div>就是要在i的公倍数中选出k – (N – sumb)。C(sumb, k – (n – sumb)). </div>
<div>然后对于每个数字有 m / i – 本身 种可能。  所以就是  (m / i – 1) ^ (k – (n – sumb)) * C(sumb, k – (n – sumb));</div>
<div>对于除法取模还需要用到费马小定理： a ^ (p – 1) % p = 1;  -&gt;   a ^ (p – 2) % p = (1 / a) % p;</div>
<div>
<pre class="brush:cpp" name="code">#include &lt;cstdio&gt;
#include &lt;cstring&gt;
#include &lt;algorithm&gt;
using namespace std;

//

const int V = 300000 + 50;
const int inf = 0x7fffffff;
const int mod = 1000000000 + 7;
int n, m, k;
int sum[V];
__int64 ans[V], d[V], e[V];
__int64 Quick_Pow(__int64 a, __int64 b) {
    __int64 res = 1;
    while(b) {
        if(b &amp; 1)
            res = (res * a) % mod;
        b /= 2;
        a = (a * a) % mod;
    }
    return res % mod;
}
__int64 Cal(__int64 n, __int64 k) {
    return (d[n] * e[k] % mod) * e[n - k] % mod;
}
int main() {
    int i, j;
    d[0] = e[0] = 1;
    for(i = 1; i &lt; V; ++i) {
        d[i] = (d[i - 1] * i) % mod;
        e[i] = Quick_Pow(d[i], mod - 2);
    }
    while(~scanf("%d%d%d", &amp;n, &amp;m, &amp;k)) {
        memset(sum, 0, sizeof(sum));
        for(i = 0; i &lt; n; ++i) {
            int temp;
            scanf("%d", &amp;temp);
            sum[temp]++;
        }
        for(i = m; i &gt;= 1; --i) {
            int sum_d = 0;
            for(j = i; j &lt;= m; j += i)
                sum_d += sum[j];
            if(n - sum_d &gt; k) {
                ans[i] = 0;
                continue;
            }
            ans[i] = (Quick_Pow(m / i, n - sum_d) * Quick_Pow(m / i - 1, k - (n - sum_d)) % mod) * Cal(sum_d, k - (n - sum_d)) % mod;
            //减去重复的
            for(j = 2 * i; j &lt;= m; j += i)
                ans[i] = (ans[i] - ans[j] + mod) % mod;
        }
        for(i = 1; i &lt; m; ++i)
            printf("%I64d ", ans[i]);
        printf("%I64d\n", ans[m]);
    }
}
</pre>
</div>
<div style="padding-top:20px">
<p style="font-size:12px;">版权声明：本文为博主原创文章，未经博主允许不得转载。</p>
</div>
<p>参考：http://blog.csdn.net/dongdongzhang_/article/details/9961529</p>
<div>
</script>
<!-- acm-hf-01 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-9460629317209118" data-ad-slot="5011774182" style="display:inline-block;width:728px;height:90px"></ins>

(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<div class="bdsharebuttonbox"><a class="bds_more" data-cmd="more" href="#"></a><a class="bds_qzone" data-cmd="qzone" href="#" title="分享到QQ空间"></a><a class="bds_tsina" data-cmd="tsina" href="#" title="分享到新浪微博"></a><a class="bds_tqq" data-cmd="tqq" href="#" title="分享到腾讯微博"></a><a class="bds_renren" data-cmd="renren" href="#" title="分享到人人网"></a><a class="bds_weixin" data-cmd="weixin" href="#" title="分享到微信"></a></div>

</div><ol id="commentlist">
<li class="comment even thread-even depth-1" id="li-comment-97175">
<article class="comment" id="comment-97175">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919466740" rel="external nofollow">新用户331337</a></span> on <a href="http://www.acmerblog.com/hdu-4675-gcd-of-sequence-7720.html#comment-97175" rel="nofollow"><time datetime="2017-04-20T00:52:33+00:00" pubdate="">2017年4月20日 at 上午12:52</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>不小心又暴露年龄了</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
</ol>