<div class="c-top2" id="post-55">
<div class="datetime">2014<br/>03-23</div>
<div class="tit"><h1 class="entry-title">HDU 3414-Tour Route-连通性问题-[解题报告]HOJ</h1>
<div class="entry-meta iititle2">
<span class="i2"><a href="http://www.acmerblog.com/author/spiderman" rel="author" title="由蜘蛛侠发布">蜘蛛侠</a></span><span class="i1"><a href="http://www.acmerblog.com/category/search/dfs" rel="category tag" title="查看DFS搜索中的全部文章">DFS搜索</a>, <a href="http://www.acmerblog.com/category/problemset/hdu" rel="category tag" title="查看HDU-杭电中的全部文章">HDU-杭电</a>, <a href="http://www.acmerblog.com/category/graph/connectivity" rel="category tag" title="查看连通性问题中的全部文章">连通性问题</a></span><span class="i4">围观588次</span><span class="i3"><a class="ds-thread-count" data-thread-key="5440" href="http://www.acmerblog.com/hdu-3414-tour-route-5440.html#comments" title="《HDU 3414-Tour Route-连通性问题-[解题报告]HOJ》上的评论">14 条评论</a></span>
</div>
</div>
<div class="cls"></div>
</div><div class="entry-content">
<div>
<h1 class="mytitle mybigtile">Tour Route</h1>
</div>
<div>
<p class="mytitle"> 问题描述 :</p>
</div>
<div class="mypanel">
The city is so crowded that the mayor can’t bear any longer. He issued an order to change all the roads into one-way street. The news is terrible for Jack, who is the director of a tourism company, because he has to change the travel route. All tourists want to set out from one scenic spot, then go to every scenic spots once and only once and finally return to the starting spot. They don’t care about which spot to start from, but they won’t go back to the starting spot before they have visited all other spots. Fortunately, the roads in the city have been perfectly built and any two scenic spots have been connected by ONE road directly. Jack gives the map of the city to you, and your task is to arrange a new travel route around the city which can satisfy the tourists. </div>
<div>
<p class="mytitle"> 输入:</p>
</div>
<div class="mypanel">
Input consists of multiple test cases and ends with a line of “0”.<br/>For each test case:<br/>The first line contains a single integer n (0&lt;n&lt;=1000), representing the number of city scenic spots. Scenic spots are numbered form 1 to n.<br/>Then n lines follows, and each line consists of n integers. These n lines make a matrix. If the element in the ith row and the jth column is 1(i≠j), it means that the direction of the road between spot i and spot j is from spot i to spot j. If that element is 0, it means that the road’s direction is from spot j to spot i.  The numbers in the main diagonal of the matrix are all 0. (i and j start from 1) </div>
<div>
<p class="mytitle"> 输出:</p>
</div>
<div class="mypanel">
Input consists of multiple test cases and ends with a line of “0”.<br/>For each test case:<br/>The first line contains a single integer n (0&lt;n&lt;=1000), representing the number of city scenic spots. Scenic spots are numbered form 1 to n.<br/>Then n lines follows, and each line consists of n integers. These n lines make a matrix. If the element in the ith row and the jth column is 1(i≠j), it means that the direction of the road between spot i and spot j is from spot i to spot j. If that element is 0, it means that the road’s direction is from spot j to spot i.  The numbers in the main diagonal of the matrix are all 0. (i and j start from 1)</div>
<div>
<p class="mytitle"> 样例输入:</p>
</div>
<pre class="mypanel iopanel">
5
0 0 1 1 1 
1 0 1 1 0 
0 0 0 1 0 
0 0 0 0 1 
0 1 1 0 0
2
0 1
0 0
0</pre>
<div>
<p class="mytitle"> 样例输出:</p>
</div>
<pre class="mypanel iopanel">
1 3 4 5 2
-1</pre>
<p> <!-- problem end --><br/>
			Tour Route<br/>
Time Limit:<br/>
20000/10000 MS<br/>
(Java/Others)    Memory<br/>
Limit: 32768/32768 K (Java/Others)<br/>
Total Submission(s):<br/>
466    Accepted<br/>
Submission(s): 80<br/>
Special Judge<br/>
Problem Description<br/>
The city is so crowded that the mayor can’t bear any longer.<br/>
He issued an order to change all the roads into one-way street. The<br/>
news is terrible for Jack, who is the director of a tourism<br/>
company, because he has to change the travel route. All tourists<br/>
want to set out from one scenic spot, then go to every scenic spots<br/>
once and only once and finally return to the starting spot. They<br/>
don’t care about which spot to start from, but they won’t go back<br/>
to the starting spot before they have visited all other spots.<br/>
Fortunately, the roads in the city have been perfectly built and<br/>
any two scenic spots have been connected by ONE road directly. Jack<br/>
gives the map of the city to you, and your task is to arrange a new<br/>
travel route around the city which can satisfy the tourists.<br/>
Input<br/>
Input consists of multiple test cases and ends with a line of<br/>
“0”.<br/>
For each test case:<br/>
The first line contains a single integer n (0<br/>
Then n lines follows, and each line consists of n integers. These n<br/>
lines make a matrix. If the element in the ith row and the jth<br/>
column is 1(i≠j), it means that the direction of the road between<br/>
spot i and spot j is from spot i to spot j. If that element is 0,<br/>
it means that the road’s direction is from spot j to spot i. The<br/>
numbers in the main diagonal of the matrix are all 0. (i and j<br/>
start from 1)<br/>
Output<br/>
For each test case, print all the spots No. according to the<br/>
traveling order of the route in one line. If multiple routes exist,<br/>
just print one of them. If no such route exists, print a “-1”<br/>
instead. Because the starting spot is the same as the ending spot,<br/>
so you don’t need to print the ending spot.<br/>
This problem needs special judge.<br/>
Sample Input<br/>
5<br/>
0 0 1 1<br/>
1<br/>
1 0 1 1<br/>
0<br/>
0 0 0 1<br/>
0<br/>
0 0 0 0<br/>
1<br/>
0 1 1 0<br/>
0<br/>
2<br/>
0 1<br/>
0 0<br/>
0<br/>
Sample Output<br/>
1 3 4 5<br/>
2<br/>
-1<br/>
======================================================================================<br/>
这道题到现在我心里还是虚的，poj3780明明是同一道题，相同的代码却wa了，让我怀疑自己是占特判数据的便宜水过的。<br/>
这道题首先想到的方法是暴力深搜，不出所料的tle了。<br/>
后来做了优化，竞赛图当且仅当强连通时是汉密尔顿图，于是我用Tarjan先把不是汉密尔顿图的去掉。<br/>
Tarjan是线性效率所以我并不担心。<br/>
然后我把入度为1的点跟它唯一的前驱缩成一个点，把出度为1的点跟它的唯一后继缩成一个点，还是深搜。<br/>
依然超时，看来深搜是怎么都不行了。<br/>
后来我看到了这个：http://blog.sina.com.cn/s/blog_8d84b9240101fdwj.html<br/>
于是有了下面的代码。<br/>
======================================================================================<br/>
#include&lt;cstdio&gt;<br/>
const int N = 1000;<br/>
bool g[N][N];<br/>
int n , next[N];<br/>
bool expand( int s )<br/>
{<br/>
    for( int i = 0 ; i<br/>
&lt; n ; next[i++] = -1 );<br/>
    int front = s , back =<br/>
front;<br/>
    for( int i = 0 ; i<br/>
&lt; n ; i++ )<br/>
    {<br/>
  if( i == s )  <br/>
 continue;<br/>
  if( g[i][front] )   next[i] =<br/>
front , front = i;<br/>
  else<br/>
  {<br/>
      int a =<br/>
front , b = next[front];<br/>
      while( b<br/>
!= -1 &amp;&amp; g[b][i] )<br/>
    a = b , b = next[b];<br/>
      next[a] =<br/>
i;<br/>
      next[i] =<br/>
b;<br/>
      if( b ==<br/>
-1 )   back = i;<br/>
  }<br/>
    }<br/>
    if( g[back][front]<br/>
)<br/>
    {<br/>
  next[back] = front;<br/>
  return true;<br/>
    }<br/>
    return false;<br/>
}<br/>
bool solve()<br/>
{<br/>
    for( int i = 0 ; i<br/>
&lt; n ; i++ )<br/>
  if( expand(i) )  return<br/>
true;<br/>
    return false;<br/>
}<br/>
int main()<br/>
{<br/>
    while(<br/>
scanf(“%d”,&amp;n) , n )<br/>
    {<br/>
  for( int i = 0 ; i &lt; n ; i++<br/>
)<br/>
      for( int j<br/>
= 0 ; j &lt; n ; j++ )<br/>
scanf(“%d”,&amp;g[i][j]);<br/>
  if( n == 1 )   puts(“1″);<br/>
  else if( n == 2 || !solve() )  <br/>
 puts(“-1″);<br/>
  else<br/>
      for( int i<br/>
= 0 , j = 0 ; i &lt; n ; i++ , j = next[j] )<br/>
printf(“%d%c”,j+1,i==n-1?’\n’:’ ‘);<br/>
    }<br/>
    return 0;<br/>
}<br/>
参考：http://blog.sina.com.cn/s/blog_8d84b9240101fdwh.html</p>
<div>
</script>
<!-- acm-hf-01 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-9460629317209118" data-ad-slot="5011774182" style="display:inline-block;width:728px;height:90px"></ins>

(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<div class="bdsharebuttonbox"><a class="bds_more" data-cmd="more" href="#"></a><a class="bds_qzone" data-cmd="qzone" href="#" title="分享到QQ空间"></a><a class="bds_tsina" data-cmd="tsina" href="#" title="分享到新浪微博"></a><a class="bds_tqq" data-cmd="tqq" href="#" title="分享到腾讯微博"></a><a class="bds_renren" data-cmd="renren" href="#" title="分享到人人网"></a><a class="bds_weixin" data-cmd="weixin" href="#" title="分享到微信"></a></div>

</div><ol id="commentlist">
<li class="comment even thread-even depth-1" id="li-comment-29515">
<article class="comment" id="comment-29515">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">yesMan</a></span> on <a href="http://www.acmerblog.com/hdu-3414-tour-route-5440.html#comment-29515" rel="nofollow"><time datetime="2015-07-01T15:39:06+00:00" pubdate="">2015年7月1日 at 下午3:39</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>对，就是把这32位当成一个长度为32的数</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-29519">
<article class="comment" id="comment-29519">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">skyand</a></span> on <a href="http://www.acmerblog.com/hdu-3414-tour-route-5440.html#comment-29519" rel="nofollow"><time datetime="2015-06-09T00:41:26+00:00" pubdate="">2015年6月9日 at 上午12:41</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>如何解决overload的问题呢？</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-29514">
<article class="comment" id="comment-29514">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">Supermaner</a></span> on <a href="http://www.acmerblog.com/hdu-3414-tour-route-5440.html#comment-29514" rel="nofollow"><time datetime="2015-05-13T00:10:35+00:00" pubdate="">2015年5月13日 at 上午12:10</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>正解，应该是200！</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-48869">
<article class="comment" id="comment-48869">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">gaoriqiang2</a></span> on <a href="http://www.acmerblog.com/hdu-3414-tour-route-5440.html#comment-48869" rel="nofollow"><time datetime="2015-03-20T16:06:18+00:00" pubdate="">2015年3月20日 at 下午4:06</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>感谢分享 学习了`(*∩_∩*)′</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-29516">
<article class="comment" id="comment-29516">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">jintianya</a></span> on <a href="http://www.acmerblog.com/hdu-3414-tour-route-5440.html#comment-29516" rel="nofollow"><time datetime="2015-01-20T06:16:39+00:00" pubdate="">2015年1月20日 at 上午6:16</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>能不能说一下tmp数组和solve都是干嘛的？</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-48867">
<article class="comment" id="comment-48867">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">ruoshui</a></span> on <a href="http://www.acmerblog.com/hdu-3414-tour-route-5440.html#comment-48867" rel="nofollow"><time datetime="2014-11-11T14:01:27+00:00" pubdate="">2014年11月11日 at 下午2:01</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>思路二可以用一个长度为k的队列来实现，入队后判断下队尾元素的next指针是否为空，若为空，则出队指针即为所求。</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-29512">
<article class="comment" id="comment-29512">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">xiao1108</a></span> on <a href="http://www.acmerblog.com/hdu-3414-tour-route-5440.html#comment-29512" rel="nofollow"><time datetime="2014-10-27T19:00:27+00:00" pubdate="">2014年10月27日 at 下午7:00</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>代码不对，仔细对比一下输入输出， 怎么会有‘‘printf("The winning moves are:");’’这种输出呢？</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-48868">
<article class="comment" id="comment-48868">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">anshansh</a></span> on <a href="http://www.acmerblog.com/hdu-3414-tour-route-5440.html#comment-48868" rel="nofollow"><time datetime="2014-10-21T06:32:59+00:00" pubdate="">2014年10月21日 at 上午6:32</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>终于明白了递归和dp的关系，多谢分享！</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-58503">
<article class="comment" id="comment-58503">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">jade1827</a></span> on <a href="http://www.acmerblog.com/hdu-3414-tour-route-5440.html#comment-58503" rel="nofollow"><time datetime="2014-09-15T20:31:18+00:00" pubdate="">2014年9月15日 at 下午8:31</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>正有此意，欢迎更多的建议~</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-29517">
<article class="comment" id="comment-29517">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">MCIT</a></span> on <a href="http://www.acmerblog.com/hdu-3414-tour-route-5440.html#comment-29517" rel="nofollow"><time datetime="2014-09-01T20:17:56+00:00" pubdate="">2014年9月1日 at 下午8:17</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>程序是对的。有些地方用了C++的写法</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-29518">
<article class="comment" id="comment-29518">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">qq1005873807</a></span> on <a href="http://www.acmerblog.com/hdu-3414-tour-route-5440.html#comment-29518" rel="nofollow"><time datetime="2014-08-20T14:50:07+00:00" pubdate="">2014年8月20日 at 下午2:50</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>
	Hello Web Admin, I noticed that your On-Page SEO is is missing a few factors, for one you do not use all three H tags in your post, also I notice that you are not using bold or italics properly in your SEO optimization. On-Page SEO means more now than ever since the new Google update: Panda. No longer are backlinks and simply pinging or sending out a RSS feed the key to getting Google PageRank or Alexa Rankings, You now NEED On-Page SEO. So what is good On-Page SEO?First your keyword must appear in the title.Then it must appear in the URL.You have to optimize your keyword and make sure that it has a nice keyword density of 3-5% in your article with relevant LSI (Latent Semantic Indexing). Then you should spread all H1,H2,H3 tags in your article.Your Keyword should appear in your first paragraph and in the last sentence of the page. You should have relevant usage of Bold and italics of your keyword.There should be one internal link to a page on your blog and you should have one image with an alt tag that has your keyword….wait there's even more Now what if i told you there was a simple WordPress plugin that does all the On-Page SEO, and automatically for you? That's right AUTOMATICALLY, just watch this 4minute video for more information at.</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-29520">
<article class="comment" id="comment-29520">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">crazymage</a></span> on <a href="http://www.acmerblog.com/hdu-3414-tour-route-5440.html#comment-29520" rel="nofollow"><time datetime="2014-07-25T16:47:04+00:00" pubdate="">2014年7月25日 at 下午4:47</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>很不错！</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-29511">
<article class="comment" id="comment-29511">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">MyHome</a></span> on <a href="http://www.acmerblog.com/hdu-3414-tour-route-5440.html#comment-29511" rel="nofollow"><time datetime="2014-04-20T16:09:17+00:00" pubdate="">2014年4月20日 at 下午4:09</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>对，这里说的最长回文子序列，非子串</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-29513">
<article class="comment" id="comment-29513">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://fdsf" rel="external nofollow">windy</a></span> on <a href="http://www.acmerblog.com/hdu-3414-tour-route-5440.html#comment-29513" rel="nofollow"><time datetime="2014-04-03T08:16:33+00:00" pubdate="">2014年4月3日 at 上午8:16</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>没有对题目进行一番分析，真是美中不足啊</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
</ol>