<div class="c-top2" id="post-55">
<div class="datetime">2015<br/>07-17</div>
<div class="tit"><h1 class="entry-title">HDU 4514-湫湫系列故事――设计风景线-图-[解题报告]HOJ</h1>
<div class="entry-meta iititle2">
<span class="i2"><a href="http://www.acmerblog.com/author/spiderman" rel="author" title="由蜘蛛侠发布">蜘蛛侠</a></span><span class="i1"><a href="http://www.acmerblog.com/category/search/bfs" rel="category tag" title="查看BFS搜索中的全部文章">BFS搜索</a>, <a href="http://www.acmerblog.com/category/problemset/hdu" rel="category tag" title="查看HDU-杭电中的全部文章">HDU-杭电</a>, <a href="http://www.acmerblog.com/category/graph" rel="category tag" title="查看图论中的全部文章">图论</a></span><span class="i4">围观103次</span><span class="i3"><a class="ds-thread-count" data-thread-key="7527" href="http://www.acmerblog.com/hdu-4514-7527.html#comments" title="《HDU 4514-湫湫系列故事――设计风景线-图-[解题报告]HOJ》上的评论">7 条评论</a></span>
</div>
</div>
<div class="cls"></div>
</div><div class="entry-content">
<div>
<h1 class="mytitle mybigtile">湫湫系列故事――设计风景线</h1>
</div>
<div>
<p class="mytitle"> 问题描述 :</p>
</div>
<div class="mypanel">
　　随着杭州西湖的知名度的进一步提升，园林规划专家湫湫希望设计出一条新的经典观光线路，根据老板马小腾的指示，新的风景线最好能建成环形，如果没有条件建成环形，那就建的越长越好。<br/>　　现在已经勘探确定了n个位置可以用来建设，在它们之间也勘探确定了m条可以设计的路线以及他们的长度。请问是否能够建成环形的风景线？如果不能，风景线最长能够达到多少？<br/>　　其中，可以兴建的路线均是双向的，他们之间的长度均大于0。 </div>
<div>
<p class="mytitle"> 输入:</p>
</div>
<div class="mypanel">
　　测试数据有多组，每组测试数据的第一行有两个数字n, m，其含义参见题目描述；<br/>　　接下去m行，每行3个数字u v w，分别代表这条线路的起点，终点和长度。
<p>　　<b>[Technical Specification]</b><br/>　　1. n&lt;=100000  <br/>　　2. m &lt;= 1000000<br/>　　3. 1&lt;= u, v &lt;= n <br/>　　4. w &lt;= 1000 </p></div>
<div>
<p class="mytitle"> 输出:</p>
</div>
<div class="mypanel">
　　测试数据有多组，每组测试数据的第一行有两个数字n, m，其含义参见题目描述；<br/>　　接下去m行，每行3个数字u v w，分别代表这条线路的起点，终点和长度。
<p>　　<b>[Technical Specification]</b><br/>　　1. n&lt;=100000  <br/>　　2. m &lt;= 1000000<br/>　　3. 1&lt;= u, v &lt;= n <br/>　　4. w &lt;= 1000</p></div>
<div>
<p class="mytitle"> 样例输入:</p>
</div>
<pre class="mypanel iopanel">
3 3
1 2 1
2 3 1
3 1 1</pre>
<div>
<p class="mytitle"> 样例输出:</p>
</div>
<pre class="mypanel iopanel">
YES</pre>
<p> <!-- problem end --></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px">
<strong>题目链接：</strong><a style="color:rgb(202,0,0); text-decoration:initial" target="_blank"><span style="color:rgb(51,0,153)">Click here~~</span></a>
</p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px; font-weight:bold">
题意：</p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px">
给一个无向图，若有环输出YES，若无环，则是森林，输出 max { 树的直径 }。<span style="font-family:Arial; font-size:14px; line-height:26px">（树中最长的简单路）</span></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px">
<span style="font-weight:bold">解题思路：</span></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px">
早早地就搜了几篇文章，还下载了个PPT。研究了半天，终于搞懂后，搜了好多判环和求树的直径的代码，都和我要写的方法不一样。</p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px">
纠结了好久不敢写，后来脑子疼了，打算乱写一通试试，结果随便调了调竟然就过了。（是太不相信自己了么？</p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px">
首先，无向图判环，想到用 dfs，但是要记录前驱节点。（但我百度半天没发现这么写的，所以一直不敢肯定自己是对的。。。</p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px">
然后，如何求树的直径呢？</p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px">
随便找一个点u ，找到距离 u 最远的点 v。</p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px">
然后再从 v 出发，找距离 v 最远的点 w，路径（v -&gt; w）就是树的直径。</p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px">
</p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px">
证明：首先，v 一定是直径的一端。</p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px">
           a) 如果 u 是直径的一端，那么 v 显然是直径的另一端，结论成立。</p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px">
<span style="font-family:Arial; font-size:14px; line-height:26px"><span style="font-family:Arial; font-size:14px; line-height:26px">           b) 如果 u 不是直径的一端，那么路径（u-&gt;v）一定与直径交于一点 p，且（p-&gt;v）一定是直径的一部分，推出 v 是直径的一端，结论成立。</span></span></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px">
<span style="font-family:Arial; font-size:14px; line-height:26px"><span style="font-family:Arial; font-size:14px; line-height:26px"><span style="font-family:Arial; font-size:14px; line-height:26px">           <span style="font-family:Arial; font-size:14px; line-height:26px"> <br/>
          1&gt; 为什么一定存在交点 p?</span></span><br/>
</span></span></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px">
<span style="font-family:Arial; font-size:14px; line-height:26px"><span style="font-family:Arial; font-size:14px; line-height:26px"><span style="font-family:Arial; font-size:14px; line-height:26px"><span style="font-family:Arial; font-size:14px; line-height:26px"><span style="font-family:Arial; font-size:14px; line-height:26px"> <br/>
          <span style="font-family:Arial; font-size:14px; line-height:26px">           <span style="font-family:Arial; font-size:14px; line-height:26px">           如果不存在交点 p ，由于树是连通的，那么加若干边使得直径经过（u-&gt;v）上的一点 p，直径不会变得更短。</span></span></span><br/>
</span></span></span></span></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px">
<span style="font-family:Arial; font-size:14px; line-height:26px"><span style="font-family:Arial; font-size:14px; line-height:26px"><span style="font-family:Arial; font-size:14px; line-height:26px"><span style="font-family:Arial; font-size:14px; line-height:26px"><span style="font-family:Arial; font-size:14px; line-height:26px"><span style="font-family:Arial; font-size:14px; line-height:26px"><span style="font-family:Arial; font-size:14px; line-height:26px"><span style="font-family:Arial; font-size:14px; line-height:26px"> <br/>
          <span style="font-family:Arial; font-size:14px; line-height:26px">           2&gt;为什么（p-&gt;v）一定是直径的一部分。</span></span><br/>
</span></span></span></span></span></span></span></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px">
<span style="font-family:Arial; font-size:14px; line-height:26px"><span style="font-family:Arial; font-size:14px; line-height:26px"><span style="font-family:Arial; font-size:14px; line-height:26px"><span style="font-family:Arial; font-size:14px; line-height:26px"><span style="font-family:Arial; font-size:14px; line-height:26px"><span style="font-family:Arial; font-size:14px; line-height:26px"><span style="font-family:Arial; font-size:14px; line-height:26px"><span style="font-family:Arial; font-size:14px; line-height:26px"><span style="font-family:Arial; font-size:14px; line-height:26px"><span style="font-family:Arial; font-size:14px; line-height:26px"> <br/>
          <span style="font-family:Arial; font-size:14px; line-height:26px">           <span style="font-family:Arial; font-size:14px; line-height:26px">           如果不是，（u-&gt;v）就不是从 u 到 v 最长的路径。</span></span></span><br/>
</span></span></span></span></span></span></span></span></span></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px">
</p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px">
于是我成功的将判环和求直径用一个 dfs 实现了，233333333。</p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px">
<span style="font-family:Arial; font-size:14px; line-height:26px">（<del>既然是树，我不明白为什么大家都要去用 bfs 来求路径长度。。。</del>大概是防止RE）</span>
</p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px">
<span style="font-family:Arial; font-size:14px; line-height:26px"><br/>
</span></p>
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px">
<span style="font-family:Arial; font-size:14px; line-height:26px"><span style="font-family:Arial; font-size:14px; line-height:26px"></span></span></p>
<pre class="brush:cpp" name="code">#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include &lt;algorithm&gt;
using namespace std;

const int N = 1e5+3;

struct Vertex
{
    int head;
}V[N];

struct Edge
{
    int v,w,next;
}E[N*10*2];

bool vis[N],tmpv[N];

int top,d[N];

void init()
{
    top = 0;
    memset(V,-1,sizeof(V));
}

void addEdge(int u,int v,int w)
{
    E[top].v = v;
    E[top].w = w;
    E[top].next = V[u].head;
    V[u].head = top++;
}

bool dfs(int pre,int u)
{
    vis[u] = true;
    for(int i=V[u].head;~i;i=E[i].next)
    {
        int v = E[i].v;
        if(v == pre)
            continue;
        if(vis[v])
            return false;
        d[v] = d[u] + E[i].w;
        if(!dfs(u,v))
            return false;
    }
    return true;
}

int main()
{
    int n,m;
    while(~scanf("%d%d",&amp;n,&amp;m))
    {
        init();
        while(m--)
        {
            int u,v,w;
            scanf("%d%d%d",&amp;u,&amp;v,&amp;w);
            addEdge(u,v,w);
            addEdge(v,u,w);
        }
        int ans = 0;
        bool yes = false;
        memset(vis,false,sizeof(vis));
        for(int i=1;i&lt;=n;i++)
        {
            if(vis[i])
                continue;
            memset(d,0,sizeof(d));
            if(!dfs(0,i))
            {
                yes = true;
                break;
            }
            int u = max_element(d+1,d+1+n) - d;
            memcpy(tmpv,vis,sizeof(vis));
            memset(vis,false,sizeof(vis));
            memset(d,0,sizeof(d));
            dfs(0,u);
            ans = max(ans,*max_element(d+1,d+1+n));
            memcpy(vis,tmpv,sizeof(vis));
        }
        if(yes)
            puts("YES");
        else
            printf("%d\n",ans);
    }
	return 0;
}
</pre>
<div style="padding-top:20px">
<p style="font-size:12px;">版权声明：本文为博主原创文章，未经博主允许不得转载。</p>
</div>
<p>参考：http://blog.csdn.net/dgq8211/article/details/8752927</p>
<div>
</script>
<!-- acm-hf-01 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-9460629317209118" data-ad-slot="5011774182" style="display:inline-block;width:728px;height:90px"></ins>

(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<div class="bdsharebuttonbox"><a class="bds_more" data-cmd="more" href="#"></a><a class="bds_qzone" data-cmd="qzone" href="#" title="分享到QQ空间"></a><a class="bds_tsina" data-cmd="tsina" href="#" title="分享到新浪微博"></a><a class="bds_tqq" data-cmd="tqq" href="#" title="分享到腾讯微博"></a><a class="bds_renren" data-cmd="renren" href="#" title="分享到人人网"></a><a class="bds_weixin" data-cmd="weixin" href="#" title="分享到微信"></a></div>

</div><ol id="commentlist">
<li class="comment even thread-even depth-1" id="li-comment-97803">
<article class="comment" id="comment-97803">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919522972" rel="external nofollow">新用户675320</a></span> on <a href="http://www.acmerblog.com/hdu-4514-7527.html#comment-97803" rel="nofollow"><time datetime="2017-04-20T08:48:50+00:00" pubdate="">2017年4月20日 at 上午8:48</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>哈哈哈哈哈哈哈</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-97802">
<article class="comment" id="comment-97802">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919522972" rel="external nofollow">新用户675320</a></span> on <a href="http://www.acmerblog.com/hdu-4514-7527.html#comment-97802" rel="nofollow"><time datetime="2017-04-20T08:48:50+00:00" pubdate="">2017年4月20日 at 上午8:48</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>哈哈哈哈哈哈哈</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-97801">
<article class="comment" id="comment-97801">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919522972" rel="external nofollow">新用户675320</a></span> on <a href="http://www.acmerblog.com/hdu-4514-7527.html#comment-97801" rel="nofollow"><time datetime="2017-04-20T08:48:50+00:00" pubdate="">2017年4月20日 at 上午8:48</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>哈哈哈哈哈哈哈</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-97800">
<article class="comment" id="comment-97800">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919522972" rel="external nofollow">新用户675320</a></span> on <a href="http://www.acmerblog.com/hdu-4514-7527.html#comment-97800" rel="nofollow"><time datetime="2017-04-20T08:48:50+00:00" pubdate="">2017年4月20日 at 上午8:48</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>哈哈哈哈哈哈哈</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-97799">
<article class="comment" id="comment-97799">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919522972" rel="external nofollow">新用户675320</a></span> on <a href="http://www.acmerblog.com/hdu-4514-7527.html#comment-97799" rel="nofollow"><time datetime="2017-04-20T08:48:50+00:00" pubdate="">2017年4月20日 at 上午8:48</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>哈哈哈哈哈哈哈</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-67265">
<article class="comment" id="comment-67265">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919524284" rel="external nofollow">新用户552349</a></span> on <a href="http://www.acmerblog.com/hdu-4514-7527.html#comment-67265" rel="nofollow"><time datetime="2017-04-11T00:40:27+00:00" pubdate="">2017年4月11日 at 上午12:40</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>http:**wuliaoo.com/7suikongshoudao.html</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-67264">
<article class="comment" id="comment-67264">
<footer class="comment-meta">
<cite class="comment-author vcard">
<span class="fn"><a class="url" href="http://www.renren.com/profile.do?id=919524284" rel="external nofollow">新用户552349</a></span> on <a href="http://www.acmerblog.com/hdu-4514-7527.html#comment-67264" rel="nofollow"><time datetime="2017-04-11T00:40:27+00:00" pubdate="">2017年4月11日 at 上午12:40</time></a> <span class="says">said:</span> </cite><!-- .comment-author .vcard -->
</footer>
<div class="comment-content"><p>http:**wuliaoo.com/7suikongshoudao.html</p>
</div>
</article><!-- #comment-## -->
</li><!-- #comment-## -->
</ol>